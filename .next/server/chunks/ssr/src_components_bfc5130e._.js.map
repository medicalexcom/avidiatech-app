{"version":3,"sources":["../../../../src/components/BackToDashboard.tsx","../../../../src/components/settings/BillingPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\n\n/**\n * BackToDashboard button\n * - tries history.back() when possible, otherwise falls back to /dashboard\n * - use in settings pages so users can return to the main dashboard quickly\n */\n\nexport default function BackToDashboard() {\n  function goBack(e: React.MouseEvent) {\n    e.preventDefault();\n    try {\n      if (window.history.length > 1) {\n        window.history.back();\n      } else {\n        window.location.href = \"/dashboard\";\n      }\n    } catch {\n      window.location.href = \"/dashboard\";\n    }\n  }\n\n  return (\n    <a href=\"/dashboard\" onClick={goBack} className=\"inline-flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300 hover:underline\">\n      <span aria-hidden>←</span>\n      <span>Back to dashboard</span>\n    </a>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\n/**\n * BillingPanel\n * - fetches /api/billing/summary (backend should return plan, renewal, usage)\n * - shows plan card, usage meters, Manage Billing -> opens portal\n */\n\ntype Summary = {\n  plan?: string;\n  renewal?: string;\n  usage?: { ingests: { used: number; limit: number }; translations: { used: number; limit: number } };\n  isOwner?: boolean;\n};\n\nexport default function BillingPanel() {\n  const [summary, setSummary] = useState<Summary | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [opening, setOpening] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const res = await fetch(\"/api/billing/summary\");\n        const json = await res.json();\n        setSummary(json || null);\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  async function openPortal() {\n    setOpening(true);\n    try {\n      const r = await fetch(\"/api/billing/portal\", { method: \"POST\" });\n      const j = await r.json();\n      if (r.ok && j.url) window.open(j.url, \"_blank\");\n      else alert(j?.error || \"No billing portal available\");\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to open billing portal\");\n    } finally {\n      setOpening(false);\n    }\n  }\n\n  if (loading) return <div>Loading…</div>;\n  if (!summary) return <div>Unable to load billing summary</div>;\n\n  if (!summary.isOwner) {\n    return (\n      <div className=\"max-w-4xl\">\n        <div className=\"bg-white dark:bg-slate-900 border rounded-lg p-6\">\n          <h2 className=\"text-lg font-semibold\">Billing</h2>\n          <p className=\"mt-2 text-sm text-slate-500\">Billing information is available to account owners only. Contact your organization owner to manage billing.</p>\n        </div>\n      </div>\n    );\n  }\n\n  const plan = summary.plan ?? \"Starter\";\n  const renewal = summary.renewal ?? \"—\";\n  const ing = summary.usage?.ingests ?? { used: 0, limit: 0 };\n  const tr = summary.usage?.translations ?? { used: 0, limit: 0 };\n\n  function pct(u: number, l: number) {\n    if (!l) return 0;\n    return Math.min(100, Math.round((u / l) * 100));\n  }\n\n  return (\n    <div className=\"max-w-4xl\">\n      <div className=\"bg-white dark:bg-slate-900 border rounded-lg p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-lg font-semibold\">Subscription & Billing</h2>\n            <p className=\"text-sm text-slate-500 mt-1\">Manage subscription, billing, and usage.</p>\n          </div>\n          <div>\n            <button onClick={openPortal} disabled={opening} className=\"px-4 py-2 bg-indigo-600 text-white rounded\">\n              {opening ? \"Opening…\" : \"Open Stripe Portal\"}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"mt-6 grid grid-cols-3 gap-4\">\n          <div className=\"col-span-1 border rounded p-4\">\n            <div className=\"text-xs text-slate-500\">Plan</div>\n            <div className=\"text-xl font-semibold mt-1\">{plan}</div>\n            <div className=\"text-sm text-slate-500 mt-2\">Renewal: {renewal}</div>\n          </div>\n\n          <div className=\"col-span-2 border rounded p-4\">\n            <div className=\"text-sm font-medium\">Usage</div>\n\n            <div className=\"mt-3\">\n              <div className=\"flex justify-between text-xs\">\n                <div>Product ingests</div>\n                <div>{ing.used} / {ing.limit}</div>\n              </div>\n              <div className=\"w-full bg-slate-100 dark:bg-slate-800 h-2 rounded mt-1\">\n                <div style={{ width: `${pct(ing.used, ing.limit)}%` }} className=\"h-2 bg-indigo-600 rounded\" />\n              </div>\n            </div>\n\n            <div className=\"mt-4\">\n              <div className=\"flex justify-between text-xs\">\n                <div>Translations</div>\n                <div>{tr.used} / {tr.limit}</div>\n              </div>\n              <div className=\"w-full bg-slate-100 dark:bg-slate-800 h-2 rounded mt-1\">\n                <div style={{ width: `${pct(tr.used, tr.limit)}%` }} className=\"h-2 bg-indigo-600 rounded\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}