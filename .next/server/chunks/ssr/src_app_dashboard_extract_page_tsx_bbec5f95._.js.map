{"version":3,"sources":["../../../../src/app/dashboard/extract/page.tsx","../../../../src/components/TabsShell.tsx","../../../../src/components/JsonViewer.tsx","../../../../src/hooks/useIngestRow.ts","../../../../src/components/ExtractHeader.tsx"],"sourcesContent":["// src/app/dashboard/extract/page.tsx\n\"use client\";\n\nimport React, { useState, useMemo, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport TabsShell from \"@/components/TabsShell\";\nimport JsonViewer from \"@/components/JsonViewer\";\nimport { useIngestRow } from \"@/hooks/useIngestRow\";\nimport ExtractHeader from \"@/components/ExtractHeader\";\n\n/**\n * AvidiaExtract page (client)\n *\n * - ExtractHeader calls onJobCreated(jobId, url) after POST /api/v1/ingest.\n * - We track jobId so the status + SEO button can work.\n * - Preview comes from: GET /api/v1/ingest/{jobId}?url=<url>\n *   which proxies to medx-ingest-api when ?url is present.\n * - For display we:\n *   - Prefer preview JSON.\n *   - Fall back to DB row (normalized_payload if available).\n */\n\nexport const dynamic = \"force-dynamic\";\n\nexport default function ExtractPage() {\n  const router = useRouter();\n\n  // submission / job state\n  const [jobId, setJobId] = useState<string | null>(null);\n  const [jobUrl, setJobUrl] = useState<string | null>(null);\n  const { row, loading: rowLoading, error: rowError } = useIngestRow(\n    jobId,\n    1500\n  );\n\n  // preview state when the synchronous GET returns extraction immediately\n  const [preview, setPreview] = useState<any | null>(null);\n  const [previewError, setPreviewError] = useState<string | null>(null);\n  const [previewLoading, setPreviewLoading] = useState(false);\n\n  // Helper to normalize shapes like:\n  // - { ok, data: { normalized_payload, ... } }\n  // - { normalized_payload, ... }\n  // - plain job row\n  function extractPayload(source: any | null | undefined) {\n    if (!source) return null;\n\n    const base = source.data ?? source;\n    return base.normalized_payload ?? base;\n  }\n\n  // derive payload for highlights preferring preview -> row\n  const payload = useMemo(() => {\n    if (preview) return extractPayload(preview);\n    if (row) return extractPayload(row);\n    return null;\n  }, [preview, row]);\n\n  const name = payload?.name_best ?? payload?.name_raw ?? payload?.name;\n  const featuresHtml =\n    payload?.features_html ??\n    payload?.features_structured ??\n    payload?.features_raw;\n  const pdfUrls =\n    payload?.pdf_manual_urls ?? payload?.pdfs ?? payload?.manuals ?? [];\n  const images = payload?.images ?? [];\n  const quality = payload?.quality_score;\n  const needsReview = payload?.needs_review;\n\n  function onJobCreated(id: string, url: string) {\n    setJobId(String(id));\n    setJobUrl(url);\n    setPreview(null);\n    setPreviewError(null);\n\n    // scroll to results area\n    setTimeout(() => {\n      const el = document.getElementById(\"extract-results\");\n      if (el) el.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n    }, 250);\n  }\n\n  // When jobId + jobUrl set, call:\n  //   GET /api/v1/ingest/{jobId}?url=<encoded>\n  useEffect(() => {\n    if (!jobId || !jobUrl) return;\n\n    let mounted = true;\n\n    (async () => {\n      setPreviewLoading(true);\n      setPreviewError(null);\n\n      try {\n        const target = `/api/v1/ingest/${encodeURIComponent(\n          jobId\n        )}?url=${encodeURIComponent(jobUrl)}`;\n\n        const res = await fetch(target, {\n          method: \"GET\",\n          credentials: \"same-origin\",\n          headers: { Accept: \"application/json\" },\n        });\n\n        const text = await res.text().catch(() => \"\");\n\n        if (!mounted) return;\n\n        if (!res.ok) {\n          let message = `preview fetch failed (${res.status})`;\n          try {\n            const j = JSON.parse(text || \"{}\");\n            message = j?.error || message;\n          } catch {\n            // keep default message\n          }\n          setPreviewError(message);\n          setPreviewLoading(false);\n          return;\n        }\n\n        // Try parse JSON\n        try {\n          const j = JSON.parse(text || \"{}\");\n          setPreview(j);\n        } catch {\n          setPreviewError(\"Preview returned non-JSON response\");\n        }\n      } catch (err: any) {\n        if (!mounted) return;\n        setPreviewError(String(err?.message || err));\n      } finally {\n        if (mounted) setPreviewLoading(false);\n      }\n    })();\n\n    return () => {\n      mounted = false;\n    };\n  }, [jobId, jobUrl]);\n\n  // For the JSON viewer, prefer normalized preview data, then row\n  const jsonViewerData = useMemo(() => {\n    if (preview) return extractPayload(preview) ?? preview;\n    if (row) return extractPayload(row) ?? row;\n    return {};\n  }, [preview, row]);\n\n  const ingestionStatus = row?.status ?? (preview ? \"preview-only\" : null);\n\n  return (\n    <main className=\"relative min-h-screen overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50\">\n      {/* BACKGROUND: layered gradients + subtle grid */}\n      <div className=\"pointer-events-none absolute inset-0\">\n        <div className=\"absolute -top-40 -left-32 h-96 w-96 rounded-full bg-cyan-300/25 blur-3xl dark:bg-cyan-500/20\" />\n        <div className=\"absolute -bottom-40 right-[-10rem] h-[26rem] w-[26rem] rounded-full bg-violet-300/25 blur-3xl dark:bg-violet-500/20\" />\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.9)_55%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.9)_55%,_rgba(15,23,42,1)_100%)]\" />\n        <div className=\"absolute inset-0 opacity-[0.04] dark:opacity-[0.06]\">\n          <div className=\"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:46px_46px] dark:bg-[linear-gradient(to_right,#1e293b_1px,transparent_1px),linear-gradient(to_bottom,#1e293b_1px,transparent_1px)]\" />\n        </div>\n      </div>\n\n      {/* Wrapper aligned with Describe/Translate (starts higher) */}\n      <div className=\"relative mx-auto max-w-7xl space-y-6 px-4 pt-4 pb-8 lg:px-8 lg:pt-6 lg:pb-10\">\n        {/* HERO: Extract identity + ExtractHeader (no framed banner) */}\n        <section className=\"relative flex flex-col gap-6 lg:flex-row lg:items-stretch lg:justify-between\">\n          {/* LEFT: headline + story + status chips */}\n          <div className=\"min-w-[260px] flex-1 space-y-5\">\n            <div className=\"flex flex-wrap items-center gap-3\">\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-cyan-400/70 bg-white/90 px-3 py-1.5 text-[11px] font-medium uppercase tracking-[0.18em] text-cyan-800 shadow-sm dark:border-cyan-500/60 dark:bg-slate-950/90 dark:text-cyan-100\">\n                <span className=\"inline-flex h-4 w-4 items-center justify-center rounded-full border border-cyan-400/70 bg-slate-100 dark:bg-slate-900\">\n                  <span className=\"h-2 w-2 animate-pulse rounded-full bg-cyan-500 dark:bg-cyan-400\" />\n                </span>\n                AvidiaTech â€¢ AvidiaExtract\n              </div>\n              <span className=\"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white/90 px-2.5 py-1 text-[11px] text-slate-600 shadow-sm dark:border-slate-700 dark:bg-slate-950/90 dark:text-slate-300\">\n                <span className=\"h-1.5 w-1.5 rounded-full bg-emerald-500 dark:bg-emerald-400\" />\n                Ingest engine â€¢ JSON-first\n              </span>\n              {ingestionStatus && (\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white/90 px-2.5 py-1 text-[11px] text-slate-600 shadow-sm dark:border-slate-700 dark:bg-slate-950/90 dark:text-slate-300\">\n                  Status:\n                  <span className=\"font-mono text-[10px] uppercase text-cyan-700 dark:text-cyan-200\">\n                    {ingestionStatus}\n                  </span>\n                </span>\n              )}\n            </div>\n\n            <div className=\"space-y-2\">\n              <h1 className=\"text-2xl font-semibold leading-tight text-slate-900 lg:text-3xl dark:text-slate-50\">\n                Extract everything from a{\" \"}\n                <span className=\"bg-gradient-to-r from-cyan-500 via-sky-500 to-emerald-400 bg-clip-text text-transparent dark:from-cyan-300 dark:via-sky-400 dark:to-emerald-300\">\n                  single manufacturer URL\n                </span>{\" \"}\n                â€” as clean, normalized JSON.\n              </h1>\n              <p className=\"max-w-xl text-sm text-slate-600 dark:text-slate-300\">\n                Paste any product URL. AvidiaExtract hits your ingest engine,\n                strips noise, standardizes specs, and streams back a\n                JSON-first view that plugs into SEO, Describe, and any\n                ecommerce stack.\n              </p>\n            </div>\n\n            <div className=\"grid gap-3 sm:grid-cols-2\">\n              <div className=\"rounded-xl border border-cyan-200 bg-white/90 px-3 py-3 text-[11px] text-slate-700 shadow-sm dark:border-cyan-500/40 dark:bg-slate-950/90 dark:text-slate-100\">\n                <p className=\"mb-1 font-semibold uppercase tracking-[0.18em] text-cyan-600 dark:text-cyan-200\">\n                  Example extraction\n                </p>\n                <p className=\"leading-relaxed\">\n                  Unified JSON with name, brand, attributes, features, manuals,\n                  images, and normalized specs â€” ready for any downstream module.\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-emerald-200 bg-white/90 px-3 py-3 text-[11px] text-slate-700 shadow-sm dark:border-emerald-400/50 dark:bg-slate-950/90 dark:text-slate-100\">\n                <p className=\"mb-1 font-semibold text-emerald-700 dark:text-emerald-300\">\n                  Feeds the stack\n                </p>\n                <ul className=\"list-inside list-disc space-y-1\">\n                  <li>AvidiaDescribe for copy-first flows</li>\n                  <li>AvidiaSEO for URL-first SEO pages</li>\n                  <li>Any external store / PIM as JSON</li>\n                </ul>\n              </div>\n            </div>\n\n            <div className=\"flex flex-wrap gap-3 text-[11px]\">\n              <div className=\"inline-flex items-start gap-2 rounded-xl border border-slate-200 bg-white/95 px-3 py-2 text-slate-700 shadow-sm dark:border-slate-700/70 dark:bg-slate-950/90 dark:text-slate-50\">\n                <div className=\"mt-[2px] flex h-5 w-5 items-center justify-center rounded-lg border border-cyan-400/70 bg-cyan-500/10 text-[12px] text-cyan-700 dark:bg-cyan-500/15 dark:text-cyan-200\">\n                  1\n                </div>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold\">Opinionated normalization</p>\n                  <p className=\"text-[10px] text-slate-500 dark:text-slate-400\">\n                    Features, manuals, images, and specs are shaped into a\n                    predictable schema.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"inline-flex items-start gap-2 rounded-xl border border-slate-200 bg-white/95 px-3 py-2 text-slate-700 shadow-sm dark:border-slate-700/70 dark:bg-slate-950/90 dark:text-slate-50\">\n                <div className=\"mt-[2px] flex h-5 w-5 items-center justify-center rounded-lg border border-sky-400/70 bg-sky-500/10 text-[12px] text-sky-700 dark:bg-sky-500/15 dark:text-sky-200\">\n                  2\n                </div>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold\">Debuggable at every step</p>\n                  <p className=\"text-[10px] text-slate-500 dark:text-slate-400\">\n                    Human preview, Tabs, and JSON viewer all stay in sync with\n                    the ingest engine.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"inline-flex items-start gap-2 rounded-xl border border-slate-200 bg-white/95 px-3 py-2 text-slate-700 shadow-sm dark:border-slate-700/70 dark:bg-slate-950/90 dark:text-slate-50\">\n                <div className=\"mt-[2px] flex h-5 w-5 items-center justify-center rounded-lg border border-emerald-400/70 bg-emerald-500/10 text-[12px] text-emerald-700 dark:bg-emerald-500/15 dark:text-emerald-200\">\n                  3\n                </div>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold\">Built for the rest of Avidia</p>\n                  <p className=\"text-[10px] text-slate-500 dark:text-slate-400\">\n                    One ingestion layer powering AvidiaDescribe, AvidiaSEO,\n                    and any custom exporter.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex flex-wrap items-center gap-3 pt-1\">\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-cyan-300/70 bg-white/90 px-3 py-1.5 text-[11px] text-slate-700 shadow-sm dark:border-cyan-400/50 dark:bg-slate-950/90 dark:text-slate-300\">\n                <span className=\"text-[11px] font-semibold uppercase tracking-[0.16em] text-cyan-700 dark:text-cyan-200\">\n                  Step 1\n                </span>\n                <span>\n                  Use the{\" \"}\n                  <span className=\"font-semibold text-cyan-700 dark:text-cyan-200\">\n                    Extract launcher\n                  </span>{\" \"}\n                  below to submit a URL.\n                </span>\n              </div>\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/90 px-3 py-1.5 text-[11px] text-slate-700 shadow-sm dark:border-slate-700 dark:bg-slate-950/90 dark:text-slate-300\">\n                <span className=\"text-[11px] font-semibold uppercase tracking-[0.16em] text-emerald-700 dark:text-emerald-200\">\n                  Step 2\n                </span>\n                <span>\n                  Inspect the extraction canvas and JSON viewer in real time.\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* RIGHT: ExtractHeader inside a \"launcher\" card */}\n          <div className=\"mt-4 w-full lg:mt-0 lg:w-[420px] xl:w-[440px]\">\n            <div className=\"flex h-full flex-col gap-3 rounded-2xl border border-slate-200 bg-white/95 px-4 py-4 shadow-xl shadow-slate-200/60 dark:border-slate-700/80 dark:bg-slate-950/90 dark:shadow-[0_0_50px_rgba(15,23,42,0.95)]\">\n              <div className=\"mb-1 flex items-center justify-between gap-2\">\n                <div>\n                  <p className=\"text-[11px] font-medium uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400\">\n                    Extract launcher\n                  </p>\n                  <p className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                    Submit a manufacturer URL; AvidiaExtract handles the rest.\n                  </p>\n                </div>\n                {jobId && (\n                  <div className=\"text-right\">\n                    <p className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                      Current job\n                    </p>\n                    <p className=\"font-mono text-[10px] text-cyan-700 dark:text-cyan-200\">\n                      {jobId.slice(0, 10)}â€¦\n                    </p>\n                  </div>\n                )}\n              </div>\n              <div className=\"min-h-[220px] flex-1\">\n                <ExtractHeader onJobCreated={onJobCreated} />\n              </div>\n              <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                <p className=\"text-[10px] text-slate-500 dark:text-slate-500\">\n                  Extraction response is streamed into both the human view and\n                  the JSON viewer below.\n                </p>\n                <div className=\"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-[10px] text-slate-600 shadow-sm dark:border-slate-700 dark:bg-slate-900/90 dark:text-slate-300\">\n                  <span className=\"h-1.5 w-1.5 rounded-full bg-emerald-500 dark:bg-emerald-400\" />\n                  {rowLoading || previewLoading ? \"Pipeline runningâ€¦\" : \"Idle\"}\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* MAIN: Extraction canvas + JSON viewer */}\n        <section className=\"grid grid-cols-1 gap-6 lg:grid-cols-[minmax(0,1.6fr),minmax(0,1.1fr)]\">\n          {/* LEFT: human extraction canvas */}\n          <section className=\"flex min-h-[520px] flex-col gap-4 rounded-3xl border border-slate-200 bg-white p-4 shadow-2xl shadow-slate-200/70 lg:p-5 dark:border-slate-700/70 dark:bg-slate-900/90 dark:shadow-2xl dark:shadow-slate-950/80\">\n            <div className=\"flex items-start justify-between gap-4\">\n              <div>\n                <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                  Extraction canvas\n                </h2>\n                <p className=\"mt-1 max-w-xl text-[11px] text-slate-600 dark:text-slate-400\">\n                  A human-readable view of the current extraction. Preview\n                  reflects the ingest engine directly; Tabs under this section\n                  expose raw and normalized variants from your DB.\n                </p>\n              </div>\n              {jobId && (\n                <div className=\"ml-auto flex flex-col items-end gap-1\">\n                  <button\n                    onClick={() =>\n                      router.push(\n                        `/dashboard/seo?ingestionId=${encodeURIComponent(\n                          jobId\n                        )}`\n                      )\n                    }\n                    className=\"inline-flex items-center gap-1.5 rounded-lg bg-cyan-500 px-3 py-2 text-xs font-semibold text-slate-50 shadow-lg shadow-cyan-500/30 transition-transform hover:-translate-y-[1px] hover:bg-cyan-400 dark:text-slate-950\"\n                  >\n                    <span>Send to AvidiaSEO</span>\n                    <span className=\"text-[13px]\">â†—</span>\n                  </button>\n                  <p className=\"text-[10px] text-slate-500 dark:text-slate-500\">\n                    Reuses this ingestionId downstream.\n                  </p>\n                </div>\n              )}\n            </div>\n\n            {/* Status strip */}\n            <div className=\"flex flex-wrap items-center gap-2 text-[11px]\">\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5 text-slate-600 shadow-sm dark:border-slate-700 dark:bg-slate-950/90 dark:text-slate-300\">\n                <span\n                  className={`h-1.5 w-1.5 rounded-full ${\n                    rowLoading || previewLoading\n                      ? \"bg-amber-400 animate-pulse\"\n                      : payload\n                      ? \"bg-emerald-500 dark:bg-emerald-400\"\n                      : \"bg-slate-400\"\n                  }`}\n                />\n                <span>\n                  {rowLoading || previewLoading\n                    ? \"Fetching extraction previewâ€¦\"\n                    : payload\n                    ? \"Extraction ready\"\n                    : \"Awaiting first URL\"}\n                </span>\n              </div>\n              {rowError && (\n                <span className=\"inline-flex items-center gap-2 rounded-full border border-rose-300 bg-rose-50 px-3 py-1.5 text-rose-700 shadow-sm dark:border-rose-500/40 dark:bg-rose-950/80 dark:text-rose-100\">\n                  <span className=\"h-1.5 w-1.5 rounded-full bg-rose-500 dark:bg-rose-400\" />\n                  DB error: {String(rowError)}\n                </span>\n              )}\n              {previewError && !previewLoading && (\n                <span className=\"inline-flex items-center gap-2 rounded-full border border-amber-300 bg-amber-50 px-3 py-1.5 text-amber-700 shadow-sm dark:border-amber-500/40 dark:bg-amber-950/80 dark:text-amber-100\">\n                  <span className=\"h-1.5 w-1.5 rounded-full bg-amber-400\" />\n                  Preview: {previewError}\n                </span>\n              )}\n            </div>\n\n            {/* Human preview block */}\n            <div className=\"mt-1\">\n              {previewLoading ? (\n                <div className=\"flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-700 shadow-sm dark:border-slate-700 dark:bg-slate-950/90 dark:text-slate-300\">\n                  <div className=\"h-8 w-8 rounded-full border-2 border-cyan-400/50 border-t-transparent animate-spin\" />\n                  <div>\n                    <p className=\"font-medium text-slate-900 dark:text-slate-100\">\n                      Loading preview from ingest engineâ€¦\n                    </p>\n                    <p className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                      This hits the medx-ingest-api directly; tabs and JSON\n                      viewer will update as soon as it returns.\n                    </p>\n                  </div>\n                </div>\n              ) : previewError && !payload ? (\n                <div className=\"rounded-2xl border border-amber-300 bg-amber-50 p-4 text-sm text-amber-800 shadow-sm dark:border-amber-500/40 dark:bg-amber-950/70 dark:text-amber-50\">\n                  Preview error: {previewError}\n                </div>\n              ) : payload ? (\n                <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-4 shadow-sm dark:border-slate-700 dark:bg-slate-950/90\">\n                  {/* SINGLE-COLUMN PREVIEW BLOCK, IMAGES BEFORE MANUALS */}\n                  <h3 className=\"text-xl font-semibold text-slate-900 dark:text-slate-50\">\n                    {name ?? \"Untitled extraction\"}\n                  </h3>\n\n                  <div className=\"mt-2 flex flex-wrap gap-3 text-[11px] text-slate-600 dark:text-slate-300\">\n                    {quality !== undefined && (\n                      <span className=\"inline-flex items-center gap-1 rounded-full border border-emerald-300 bg-emerald-50 px-2.5 py-1 text-emerald-700 shadow-sm dark:border-emerald-400/40 dark:bg-slate-900/90 dark:text-emerald-100\">\n                        <span className=\"h-1.5 w-1.5 rounded-full bg-emerald-500 dark:bg-emerald-400\" />\n                        Quality score:{\" \"}\n                        <span className=\"font-semibold\">{quality}</span>\n                      </span>\n                    )}\n                    {needsReview !== undefined && (\n                      <span className=\"inline-flex items-center gap-1 rounded-full border border-amber-300 bg-amber-50 px-2.5 py-1 text-amber-700 shadow-sm dark:border-amber-400/40 dark:bg-slate-900/90 dark:text-amber-100\">\n                        <span className=\"h-1.5 w-1.5 rounded-full bg-amber-400\" />\n                        Needs manual review:{\" \"}\n                        <span className=\"font-semibold\">\n                          {String(Boolean(needsReview))}\n                        </span>\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Features */}\n                  <div className=\"mt-4\">\n                    <p className=\"text-xs font-semibold text-slate-900 dark:text-slate-100\">\n                      Features (preview)\n                    </p>\n                    {Array.isArray(featuresHtml) ? (\n                      <ul className=\"mt-2 max-h-32 space-y-1 overflow-auto text-xs text-slate-700 dark:text-slate-200\">\n                        {featuresHtml.slice(0, 10).map((f: any, i: number) => (\n                          <li key={i} className=\"list-disc list-inside\">\n                            {typeof f === \"string\" ? f : JSON.stringify(f)}\n                          </li>\n                        ))}\n                        {featuresHtml.length > 10 && (\n                          <li className=\"text-slate-400\">â€¦truncated</li>\n                        )}\n                      </ul>\n                    ) : typeof featuresHtml === \"string\" ? (\n                      <p className=\"mt-2 line-clamp-5 text-xs text-slate-700 dark:text-slate-200\">\n                        {featuresHtml}\n                      </p>\n                    ) : (\n                      <p className=\"mt-2 text-xs text-slate-400 dark:text-slate-500\">\n                        No features extracted yet.\n                      </p>\n                    )}\n                  </div>\n\n                  {/* Images FIRST */}\n                  <div className=\"mt-4\">\n                    <p className=\"mb-1 text-xs font-semibold text-slate-900 dark:text-slate-100\">\n                      Images\n                    </p>\n                    <div className=\"mt-2 grid grid-cols-3 gap-2 sm:grid-cols-4\">\n                      {Array.isArray(images) && images.length > 0 ? (\n                        images.slice(0, 8).map((img: any, i: number) => (\n                          // eslint-disable-next-line @next/next/no-img-element\n                          <img\n                            key={i}\n                            src={img?.url ?? img}\n                            alt={`img-${i}`}\n                            className=\"h-20 w-full rounded-lg border border-slate-200 bg-slate-100 object-cover dark:border-slate-700 dark:bg-slate-900\"\n                          />\n                        ))\n                      ) : (\n                        <div className=\"col-span-full text-xs text-slate-400 dark:text-slate-500\">\n                          No images detected.\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Manuals / PDFs AFTER images */}\n                  <div className=\"mt-4\">\n                    <p className=\"mb-1 text-xs font-semibold text-slate-900 dark:text-slate-100\">\n                      Manuals &amp; PDFs\n                    </p>\n                    <div className=\"mt-1 flex flex-wrap gap-2\">\n                      {Array.isArray(pdfUrls) && pdfUrls.length > 0 ? (\n                        pdfUrls.slice(0, 8).map((u: string, i: number) => (\n                          <a\n                            key={i}\n                            href={u}\n                            target=\"_blank\"\n                            rel=\"noreferrer\"\n                            className=\"inline-flex items-center gap-1 rounded-full border border-cyan-300 bg-cyan-50 px-3 py-1.5 text-[11px] text-cyan-800 shadow-sm hover:border-cyan-400 hover:text-cyan-900 dark:border-cyan-400/40 dark:bg-slate-900/90 dark:text-cyan-200 dark:hover:border-cyan-300\"\n                          >\n                            <span className=\"text-[13px]\">ðŸ“„</span>\n                            <span>PDF {i + 1}</span>\n                          </a>\n                        ))\n                      ) : (\n                        <span className=\"ml-1 text-xs text-slate-400 dark:text-slate-500\">\n                          No manuals or PDFs found.\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-4 text-sm text-slate-500 shadow-sm dark:border-slate-700 dark:bg-slate-950/70 dark:text-slate-400\">\n                  Submit a product URL using the Extract launcher. AvidiaExtract\n                  will display a human-friendly preview here and a full JSON\n                  view on the right.\n                </div>\n              )}\n            </div>\n\n            {/* TabsShell: anchored block for raw data */}\n            <div className=\"mt-2\" id=\"extract-results\">\n              <div className=\"mb-2 flex items-center justify-between\">\n                <div>\n                  <p className=\"text-xs font-semibold text-slate-900 dark:text-slate-100\">\n                    Ingest row &amp; raw views\n                  </p>\n                  <p className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                    Tabs expose different slices of the same ingest row\n                    (normalized, raw HTML, logs, etc) to help you debug.\n                  </p>\n                </div>\n              </div>\n              <TabsShell\n                job={row}\n                loading={rowLoading}\n                error={rowError}\n                noDataMessage=\"Submit a URL to extract raw data\"\n              />\n            </div>\n          </section>\n\n          {/* RIGHT: JSON viewer card */}\n          <aside className=\"flex min-h-[520px] flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white p-4 shadow-2xl shadow-slate-200/80 lg:p-5 dark:border-slate-700/70 dark:bg-slate-900/95 dark:shadow-2xl dark:shadow-slate-950/80\">\n            <div className=\"flex items-start justify-between gap-3\">\n              <div>\n                <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                  Normalized JSON viewer\n                </h2>\n                <p className=\"mt-1 text-[11px] text-slate-500 dark:text-slate-400\">\n                  The exact payload your automations consume. Preferentially\n                  shows the normalized preview; falls back to the DB row when\n                  needed.\n                </p>\n              </div>\n              <div className=\"text-right text-[11px] text-slate-500 dark:text-slate-400\">\n                <div>\n                  {jobId ? (\n                    <>\n                      Job:{\" \"}\n                      <span className=\"font-mono text-[10px] text-cyan-700 dark:text-cyan-200\">\n                        {jobId.slice(0, 10)}â€¦\n                      </span>\n                    </>\n                  ) : (\n                    \"No job yet\"\n                  )}\n                </div>\n                <div className=\"mt-1\">\n                  {row?.status ? `Status: ${row.status}` : \"\"}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-4 flex-1 overflow-hidden rounded-2xl border border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-950/90\">\n              <div className=\"flex items-center justify-between border-b border-slate-200 px-3 py-2 text-[11px] dark:border-slate-800\">\n                <span className=\"uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                  Payload explorer\n                </span>\n                <span className=\"text-[10px] text-slate-500 dark:text-slate-500\">\n                  {preview\n                    ? \"Preview â€¢ normalized\"\n                    : row\n                    ? \"DB row â€¢ normalized\"\n                    : \"Awaiting first extraction\"}\n                </span>\n              </div>\n              <div className=\"h-full max-h-[460px] overflow-auto\">\n                <JsonViewer\n                  data={jsonViewerData}\n                  loading={!row && !!jobId && !preview}\n                />\n              </div>\n            </div>\n          </aside>\n        </section>\n      </div>\n    </main>\n  );\n}\n","\"use client\";\n\nimport React from \"react\";\n\ntype TabsShellProps = {\n  job: any;\n  loading?: boolean;\n  error?: any;\n  noDataMessage?: string;\n};\n\n/**\n * TabsShell for the Extract page.\n *\n * Responsibility:\n * - Show deeper / technical details that complement the high-level preview:\n *   - Source SEO (scraped only, NOT AvidiaSEO)\n *   - Specs\n *   - Variants\n *   - Raw JSON / payload\n *   - Diagnostics\n *\n * The high-level \"preview\" card above this component owns:\n *   - Overview / description\n *   - Features\n *   - Images\n *   - Manuals / PDFs\n *\n * That separation avoids duplicate content on the screen.\n */\nexport default function TabsShell({\n  job,\n  loading,\n  error,\n  noDataMessage,\n}: TabsShellProps) {\n  const payload = job?.normalized_payload || job?.raw_payload || job || null;\n\n  const hasSourceSeo = !!payload?.source_seo;\n  const hasSpecs =\n    !!payload?.specs_json || !!payload?.specs || !!payload?.specs_payload;\n  const hasVariants =\n    Array.isArray(payload?.variants) && payload.variants.length > 0;\n\n  const rawJsonSource =\n    payload?.normalized_payload ??\n    payload?.raw_payload ??\n    payload ??\n    null;\n  const hasRaw = !!rawJsonSource;\n\n  const diagnostics = job?.diagnostics || payload?.diagnostics || null;\n  const hasDiagnostics =\n    diagnostics && Object.keys(diagnostics).length > 0;\n\n  // Handle outer states\n  if (!job && !loading) {\n    return <div>{noDataMessage}</div>;\n  }\n\n  if (loading && !job) {\n    return <div>Waiting for engine to completeâ€¦</div>;\n  }\n\n  if (error) {\n    return <div style={{ color: \"crimson\" }}>{String(error)}</div>;\n  }\n\n  // Build tab model (only advanced / non-duplicated sections)\n  const TAB_SOURCE_SEO = \"source_seo\";\n  const TAB_SPECS = \"specs\";\n  const TAB_VARIANTS = \"variants\";\n  const TAB_RAW = \"raw\";\n  const TAB_DIAGNOSTICS = \"diagnostics\";\n\n  const tabs = [\n    { id: TAB_SOURCE_SEO, label: \"Source SEO\", enabled: hasSourceSeo },\n    { id: TAB_SPECS, label: \"Specs\", enabled: hasSpecs },\n    { id: TAB_VARIANTS, label: \"Variants\", enabled: hasVariants },\n    { id: TAB_RAW, label: \"Raw JSON\", enabled: hasRaw },\n    { id: TAB_DIAGNOSTICS, label: \"Diagnostics\", enabled: true },\n  ] as const;\n\n  // Pick initial tab: first enabled, otherwise Raw, otherwise Diagnostics.\n  const firstEnabled =\n    tabs.find((t) => t.enabled)?.id || TAB_RAW || TAB_DIAGNOSTICS;\n\n  const [activeTab, setActiveTab] =\n    React.useState<string>(firstEnabled);\n\n  // When job changes, reset to first enabled tab\n  React.useEffect(() => {\n    const nextFirst =\n      tabs.find((t) => t.enabled)?.id || TAB_RAW || TAB_DIAGNOSTICS;\n    setActiveTab(nextFirst);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hasSourceSeo, hasSpecs, hasVariants, hasRaw]);\n\n  return (\n    <div className=\"mt-4\">\n      {/* Tab headers */}\n      <div className=\"mb-3 flex flex-wrap gap-2\">\n        {tabs.map((tab) => {\n          const isActive = activeTab === tab.id;\n          const baseClasses =\n            \"px-3 py-1.5 text-sm rounded border transition-colors\";\n          const activeClasses =\n            \"bg-slate-900 text-white border-slate-900\";\n          const inactiveClasses = tab.enabled\n            ? \"bg-white text-slate-700 border-slate-300 hover:bg-slate-100\"\n            : \"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed\";\n\n          return (\n            <button\n              key={tab.id}\n              type=\"button\"\n              disabled={!tab.enabled}\n              onClick={() => tab.enabled && setActiveTab(tab.id)}\n              className={`${baseClasses} ${\n                isActive ? activeClasses : inactiveClasses\n              }`}\n            >\n              {tab.label}\n            </button>\n          );\n        })}\n      </div>\n\n      {/* Tab content */}\n      <div className=\"border rounded-md p-3 bg-slate-50 text-sm overflow-x-auto\">\n        {activeTab === TAB_SOURCE_SEO && (\n          <SourceSeoPanel payload={payload} hasSourceSeo={hasSourceSeo} />\n        )}\n\n        {activeTab === TAB_SPECS && (\n          <SpecsPanel payload={payload} hasSpecs={hasSpecs} />\n        )}\n\n        {activeTab === TAB_VARIANTS && (\n          <VariantsPanel payload={payload} hasVariants={hasVariants} />\n        )}\n\n        {activeTab === TAB_RAW && (\n          <RawPanel rawJsonSource={rawJsonSource} hasRaw={hasRaw} />\n        )}\n\n        {activeTab === TAB_DIAGNOSTICS && (\n          <DiagnosticsPanel diagnostics={diagnostics} />\n        )}\n      </div>\n    </div>\n  );\n}\n\n/** Source SEO: scraped only, never AvidiaSEO output */\nfunction SourceSeoPanel({\n  payload,\n  hasSourceSeo,\n}: {\n  payload: any;\n  hasSourceSeo: boolean;\n}) {\n  if (!hasSourceSeo) {\n    return (\n      <div className=\"text-slate-500\">\n        No scraped SEO fields were found on the source site.\n      </div>\n    );\n  }\n\n  const seo = payload.source_seo || {};\n\n  return (\n    <div className=\"space-y-2\">\n      <table className=\"w-full text-sm border-collapse\">\n        <tbody>\n          <SeoRow label=\"Source H1\" value={seo.source_h1} />\n          <SeoRow label=\"Title Tag\" value={seo.source_title_tag} />\n          <SeoRow\n            label=\"Meta Description\"\n            value={seo.source_meta_description}\n          />\n          <SeoRow label=\"Canonical\" value={seo.canonical} />\n          <SeoRow label=\"OG Title\" value={seo.og_title} />\n          <SeoRow\n            label=\"OG Description\"\n            value={seo.og_description}\n          />\n        </tbody>\n      </table>\n      <p className=\"mt-2 text-xs text-slate-600\">\n        These SEO fields were extracted from the source website. They\n        are{\" \"}\n        <strong>not generated or optimized by AvidiaTech</strong>.\n      </p>\n    </div>\n  );\n}\n\nfunction SeoRow({ label, value }: { label: string; value: any }) {\n  return (\n    <tr className=\"border-b last:border-none border-slate-200\">\n      <td className=\"font-semibold p-1.5 align-top w-40 text-slate-700\">\n        {label}\n      </td>\n      <td className=\"p-1.5 text-slate-800\">\n        {value ?? <span className=\"text-slate-400\">-</span>}\n      </td>\n    </tr>\n  );\n}\n\n/** Specs panel */\nfunction SpecsPanel({\n  payload,\n  hasSpecs,\n}: {\n  payload: any;\n  hasSpecs: boolean;\n}) {\n  if (!hasSpecs) {\n    return (\n      <div className=\"text-slate-500\">\n        Specs not present in this extraction.\n      </div>\n    );\n  }\n\n  const specsPayload =\n    payload.specs_json || payload.specs || payload.specs_payload;\n\n  return (\n    <pre className=\"bg-slate-900 text-slate-50 p-3 rounded text-xs whitespace-pre-wrap break-words\">\n      {JSON.stringify(specsPayload, null, 2)}\n    </pre>\n  );\n}\n\n/** Variants panel */\nfunction VariantsPanel({\n  payload,\n  hasVariants,\n}: {\n  payload: any;\n  hasVariants: boolean;\n}) {\n  if (!hasVariants) {\n    return (\n      <div className=\"text-slate-500\">\n        No variants detected for this product.\n      </div>\n    );\n  }\n\n  return (\n    <pre className=\"bg-slate-900 text-slate-50 p-3 rounded text-xs whitespace-pre-wrap break-words\">\n      {JSON.stringify(payload.variants, null, 2)}\n    </pre>\n  );\n}\n\n/** Raw JSON / payload panel */\nfunction RawPanel({\n  rawJsonSource,\n  hasRaw,\n}: {\n  rawJsonSource: any;\n  hasRaw: boolean;\n}) {\n  if (!hasRaw) {\n    return (\n      <div className=\"text-slate-500\">\n        No raw payload available for this job.\n      </div>\n    );\n  }\n\n  return (\n    <pre className=\"bg-slate-900 text-slate-50 p-3 rounded text-xs whitespace-pre-wrap break-words\">\n      {JSON.stringify(rawJsonSource, null, 2)}\n    </pre>\n  );\n}\n\n/** Diagnostics panel */\nfunction DiagnosticsPanel({ diagnostics }: { diagnostics: any }) {\n  if (!diagnostics || Object.keys(diagnostics).length === 0) {\n    return (\n      <div className=\"text-slate-500\">\n        No diagnostics were recorded for this extraction.\n      </div>\n    );\n  }\n\n  return (\n    <pre className=\"bg-amber-950 text-amber-50 p-3 rounded text-xs whitespace-pre-wrap break-words\">\n      {JSON.stringify(diagnostics, null, 2)}\n    </pre>\n  );\n}\n","\"use client\";\n\nimport React from \"react\";\n\ntype JsonViewerProps = {\n  data: unknown;\n  loading?: boolean;\n  /** how many levels should be expanded by default (when no filter) */\n  collapsedLevels?: number;\n};\n\n/**\n * Smart, human-friendly JSON viewer inspired by jsonformatter.org:\n *\n * - Auto-focuses on the \"useful\" root:\n *   - If shape is { ok, data: { normalized_payload } } => shows data.normalized_payload\n *   - Else if shape is { ok, data } => shows data\n *   - Else uses the provided object as-is.\n *\n * - Toolbar:\n *   - Shows which root is currently displayed (\"Root: data.normalized_payload\")\n *   - Search box to highlight matching keys/values (expands all nodes when searching)\n *   - Toggle to show the full envelope (raw response) vs focused root.\n *   - \"Copy JSON\" button to copy currently visible JSON.\n *   - \"Download JSON\" button to download currently visible JSON as a .json file.\n *\n * - Tree:\n *   - Collapsible objects/arrays with â–¾/â–¸ arrows\n *   - Indented, monospaced, with colored primitives\n *   - Object/array previews: \"{ 12 keys }\", \"[ 6 items ]\"\n */\nexport default function JsonViewer({\n  data,\n  loading,\n  collapsedLevels = 1,\n}: JsonViewerProps) {\n  const [expanded, setExpanded] = React.useState<Record<string, boolean>>({});\n  const [filter, setFilter] = React.useState(\"\");\n  const [showEnvelope, setShowEnvelope] = React.useState(false);\n  const [copied, setCopied] = React.useState(false);\n\n  const { displayRoot, rootLabel, envelope } = React.useMemo(\n    () => getDisplayRoot(data),\n    [data]\n  );\n\n  const effectiveData = showEnvelope && envelope ? envelope : displayRoot;\n  const effectiveLabel = showEnvelope && envelope ? \"full response\" : rootLabel;\n\n  const hasData =\n    effectiveData !== null &&\n    effectiveData !== undefined &&\n    !(typeof effectiveData === \"object\" &&\n      effectiveData !== null &&\n      Object.keys(effectiveData as any).length === 0);\n\n  const toggle = (path: string) => {\n    setExpanded((prev) => ({\n      ...prev,\n      [path]: !prev[path],\n    }));\n  };\n\n  const normalizedFilter = filter.trim().toLowerCase();\n\n  // Reset \"Copied\" label when data root changes\n  React.useEffect(() => {\n    setCopied(false);\n  }, [effectiveData]);\n\n  const handleCopy = React.useCallback(() => {\n    try {\n      const text = JSON.stringify(effectiveData as any, null, 2);\n      if (typeof navigator !== \"undefined\" && navigator.clipboard) {\n        navigator.clipboard.writeText(text);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 1500);\n      }\n    } catch {\n      // ignore\n    }\n  }, [effectiveData]);\n\n  const handleDownload = React.useCallback(() => {\n    try {\n      const text = JSON.stringify(effectiveData as any, null, 2);\n      const blob = new Blob([text], { type: \"application/json\" });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = \"ingestion.json\";\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n    } catch {\n      // ignore\n    }\n  }, [effectiveData]);\n\n  if (loading) {\n    return (\n      <div className=\"text-xs text-neutral-300\">\n        Loading JSONâ€¦\n      </div>\n    );\n  }\n\n  if (!hasData) {\n    return (\n      <div className=\"text-xs text-neutral-400\">\n        No JSON data available.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"text-xs text-neutral-50\">\n      {/* Toolbar */}\n      <div className=\"flex items-center justify-between gap-2 mb-2\">\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-[10px] uppercase tracking-wide text-neutral-400\">\n            Root\n          </span>\n          <code className=\"px-1.5 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-[11px]\">\n            {effectiveLabel}\n          </code>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <input\n            type=\"text\"\n            value={filter}\n            onChange={(e) => setFilter(e.target.value)}\n            placeholder=\"Search key or value\"\n            className=\"bg-neutral-900 border border-neutral-700 rounded px-2 py-1 text-[11px] text-neutral-100 placeholder:text-neutral-500 focus:outline-none focus:ring-1 focus:ring-sky-500\"\n          />\n          {envelope && (\n            <button\n              type=\"button\"\n              onClick={() => setShowEnvelope((v) => !v)}\n              className={`px-2 py-1 rounded text-[11px] border ${\n                showEnvelope\n                  ? \"bg-neutral-200 text-neutral-900 border-neutral-300\"\n                  : \"bg-neutral-900 text-neutral-100 border-neutral-700 hover:bg-neutral-800\"\n              }`}\n            >\n              {showEnvelope ? \"Focused view\" : \"Full response\"}\n            </button>\n          )}\n          <button\n            type=\"button\"\n            onClick={handleCopy}\n            className=\"px-2 py-1 rounded text-[11px] border bg-neutral-900 text-neutral-100 border-neutral-700 hover:bg-neutral-800\"\n          >\n            {copied ? \"Copied\" : \"Copy JSON\"}\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleDownload}\n            className=\"px-2 py-1 rounded text-[11px] border bg-neutral-900 text-neutral-100 border-neutral-700 hover:bg-neutral-800\"\n          >\n            Download JSON\n          </button>\n        </div>\n      </div>\n\n      {/* Tree */}\n      <div className=\"bg-neutral-900/60 border border-neutral-700 rounded-md p-3 font-mono overflow-auto max-h-[460px]\">\n        <JsonNode\n          name={undefined}\n          value={effectiveData}\n          path=\"$\"\n          level={0}\n          expandedState={expanded}\n          toggle={toggle}\n          defaultExpandedLevels={collapsedLevels}\n          filter={normalizedFilter}\n        />\n      </div>\n    </div>\n  );\n}\n\ntype JsonNodeProps = {\n  name?: string;\n  value: unknown;\n  path: string;\n  level: number;\n  expandedState: Record<string, boolean>;\n  toggle: (path: string) => void;\n  defaultExpandedLevels: number;\n  filter: string;\n};\n\nfunction JsonNode({\n  name,\n  value,\n  path,\n  level,\n  expandedState,\n  toggle,\n  defaultExpandedLevels,\n  filter,\n}: JsonNodeProps) {\n  const type = getType(value);\n  const isComplex = type === \"object\" || type === \"array\";\n\n  const indent = level * 14; // px\n\n  // When searching, expand all complex nodes so matches are visible.\n  const isExpanded =\n    expandedState[path] ??\n    (filter ? true : level < defaultExpandedLevels);\n\n  const label = name !== undefined ? name : undefined;\n\n  const filterMatch = filter\n    ? matchesFilter(label, value, filter)\n    : false;\n\n  const handleToggle = () => {\n    if (!isComplex) return;\n    toggle(path);\n  };\n\n  if (!isComplex) {\n    return (\n      <div\n        style={{ paddingLeft: indent }}\n        className={`leading-5 ${\n          filter && filterMatch ? \"bg-amber-900/60\" : \"\"\n        }`}\n      >\n        {label !== undefined && (\n          <span className=\"text-sky-300 mr-1\">\n            {JSON.stringify(label)}:\n          </span>\n        )}\n        <Primitive value={value} />\n      </div>\n    );\n  }\n\n  // Object / array with explicit tuple typing to satisfy TS\n  const entries: [string, unknown][] =\n    type === \"object\"\n      ? Object.entries(value as Record<string, unknown>)\n      : (value as unknown[]).map(\n          (v, i) => [String(i), v] as [string, unknown]\n        );\n\n  const bracketOpen = type === \"object\" ? \"{\" : \"[\";\n  const bracketClose = type === \"object\" ? \"}\" : \"]\";\n  const summary =\n    type === \"object\"\n      ? `${entries.length} key${entries.length === 1 ? \"\" : \"s\"}`\n      : `${entries.length} item${entries.length === 1 ? \"\" : \"s\"}`;\n\n  return (\n    <div className=\"leading-5\">\n      {/* Header line */}\n      <div\n        style={{ paddingLeft: indent }}\n        className={`cursor-pointer select-none flex items-start gap-1 rounded-sm ${\n          filter && filterMatch\n            ? \"bg-amber-900/60\"\n            : \"hover:bg-neutral-800/60\"\n        }`}\n        onClick={handleToggle}\n      >\n        <span className=\"mt-[1px] text-neutral-400\">\n          {isExpanded ? \"â–¾\" : \"â–¸\"}\n        </span>\n\n        <div>\n          {label !== undefined && (\n            <span className=\"text-sky-300 mr-1\">\n              {JSON.stringify(label)}:\n            </span>\n          )}\n          <span className=\"text-neutral-300\">{bracketOpen}</span>\n          <span className=\"ml-1 text-[11px] text-neutral-500\">\n            {summary}\n          </span>\n          <span className=\"text-neutral-300\">\n            {!isExpanded && entries.length > 0 ? \" â€¦\" : \"\"}\n            {entries.length === 0 && bracketClose}\n          </span>\n        </div>\n      </div>\n\n      {/* Children */}\n      {isExpanded && entries.length > 0 && (\n        <div>\n          {entries.map(([key, val], idx) => {\n            const k = key as string;\n            const v = val;\n            const childPath = `${path}.${k}`;\n            const isLast = idx === entries.length - 1;\n            return (\n              <div key={childPath}>\n                <JsonNode\n                  name={type === \"array\" ? undefined : k}\n                  value={v}\n                  path={childPath}\n                  level={level + 1}\n                  expandedState={expandedState}\n                  toggle={toggle}\n                  defaultExpandedLevels={defaultExpandedLevels}\n                  filter={filter}\n                />\n                {!isLast && (\n                  <span\n                    style={{\n                      paddingLeft: (level + 1) * 14,\n                    }}\n                    className=\"text-neutral-500\"\n                  >\n                    ,\n                  </span>\n                )}\n              </div>\n            );\n          })}\n          <div\n            style={{ paddingLeft: indent }}\n            className=\"text-neutral-300\"\n          >\n            {bracketClose}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction Primitive({ value }: { value: unknown }) {\n  const type = getType(value);\n\n  if (value === null) {\n    return <span className=\"text-amber-300\">null</span>;\n  }\n\n  if (type === \"string\") {\n    return (\n      <span className=\"text-emerald-300\">\n        {JSON.stringify(value)}\n      </span>\n    );\n  }\n\n  if (type === \"number\") {\n    return (\n      <span className=\"text-orange-300\">\n        {String(value)}\n      </span>\n    );\n  }\n\n  if (type === \"boolean\") {\n    return (\n      <span className=\"text-indigo-300\">\n        {String(value)}\n      </span>\n    );\n  }\n\n  return (\n    <span className=\"text-neutral-300\">\n      {JSON.stringify(value)}\n    </span>\n  );\n}\n\nfunction getType(\n  value: unknown\n):\n  | \"null\"\n  | \"string\"\n  | \"number\"\n  | \"boolean\"\n  | \"object\"\n  | \"array\"\n  | \"other\" {\n  if (value === null) return \"null\";\n  if (Array.isArray(value)) return \"array\";\n  const t = typeof value;\n  if (t === \"string\") return \"string\";\n  if (t === \"number\") return \"number\";\n  if (t === \"boolean\") return \"boolean\";\n  if (t === \"object\") return \"object\";\n  return \"other\";\n}\n\n/**\n * Decide what to show as the \"root\" for readability.\n * - If data is { ok, data: { normalized_payload } }, prefer normalized_payload.\n * - Else if data is { ok, data }, prefer data.\n * - Else show the object as-is.\n */\nfunction getDisplayRoot(value: unknown): {\n  displayRoot: unknown;\n  rootLabel: string;\n  envelope: unknown | null;\n} {\n  if (value && typeof value === \"object\" && !Array.isArray(value)) {\n    const obj = value as any;\n    if (\"data\" in obj && obj.data && typeof obj.data === \"object\") {\n      const data = obj.data;\n      if (\"normalized_payload\" in data && data.normalized_payload) {\n        return {\n          displayRoot: data.normalized_payload,\n          rootLabel: \"data.normalized_payload\",\n          envelope: value,\n        };\n      }\n      return {\n        displayRoot: data,\n        rootLabel: \"data\",\n        envelope: value,\n      };\n    }\n  }\n\n  return {\n    displayRoot: value,\n    rootLabel: \"root\",\n    envelope: null,\n  };\n}\n\n/** Filter: does this node match the search term? */\nfunction matchesFilter(\n  name: string | undefined,\n  value: unknown,\n  filter: string\n): boolean {\n  if (!filter) return false;\n\n  const needle = filter.toLowerCase();\n\n  if (name && name.toLowerCase().includes(needle)) {\n    return true;\n  }\n\n  if (value === null || value === undefined) return false;\n\n  if (\n    typeof value === \"string\" ||\n    typeof value === \"number\" ||\n    typeof value === \"boolean\"\n  ) {\n    return String(value).toLowerCase().includes(needle);\n  }\n\n  // Buried / nested values: stringify to search within\n  try {\n    const asString = JSON.stringify(value);\n    return asString.toLowerCase().includes(needle);\n  } catch {\n    return false;\n  }\n}\n","import { useEffect, useState } from \"react\";\n\n/**\n * Poll GET /api/v1/ingest/:id and return { row, loading, error }.\n * Use this for the Extract dual-pane UI.\n */\nexport function useIngestRow(jobId: string | null, intervalMs = 1500) {\n  const [row, setRow] = useState<any | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!jobId) {\n      setRow(null);\n      setLoading(false);\n      setError(null);\n      return;\n    }\n\n    let mounted = true;\n    let timer: number | undefined;\n\n    const fetchRow = async () => {\n      setLoading(true);\n      try {\n        const res = await fetch(`/api/v1/ingest/${encodeURIComponent(jobId)}`);\n        if (!res.ok) {\n          const txt = await res.text().catch(() => \"\");\n          throw new Error(`status fetch failed: ${res.status} ${txt}`);\n        }\n        const json = await res.json();\n        const data = json?.job ? json.job : json;\n        if (!mounted) return;\n        setRow(data);\n        setError(null);\n        setLoading(false);\n        if (!data.status || data.status === \"pending\") timer = window.setTimeout(fetchRow, intervalMs);\n      } catch (err: any) {\n        if (!mounted) return;\n        setError(String(err?.message || err));\n        setLoading(false);\n        timer = window.setTimeout(fetchRow, intervalMs * 2);\n      }\n    };\n\n    fetchRow();\n\n    return () => {\n      mounted = false;\n      if (timer) window.clearTimeout(timer);\n    };\n  }, [jobId, intervalMs]);\n\n  return { row, loading, error };\n}\n","\"use client\";\nimport React, { useState } from \"react\";\n\n/**\n * Header: URL input, toggles, Extract button.\n * Calls POST /api/v1/ingest and invokes onJobCreated(jobId, url).\n *\n * NOTE: onJobCreated signature changed to (jobId: string, url: string)\n * so the parent can fetch the synchronous extraction preview route:\n *   GET /api/v1/ingest/{jobId}?url=<url>\n */\nexport default function ExtractHeader({ onJobCreated }: { onJobCreated: (jobId: string, url: string) => void }) {\n  const [url, setUrl] = useState(\"\");\n  const [fullExtract, setFullExtract] = useState(true);\n  const [includeSeo, setIncludeSeo] = useState(false);\n  const [includeSpecs, setIncludeSpecs] = useState(false);\n  const [includeDocs, setIncludeDocs] = useState(false);\n  const [includeVariants, setIncludeVariants] = useState(false);\n  const [exportType, setExportType] = useState<\"JSON\" | \"Shopify\" | \"BigCommerce\">(\"JSON\");\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState<string | null>(null);\n\n  function onToggleModule(setter: (v: boolean) => void, value: boolean) {\n    if (!value) setFullExtract(false); // turning ON disables fullExtract\n    setter(!value);\n  }\n\n  function onToggleFull() {\n    const next = !fullExtract;\n    setFullExtract(next);\n    if (next) {\n      setIncludeSeo(false);\n      setIncludeSpecs(false);\n      setIncludeDocs(false);\n      setIncludeVariants(false);\n    }\n  }\n\n  async function submit() {\n    if (!url) {\n      setErr(\"Please enter a URL\");\n      return;\n    }\n    setErr(null);\n    setLoading(true);\n    try {\n      const body: any = {\n        url,\n        export_type: exportType,\n        correlationId: `corr_${Date.now()}`,\n        fullExtract,\n      };\n      if (!fullExtract) {\n        body.options = {\n          includeSeo,\n          includeSpecs,\n          includeDocs,\n          includeVariants,\n        };\n      }\n\n      // include Clerk cookies/session so the server sees an authenticated user\n      const res = await fetch(\"/api/v1/ingest\", {\n        method: \"POST\",\n        credentials: \"same-origin\", // include Clerk session cookie\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n\n      const json = await res.json().catch(() => null);\n\n      if (!res.ok) {\n        const message = json?.error || json?.message || `Ingest failed (${res.status})`;\n        setErr(message);\n        return;\n      }\n\n      const id = json?.jobId || json?.job_id || json?.id;\n      if (id) {\n        // pass both jobId and original URL to parent so it can call synchronous preview route\n        onJobCreated(String(id), url);\n      } else {\n        setErr(\"Ingest succeeded but no job id returned\");\n      }\n    } catch (err: any) {\n      setErr(String(err?.message || err));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\", gap: 12 }}>\n      <div style={{ display: \"flex\", gap: 8 }}>\n        <input\n          aria-label=\"Product URL to ingest\"\n          value={url}\n          onChange={(e) => setUrl(e.target.value)}\n          placeholder=\"https://manufacturer.com/product/xyz\"\n          style={{ flex: 1, padding: \"8px 12px\", borderRadius: 6, border: \"1px solid #d1d5db\" }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") submit();\n          }}\n        />\n        <button\n          onClick={submit}\n          disabled={loading}\n          style={{ padding: \"8px 14px\", background: \"#2563eb\", color: \"white\", borderRadius: 6 }}\n        >\n          {loading ? \"Extractingâ€¦\" : \"Extract Product\"}\n        </button>\n      </div>\n\n      <div style={{ display: \"flex\", gap: 12, alignItems: \"center\", flexWrap: \"wrap\" }}>\n        <label style={{ display: \"flex\", alignItems: \"center\", gap: 6 }}>\n          <input type=\"checkbox\" checked={fullExtract} onChange={onToggleFull} />\n          <strong>Full extract (recommended)</strong>\n        </label>\n\n        <label style={{ opacity: fullExtract ? 0.5 : 1, display: \"flex\", alignItems: \"center\", gap: 6 }}>\n          <input type=\"checkbox\" checked={includeSeo} onChange={() => onToggleModule(setIncludeSeo, includeSeo)} disabled={fullExtract} />\n          Include SEO?\n        </label>\n\n        <label style={{ opacity: fullExtract ? 0.5 : 1, display: \"flex\", alignItems: \"center\", gap: 6 }}>\n          <input type=\"checkbox\" checked={includeSpecs} onChange={() => onToggleModule(setIncludeSpecs, includeSpecs)} disabled={fullExtract} />\n          Include Specs?\n        </label>\n\n        <label style={{ opacity: fullExtract ? 0.5 : 1, display: \"flex\", alignItems: \"center\", gap: 6 }}>\n          <input type=\"checkbox\" checked={includeDocs} onChange={() => onToggleModule(setIncludeDocs, includeDocs)} disabled={fullExtract} />\n          Include Manuals / PDF extraction?\n        </label>\n\n        <label style={{ opacity: fullExtract ? 0.5 : 1, display: \"flex\", alignItems: \"center\", gap: 6 }}>\n          <input type=\"checkbox\" checked={includeVariants} onChange={() => onToggleModule(setIncludeVariants, includeVariants)} disabled={fullExtract} />\n          Generate Variants?\n        </label>\n\n        <select value={exportType} onChange={(e) => setExportType(e.target.value as any)} style={{ marginLeft: \"auto\", padding: 6 }}>\n          <option value=\"JSON\">JSON</option>\n          <option value=\"Shopify\">Shopify</option>\n          <option value=\"BigCommerce\">BigCommerce</option>\n        </select>\n      </div>\n\n      {err && <div style={{ color: \"crimson\" }}>{err}</div>}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}