{"version":3,"sources":["../../../../src/components/monitor/NotificationsList.tsx","../../../../src/app/dashboard/monitor/notifications/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\nexport default function NotificationsList() {\n  const [items, setItems] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  async function load() {\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/monitor/notifications\");\n      const j = await res.json().catch(() => null);\n      if (res.ok && j?.ok) setItems(j.notifications ?? []);\n      else setItems([]);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    load();\n  }, []);\n\n  async function markRead(id: string) {\n    try {\n      const res = await fetch(`/api/monitor/notifications`, {\n        method: \"PATCH\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ id, read: true }),\n      });\n      const j = await res.json().catch(() => null);\n      if (!res.ok || !j?.ok) throw new Error(j?.error ?? \"patch failed\");\n      await load();\n    } catch (err: any) {\n      alert(String(err?.message ?? err));\n    }\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex justify-between items-center\">\n        <h3 className=\"text-lg font-medium\">Notifications</h3>\n        <button onClick={load} className=\"px-2 py-1 border rounded text-sm\">Refresh</button>\n      </div>\n\n      {loading ? (\n        <div>Loading…</div>\n      ) : items.length === 0 ? (\n        <div className=\"p-6 text-center\">\n          <div className=\"text-lg font-semibold\">No notifications yet</div>\n          <p className=\"text-sm text-slate-500 mt-2\">Notifications appear when a rule matches an event (e.g., price change). Try one of the actions below to generate a test notification.</p>\n          <div className=\"mt-4 flex justify-center gap-3\">\n            <a href=\"/dashboard/monitor\" className=\"px-4 py-2 rounded border text-sm\">Add watch</a>\n            <a href=\"/dashboard/monitor/rules\" className=\"px-4 py-2 rounded bg-amber-500 text-white text-sm\">Create rule</a>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-2\">\n          {items.map((n) => (\n            <div key={n.id} className={`p-3 border rounded ${n.read ? \"bg-white/60\" : \"bg-amber-50\"}`}>\n              <div className=\"flex justify-between\">\n                <div>\n                  <div className=\"font-medium\">{n.title}</div>\n                  <div className=\"text-xs text-slate-500\">{new Date(n.created_at).toLocaleString()}</div>\n                </div>\n                <div>\n                  {!n.read && <button onClick={() => markRead(n.id)} className=\"px-2 py-1 border rounded text-xs\">Mark read</button>}\n                </div>\n              </div>\n              <pre className=\"mt-2 text-xs bg-slate-50 p-2 rounded max-h-48 overflow-auto\">{JSON.stringify(n.payload ?? n.body ?? {}, null, 2)}</pre>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","\"use client\";\n\nimport React from \"react\";\nimport NotificationsList from \"@/components/monitor/NotificationsList\";\n\n/**\n * Monitor Notifications Page (upgraded, consistent with other Monitor pages)\n * Path: src/app/dashboard/monitor/notifications/page.tsx\n */\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction TinyChip({\n  children,\n  tone = \"neutral\",\n}: {\n  children: React.ReactNode;\n  tone?: \"neutral\" | \"success\" | \"signal\";\n}) {\n  const tones =\n    tone === \"signal\"\n      ? \"border-amber-200/60 bg-amber-50 text-amber-700 dark:border-amber-400/30 dark:bg-amber-500/10 dark:text-amber-100\"\n      : tone === \"success\"\n      ? \"border-emerald-200/60 bg-emerald-50 text-emerald-700 dark:border-emerald-400/30 dark:bg-emerald-500/10 dark:text-emerald-100\"\n      : \"border-slate-200/70 bg-white/75 text-slate-600 dark:border-slate-700/70 dark:bg-slate-950/45 dark:text-slate-300\";\n\n  return (\n    <span\n      className={cx(\n        \"inline-flex items-center gap-2 rounded-full border px-2.5 py-1 text-[11px] shadow-sm backdrop-blur whitespace-nowrap\",\n        tones\n      )}\n    >\n      {children}\n    </span>\n  );\n}\n\nfunction SoftButton({\n  href,\n  children,\n  variant = \"secondary\",\n  className,\n}: {\n  href: string;\n  children: React.ReactNode;\n  variant?: \"primary\" | \"secondary\";\n  className?: string;\n}) {\n  const base =\n    \"inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold whitespace-nowrap transition active:translate-y-[0.5px] focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-50 dark:focus-visible:ring-offset-slate-950\";\n  if (variant === \"primary\") {\n    return (\n      <a\n        href={href}\n        className={cx(\n          base,\n          \"text-slate-950 shadow-[0_16px_34px_-22px_rgba(2,6,23,0.55)]\",\n          \"bg-gradient-to-r from-amber-400 via-amber-500 to-orange-500\",\n          \"hover:from-amber-300 hover:via-amber-500 hover:to-orange-400\",\n          \"focus-visible:ring-amber-400/70\",\n          className\n        )}\n      >\n        {children}\n      </a>\n    );\n  }\n  return (\n    <a\n      href={href}\n      className={cx(\n        base,\n        \"border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm\",\n        \"hover:bg-white hover:text-slate-900\",\n        \"dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50\",\n        \"focus-visible:ring-slate-300/70 dark:focus-visible:ring-slate-700/70\",\n        className\n      )}\n    >\n      {children}\n    </a>\n  );\n}\n\nexport default function MonitorNotificationsPage() {\n  return (\n    <main className=\"relative min-h-screen w-full max-w-[100vw] overflow-x-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50\">\n      {/* BACKGROUND: blobs + radial wash + subtle grid (clipped to prevent horizontal overflow) */}\n      <div className=\"pointer-events-none absolute inset-0 overflow-hidden\">\n        <div className=\"absolute -top-44 -left-36 h-96 w-96 rounded-full bg-sky-300/20 blur-3xl dark:bg-sky-500/15\" />\n        <div className=\"absolute -bottom-44 right-[-12rem] h-[28rem] w-[28rem] rounded-full bg-amber-300/20 blur-3xl dark:bg-amber-500/14\" />\n        <div className=\"absolute top-24 right-12 h-56 w-56 rounded-full bg-emerald-300/12 blur-3xl dark:bg-emerald-500/10\" />\n\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.92)_58%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.92)_58%,_rgba(15,23,42,1)_100%)]\" />\n\n        <div className=\"absolute inset-0 opacity-[0.045] dark:opacity-[0.065]\">\n          <div className=\"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:46px_46px] dark:bg-[linear-gradient(to_right,#1e293b_1px,transparent_1px),linear-gradient(to_bottom,#1e293b_1px,transparent_1px)]\" />\n        </div>\n      </div>\n\n      <div className=\"relative mx-auto w-full max-w-7xl space-y-6 px-4 pt-4 pb-10 sm:px-6 lg:px-8 lg:pt-6\">\n        <header className=\"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between\">\n          <div className=\"space-y-3 min-w-0\">\n            <div className=\"flex flex-wrap items-center gap-3\">\n              <span className=\"inline-flex items-center gap-2 rounded-full border border-amber-300/60 bg-white/80 px-3 py-1.5 text-[11px] font-medium uppercase tracking-[0.18em] text-amber-700 shadow-sm backdrop-blur dark:border-amber-400/35 dark:bg-slate-950/55 dark:text-amber-100 whitespace-nowrap\">\n                <span className=\"inline-flex h-4 w-4 items-center justify-center rounded-full border border-amber-400/60 bg-slate-100 dark:border-amber-400/35 dark:bg-slate-900\">\n                  <span className=\"h-2 w-2 animate-pulse rounded-full bg-amber-500 dark:bg-amber-300\" />\n                </span>\n                Commerce • AvidiaMonitor\n              </span>\n\n              <TinyChip tone=\"success\">\n                <span className=\"h-1.5 w-1.5 rounded-full bg-emerald-400\" />\n                Notifications\n              </TinyChip>\n\n              <TinyChip tone=\"signal\">✨ Rules → Alerts → Triage</TinyChip>\n            </div>\n\n            <div className=\"space-y-2\">\n              <h1 className=\"text-2xl font-semibold leading-tight text-slate-900 lg:text-3xl dark:text-slate-50\">\n                Monitor{\" \"}\n                <span className=\"bg-gradient-to-r from-amber-500 via-orange-500 to-sky-500 bg-clip-text text-transparent dark:from-amber-300 dark:via-orange-300 dark:to-sky-300\">\n                  notifications\n                </span>\n              </h1>\n              <p className=\"max-w-2xl text-sm text-slate-600 dark:text-slate-300\">\n                App notifications generated by Monitor rules and events. Use Rules\n                to control what generates alerts.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap gap-2 lg:justify-end\">\n            <SoftButton href=\"/dashboard/monitor/rules\" variant=\"secondary\">\n              Manage Rules\n            </SoftButton>\n            <SoftButton href=\"/dashboard/monitor\" variant=\"secondary\">\n              Back to Monitor\n            </SoftButton>\n            <SoftButton href=\"/dashboard\" variant=\"primary\">\n              Dashboard\n            </SoftButton>\n          </div>\n        </header>\n\n        <section className=\"rounded-2xl border border-slate-200/70 bg-white/80 p-4 shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/45 overflow-x-hidden\">\n          <div className=\"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between\">\n            <div className=\"min-w-0\">\n              <div className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                Inbox\n              </div>\n              <div className=\"mt-1 text-xs text-slate-500 dark:text-slate-400\">\n                Mark, review, and act on alerts. Pair this with a simple rule like{\" \"}\n                <span className=\"font-medium\">app_notification</span> on{\" \"}\n                <span className=\"font-medium\">change_detected</span>.\n              </div>\n            </div>\n\n            <div className=\"flex flex-wrap gap-2\">\n              <TinyChip>\n                <span className=\"h-1.5 w-1.5 rounded-full bg-sky-400\" />\n                Live feed\n              </TinyChip>\n              <TinyChip>\n                <span className=\"h-1.5 w-1.5 rounded-full bg-amber-400\" />\n                Rule-driven\n              </TinyChip>\n            </div>\n          </div>\n\n          <div className=\"mt-4 rounded-2xl border border-slate-200/70 bg-white/70 p-3 shadow-sm dark:border-slate-800/60 dark:bg-slate-950/35 overflow-x-hidden\">\n            <NotificationsList />\n\n            <div className=\"mt-4 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 text-[11px] text-slate-600 dark:border-slate-800/60 dark:bg-slate-900/30 dark:text-slate-300\">\n              <div className=\"font-semibold text-slate-700 dark:text-slate-200\">\n                Quick tip\n              </div>\n              <div className=\"mt-1\">\n                If you see no notifications, create a watch and enable a simple\n                rule (e.g.,{\" \"}\n                <span className=\"font-medium\">app_notification</span> on{\" \"}\n                <span className=\"font-medium\">change_detected</span>), then trigger\n                a check.\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}