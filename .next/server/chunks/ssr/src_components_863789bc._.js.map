{"version":3,"sources":["../../../../src/components/BackToDashboard.tsx","../../../../src/components/settings/ApiKeysManager.tsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\n\n/**\n * BackToDashboard button\n * - tries history.back() when possible, otherwise falls back to /dashboard\n * - use in settings pages so users can return to the main dashboard quickly\n */\n\nexport default function BackToDashboard() {\n  function goBack(e: React.MouseEvent) {\n    e.preventDefault();\n    try {\n      if (window.history.length > 1) {\n        window.history.back();\n      } else {\n        window.location.href = \"/dashboard\";\n      }\n    } catch {\n      window.location.href = \"/dashboard\";\n    }\n  }\n\n  return (\n    <a href=\"/dashboard\" onClick={goBack} className=\"inline-flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300 hover:underline\">\n      <span aria-hidden>←</span>\n      <span>Back to dashboard</span>\n    </a>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\n/**\n * ApiKeysManager: generate, show, copy and revoke keys\n * - newly created key shown once in modal\n */\n\ntype Key = { id: string; keyPreview: string; created_at: string; last_used?: string; permissions?: string[] };\n\nexport default function ApiKeysManager() {\n  const [keys, setKeys] = useState<Key[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [creating, setCreating] = useState(false);\n  const [newKey, setNewKey] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchKeys();\n  }, []);\n\n  async function fetchKeys() {\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/developer/keys\");\n      const json = await res.json();\n      setKeys(json.keys || []);\n    } catch (err) {\n      console.error(err);\n      setKeys([]);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function createKey() {\n    setCreating(true);\n    try {\n      const res = await fetch(\"/api/developer/keys\", { method: \"POST\" });\n      const json = await res.json();\n      if (res.ok && json.key) {\n        // the backend should return full key string once on creation\n        setNewKey(json.key);\n        // refresh list (key preview)\n        await fetchKeys();\n      } else {\n        alert(json?.error || \"Unable to create key\");\n      }\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setCreating(false);\n    }\n  }\n\n  async function revoke(id: string) {\n    if (!confirm(\"Revoke this key?\")) return;\n    await fetch(`/api/developer/keys/${id}`, { method: \"DELETE\" });\n    await fetchKeys();\n  }\n\n  function copyToClipboard(text: string | null) {\n    if (!text) return;\n    navigator.clipboard.writeText(text).then(() => alert(\"Copied to clipboard\"));\n  }\n\n  return (\n    <div className=\"max-w-4xl\">\n      <div className=\"bg-white dark:bg-slate-900 border rounded-lg p-6 shadow-sm\">\n        <div className=\"flex justify-between items-center\">\n          <h2 className=\"text-lg font-semibold\">API Keys</h2>\n          <div>\n            <button onClick={createKey} disabled={creating} className=\"px-3 py-2 bg-indigo-600 text-white rounded\">\n              {creating ? \"Generating…\" : \"Generate new key\"}\n            </button>\n          </div>\n        </div>\n\n        <p className=\"mt-2 text-sm text-slate-500\">Your API keys allow programmatic access. Keep them secret.</p>\n\n        <div className=\"mt-4\">\n          {loading ? (\n            <p>Loading…</p>\n          ) : keys.length === 0 ? (\n            <p>No keys found</p>\n          ) : (\n            <ul className=\"space-y-3\">\n              {keys.map((k) => (\n                <li key={k.id} className=\"flex items-center justify-between bg-slate-50 dark:bg-slate-800 border rounded p-3\">\n                  <div>\n                    <div className=\"font-mono text-sm\">{k.keyPreview}</div>\n                    <div className=\"text-xs text-slate-500\">Created {new Date(k.created_at).toLocaleString()}</div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <button onClick={() => copyToClipboard(k.keyPreview)} className=\"text-sm px-2 py-1 border rounded\">Copy</button>\n                    <button onClick={() => revoke(k.id)} className=\"text-sm text-red-600\">Revoke</button>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n\n        {newKey && (\n          <div className=\"mt-4 p-4 bg-orange-50 dark:bg-orange-900 border rounded\">\n            <div className=\"font-semibold\">New key</div>\n            <div className=\"font-mono text-sm mt-2 break-all\">{newKey}</div>\n            <div className=\"mt-2 flex gap-2\">\n              <button onClick={() => copyToClipboard(newKey)} className=\"px-3 py-2 bg-indigo-600 text-white rounded\">Copy key</button>\n              <button onClick={() => setNewKey(null)} className=\"px-3 py-2 border rounded\">Close</button>\n            </div>\n            <div className=\"text-xs text-slate-500 mt-2\">Note: This key will only be shown once. Store it securely.</div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}