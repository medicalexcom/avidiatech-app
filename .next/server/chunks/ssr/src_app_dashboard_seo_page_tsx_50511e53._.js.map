{"version":3,"sources":["../../../../src/app/dashboard/seo/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useSearchParams, useRouter } from \"next/navigation\";\n\n/**\n * AvidiaSEO page (client)\n *\n * - Works with ?ingestionId=... OR ?url=...\n * - If ingest returns jobId (202), poll /api/v1/ingest/job/:jobId until ingestion row appears AND is completed.\n * - Then call /api/v1/seo with ingestionId. If persist denied (401), fall back to preview (persist:false).\n */\n\ntype AnyObj = Record<string, any>;\n\nexport default function AvidiaSeoPage() {\n  const params = useSearchParams();\n  const router = useRouter();\n  const ingestionIdParam = params?.get(\"ingestionId\") || null;\n  const urlParam = params?.get(\"url\") || null;\n\n  const ingestionId = ingestionIdParam;\n  const [urlInput, setUrlInput] = useState<string>(urlParam || \"\");\n  const [job, setJob] = useState<AnyObj | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [copyState, setCopyState] = useState<\"idle\" | \"copied\" | \"error\">(\n    \"idle\"\n  );\n  const [showRawExtras, setShowRawExtras] = useState(false);\n\n  // Debug / polling state\n  const [rawIngestResponse, setRawIngestResponse] = useState<any | null>(null);\n  const [pollingState, setPollingState] = useState<string | null>(null);\n\n  // track whether current seo result is preview (not persisted)\n  const [isPreviewResult, setIsPreviewResult] = useState(false);\n\n  // Remember the URL that came from query params; used to decide if we should reuse ingestionId\n  const [initialUrl] = useState(urlParam || \"\");\n\n  const fetchIngestionData = useCallback(\n    async (id: string, isCancelled: () => boolean = () => false) => {\n      setLoading(true);\n      setError(null);\n      setStatusMessage(\"Refreshing ingestion\");\n      try {\n        const res = await fetch(`/api/v1/ingest/${encodeURIComponent(id)}`);\n        const json = await res.json();\n        if (!res.ok) {\n          throw new Error(\n            json?.error?.message ||\n              json?.error ||\n              `Ingest fetch failed: ${res.status}`\n          );\n        }\n        if (!isCancelled()) {\n          // API returns either the row directly or wrapped in { data }\n          setJob(json?.data ?? json);\n          setStatusMessage(\"Ingestion ready\");\n        }\n      } catch (err: any) {\n        if (!isCancelled()) {\n          setError(String(err?.message || err));\n          setStatusMessage(null);\n        }\n      } finally {\n        if (!isCancelled()) {\n          setLoading(false);\n        }\n      }\n    },\n    []\n  );\n\n  useEffect(() => {\n    if (!ingestionId) return;\n    let cancelled = false;\n    setStatusMessage(\"Loading ingestion\");\n    fetchIngestionData(ingestionId, () => cancelled);\n    return () => {\n      cancelled = true;\n    };\n  }, [fetchIngestionData, ingestionId]);\n\n  async function generateFromIngestion(id: string, tryPersist = true) {\n    if (generating) return;\n    setGenerating(true);\n    setError(null);\n    setIsPreviewResult(false);\n    setStatusMessage(\"Generating AvidiaSEO\");\n\n    async function callSeo(persistFlag: boolean) {\n      try {\n        const res = await fetch(\"/api/v1/seo\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ ingestionId: id, persist: persistFlag }),\n        });\n        const json = await res.json().catch(() => null);\n        return { status: res.status, ok: res.ok, json, rawStatus: res.status };\n      } catch (err) {\n        return { status: 0, ok: false, json: null, error: String(err) };\n      }\n    }\n\n    try {\n      if (tryPersist) {\n        const first = await callSeo(true);\n        if (first.ok) {\n          setIsPreviewResult(false);\n          const seoPayload =\n            first.json?.seo_payload ?? first.json?.seoPayload ?? null;\n          const descriptionHtml =\n            first.json?.description_html ??\n            first.json?.descriptionHtml ??\n            null;\n          const features = first.json?.features ?? null;\n          if (seoPayload || descriptionHtml || features) {\n            setJob((prev) => ({\n              ...(prev || {}),\n              seo_payload:\n                seoPayload ?? (prev as AnyObj)?.seo_payload ?? null,\n              description_html:\n                descriptionHtml ??\n                (prev as AnyObj)?.description_html ??\n                null,\n              features: features ?? (prev as AnyObj)?.features ?? null,\n            }));\n            setStatusMessage(\"SEO persisted to Supabase\");\n          }\n          await fetchIngestionData(id);\n          router.push(`/dashboard/seo?ingestionId=${encodeURIComponent(id)}`);\n          return;\n        }\n\n        const code = first.json?.error?.code ?? \"\";\n        if (\n          first.status === 401 ||\n          code === \"UNAUTHORIZED_TO_PERSIST\" ||\n          first.status === 403\n        ) {\n          const preview = await callSeo(false);\n          if (preview.ok) {\n            setIsPreviewResult(true);\n            const previewBody = preview.json;\n            const previewJob = {\n              ...(job || {}),\n              seo_payload:\n                previewBody?.seoPayload ??\n                previewBody?.seo_payload ??\n                previewBody,\n              description_html:\n                previewBody?.descriptionHtml ??\n                previewBody?.description_html ??\n                previewBody?.descriptionHtml ??\n                previewBody?.description_html,\n              _debug: previewBody?._debug ?? null,\n            };\n            setJob(previewJob);\n            setError(\n              \"Preview generated. Sign in to persist SEO for this ingestion.\"\n            );\n            setStatusMessage(\"Preview SEO ready\");\n            return;\n          } else {\n            setError(\n              preview.json?.error?.message ??\n                `Preview failed: ${preview.status}`\n            );\n            setStatusMessage(null);\n            return;\n          }\n        }\n\n        setError(\n          first.json?.error?.message ??\n            `SEO generation failed: ${first.status}`\n        );\n        setStatusMessage(null);\n        return;\n      }\n\n      const result = await callSeo(false);\n      if (result.ok) {\n        setIsPreviewResult(true);\n        const previewBody = result.json;\n        const previewJob = {\n          ...(job || {}),\n          seo_payload:\n            previewBody?.seoPayload ??\n            previewBody?.seo_payload ??\n            previewBody,\n          description_html:\n            previewBody?.descriptionHtml ??\n            previewBody?.description_html ??\n            previewBody,\n        };\n        setJob(previewJob);\n        setStatusMessage(\"Preview SEO ready\");\n      } else {\n        setError(\n          result.json?.error?.message ??\n            `SEO preview failed: ${result.status}`\n        );\n        setStatusMessage(null);\n      }\n    } catch (e: any) {\n      setError(String(e?.message || e));\n      setStatusMessage(null);\n    } finally {\n      setGenerating(false);\n    }\n  }\n\n  // Polling helper: polls /api/v1/ingest/job/:jobId until ingestion row is completed (normalized_payload or status completed)\n  async function pollForIngestion(\n    jobId: string,\n    timeoutMs = 120_000,\n    intervalMs = 3000\n  ) {\n    const start = Date.now();\n    setPollingState(`polling job ${jobId}`);\n    setStatusMessage(\"Scraping & normalizing\");\n    while (Date.now() - start < timeoutMs) {\n      try {\n        const res = await fetch(\n          `/api/v1/ingest/job/${encodeURIComponent(jobId)}`\n        );\n        // 200 -> completed; 202 -> still processing\n        if (res.status === 200) {\n          const j = await res.json();\n          setPollingState(`completed: ingestionId=${j.ingestionId}`);\n          setStatusMessage(\"Ingestion completed\");\n          return j; // { ingestionId, normalized_payload, status }\n        }\n        // still pending\n        const elapsed = Math.floor((Date.now() - start) / 1000);\n        setPollingState(`waiting... ${elapsed}s`);\n      } catch (e) {\n        console.warn(\"pollForIngestion error\", e);\n        setPollingState(`error polling: ${String(e)}`);\n        setStatusMessage(null);\n      }\n      await new Promise((r) => setTimeout(r, intervalMs));\n    }\n    setPollingState(\"timeout\");\n    setStatusMessage(null);\n    throw new Error(\"Ingestion did not complete within timeout\");\n  }\n\n  // Safer ingestion + generate flow\n  async function createIngestionThenGenerate(url: string) {\n    if (generating) return;\n    if (!url) {\n      setError(\"Please enter a URL\");\n      return;\n    }\n    setGenerating(true);\n    setError(null);\n    setRawIngestResponse(null);\n    setPollingState(null);\n    setStatusMessage(\"Submitting ingestion\");\n    try {\n      // 1) create ingestion (persist:true) and request SEO extraction\n      const res = await fetch(\"/api/v1/ingest\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          url,\n          persist: true,\n          options: { includeSeo: true }, // request SEO extraction during ingestion\n        }),\n      });\n      const json = await res.json().catch(() => null);\n      console.debug(\"POST /api/v1/ingest response:\", res.status, json);\n      setRawIngestResponse({ status: res.status, body: json });\n      setStatusMessage(\"Ingestion accepted; waiting for callback\");\n\n      if (!res.ok) {\n        setError(\n          json?.error?.message || json?.error || `Ingest failed: ${res.status}`\n        );\n        return;\n      }\n\n      // If ingest returned a synchronous ingestionId, use it\n      const possibleIngestionId =\n        json?.ingestionId ??\n        json?.id ??\n        json?.data?.id ??\n        json?.data?.ingestionId ??\n        null;\n\n      if (possibleIngestionId) {\n        router.push(\n          `/dashboard/seo?ingestionId=${encodeURIComponent(\n            possibleIngestionId\n          )}`\n        );\n        // If the ingest returned completed payload immediately (status 200 and normalized_payload present), pollForIngestion will return quickly.\n        if (json?.status === \"accepted\" || res.status === 202) {\n          // if the engine accepted job, poll until normalized_payload exists\n          const jobId = json?.jobId ?? json?.ingestionId ?? possibleIngestionId;\n          try {\n            const pollResult = await pollForIngestion(jobId, 120_000, 3000);\n            const newIngestionId =\n              pollResult?.ingestionId ?? possibleIngestionId;\n            router.push(\n              `/dashboard/seo?ingestionId=${encodeURIComponent(\n                newIngestionId\n              )}`\n            );\n            await generateFromIngestion(newIngestionId, true);\n            return;\n          } catch (e: any) {\n            setError(String(e?.message || e));\n            return;\n          }\n        } else {\n          // otherwise call SEO directly\n          await generateFromIngestion(possibleIngestionId, true);\n          return;\n        }\n      }\n\n      // Otherwise, if ingest returned a jobId (async), poll for ingestion completion\n      const jobId = json?.jobId ?? json?.job?.id ?? null;\n      if (!jobId) {\n        setError(\n          \"Ingest did not return an ingestionId or jobId. See debug pane.\"\n        );\n        return;\n      }\n\n      let pollResult;\n      try {\n        pollResult = await pollForIngestion(jobId, 120_000, 3000);\n      } catch (e: any) {\n        setError(String(e?.message || e));\n        return;\n      }\n\n      const newIngestionId =\n        pollResult?.ingestionId ?? pollResult?.id ?? null;\n      if (!newIngestionId) {\n        setError(\"Polling returned no ingestionId. See debug pane.\");\n        return;\n      }\n\n      router.push(\n        `/dashboard/seo?ingestionId=${encodeURIComponent(newIngestionId)}`\n      );\n      await generateFromIngestion(newIngestionId, true);\n    } catch (err: any) {\n      setError(String(err?.message || err));\n    } finally {\n      setGenerating(false);\n      setPollingState(null);\n    }\n  }\n\n  async function handleGenerateAndSave() {\n    setError(null);\n\n    // If we have an ingestionId AND the URL hasn't changed from the original,\n    // treat this as \"re-run SEO on existing ingestion.\"\n    const isSameAsInitial = initialUrl && urlInput === initialUrl;\n\n    if (ingestionId && isSameAsInitial) {\n      await generateFromIngestion(ingestionId, true);\n      return;\n    }\n\n    // Otherwise, always treat as a brand-new run:\n    // clear previous data and kick off full ingest → poll → SEO cascade.\n    setJob(null);\n    setIsPreviewResult(false);\n    setRawIngestResponse(null);\n    setPollingState(null);\n    setStatusMessage(null);\n\n    await createIngestionThenGenerate(urlInput);\n  }\n\n  const jobData = useMemo(() => {\n    if (!job) return null;\n    // allow shapes: { ok, data }, { data }, plain row, or nested { data: { data } }\n    if (job?.data?.data) return job.data.data;\n    if (job?.data) return job.data;\n    return job;\n  }, [job]);\n\n  const seoPayload = jobData?.seo_payload ?? jobData?.seoPayload ?? null;\n\n  const rawDescriptionHtml =\n    jobData?.description_html ??\n    jobData?.descriptionHtml ??\n    jobData?.seo_payload?.description_html ??\n    jobData?._debug?.description_html ??\n    null;\n  const descriptionHtml =\n    typeof rawDescriptionHtml === \"string\" &&\n    rawDescriptionHtml.trim().length > 0\n      ? rawDescriptionHtml\n      : null;\n\n  const features = useMemo(() => {\n    if (Array.isArray(jobData?.features)) return jobData.features;\n    if (Array.isArray(jobData?.seo_payload?.features))\n      return jobData.seo_payload.features;\n    return null;\n  }, [jobData]);\n\n  const highlightedDescription = useMemo(() => {\n    if (!descriptionHtml) return \"<em>No description generated yet</em>\";\n    if (!searchTerm) return descriptionHtml;\n    try {\n      const escaped = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n      const regex = new RegExp(`(${escaped})`, \"gi\");\n      return descriptionHtml.replace(\n        regex,\n        '<mark class=\"bg-amber-200 text-gray-900 px-1 rounded-sm\">$1</mark>'\n      );\n    } catch (err) {\n      console.warn(\"Unable to highlight search term\", err);\n      return descriptionHtml;\n    }\n  }, [descriptionHtml, searchTerm]);\n\n  const knownSeoKeys = [\n    \"h1\",\n    \"pageTitle\",\n    \"title\",\n    \"metaDescription\",\n    \"meta_description\",\n    \"seoShortDescription\",\n    \"seo_short_description\",\n    \"keywords\",\n    \"slug\",\n    \"name_best\",\n  ];\n\n  const parkedExtras = useMemo(() => {\n    if (!seoPayload || typeof seoPayload !== \"object\")\n      return [] as [string, any][];\n    return Object.entries(seoPayload).filter(\n      ([key]) => !knownSeoKeys.includes(key)\n    );\n  }, [seoPayload]);\n\n  const handleCopyDescription = async () => {\n    if (!descriptionHtml) return;\n    try {\n      await navigator.clipboard.writeText(descriptionHtml);\n      setCopyState(\"copied\");\n      setTimeout(() => setCopyState(\"idle\"), 1500);\n    } catch (err) {\n      console.error(\"copy failed\", err);\n      setCopyState(\"error\");\n      setTimeout(() => setCopyState(\"idle\"), 1500);\n    }\n  };\n\n  const handleDownloadDescription = () => {\n    if (!descriptionHtml) return;\n    const blob = new Blob([descriptionHtml], { type: \"text/html\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `avidia-seo-description-${ingestionId || \"preview\"}.html`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const hasSeo = Boolean(seoPayload || descriptionHtml || features);\n\n  const statusPills = useMemo(() => {\n    return [\n      {\n        key: \"scrape\",\n        label: \"Scraping & Normalizing\",\n        state:\n          loading || pollingState\n            ? \"active\"\n            : jobData?.status === \"completed\" || jobData?.normalized_payload\n            ? \"done\"\n            : \"idle\",\n        hint: pollingState || jobData?.status || \"waiting\",\n      },\n      {\n        key: \"seo\",\n        label: \"AvidiaSEO Generation\",\n        state: generating ? \"active\" : hasSeo ? \"done\" : \"idle\",\n        hint: generating\n          ? \"Calling central GPT\"\n          : hasSeo\n          ? \"SEO saved\"\n          : \"ready\",\n      },\n      {\n        key: \"review\",\n        label: \"Human-ready Preview\",\n        state: hasSeo ? \"done\" : \"idle\",\n        hint: hasSeo ? \"Rendered\" : \"awaiting generation\",\n      },\n    ];\n  }, [\n    generating,\n    hasSeo,\n    jobData?.normalized_payload,\n    jobData?.status,\n    loading,\n    pollingState,\n  ]);\n\n  const demoUrl = \"https://www.apple.com/iphone-17/\";\n\n  return (\n    <main className=\"min-h-screen bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50 relative overflow-hidden\">\n      {/* Background treatment (kept, subtle) */}\n      <div className=\"pointer-events-none absolute inset-0\">\n        <div className=\"absolute -top-32 -left-24 h-72 w-72 rounded-full bg-cyan-300/22 blur-3xl dark:bg-cyan-500/15\" />\n        <div className=\"absolute -bottom-24 right-0 h-72 w-72 rounded-full bg-emerald-300/20 blur-3xl dark:bg-emerald-500/10\" />\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.9)_55%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.9)_55%,_rgba(15,23,42,1)_100%)]\" />\n        <div className=\"absolute inset-0 opacity-[0.04] dark:opacity-[0.08]\">\n          <div className=\"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:42px_42px] dark:bg-[linear-gradient(to_right,#1f2937_1px,transparent_1px),linear-gradient(to_bottom,#1f2937_1px,transparent_1px)]\" />\n        </div>\n      </div>\n\n      {/* Compact Cluster-style wrapper */}\n      <div className=\"relative mx-auto max-w-7xl px-4 pt-4 pb-8 space-y-6 lg:px-8 lg:pt-6 lg:pb-10\">\n        {/* HEADER + TOP FLOW (Cluster-aligned, efficient) */}\n        <section className=\"relative flex flex-col gap-6 lg:flex-row lg:items-stretch\">\n          {/* Left: compact header + value props */}\n          <div className=\"flex-1 min-w-[260px] space-y-4\">\n            {/* Module pill row */}\n            <div className=\"inline-flex items-center gap-2 rounded-full border border-cyan-300/70 bg-white/90 px-3 py-1.5 text-[10px] font-medium uppercase tracking-[0.18em] text-slate-600 shadow-sm dark:border-cyan-500/40 dark:bg-slate-950/80 dark:text-cyan-100\">\n              <span className=\"inline-flex h-3 w-3 items-center justify-center rounded-full bg-slate-100 border border-cyan-300 dark:bg-slate-900 dark:border-cyan-400/60\">\n                <span className=\"h-1.5 w-1.5 rounded-full bg-cyan-400 animate-pulse\" />\n              </span>\n              AvidiaTech • AvidiaSEO\n              {ingestionId && (\n                <>\n                  <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                  <span className=\"font-mono text-[10px]\">\n                    {ingestionId.slice(0, 8)}…\n                  </span>\n                </>\n              )}\n            </div>\n\n            {/* Title + subtitle (Cluster typography) */}\n            <div className=\"space-y-2\">\n              <h1 className=\"text-xl sm:text-2xl font-semibold text-slate-900 leading-tight dark:text-slate-50\">\n                Turn any manufacturer URL into a{\" \"}\n                <span className=\"bg-clip-text text-transparent bg-gradient-to-r from-cyan-500 via-sky-500 to-emerald-400 dark:from-cyan-300 dark:via-sky-400 dark:to-emerald-300\">\n                  production-ready SEO page\n                </span>\n                .\n              </h1>\n              <p className=\"text-sm text-slate-600 max-w-xl dark:text-slate-300\">\n                Paste a product URL and fire the whole pipeline: ingestion,\n                cleanup, and compliant copy — rendered exactly how your store\n                needs it. No prompts, no copy-paste gymnastics.\n              </p>\n            </div>\n\n            {/* Value props strip */}\n            <div className=\"flex flex-wrap gap-2 text-[11px]\">\n              <div className=\"inline-flex items-center gap-2 rounded-xl bg-white/90 border border-slate-200 px-3 py-2 shadow-sm dark:bg-slate-950/80 dark:border-slate-700/70\">\n                <span className=\"h-5 w-5 rounded-lg bg-cyan-500/10 border border-cyan-300 flex items-center justify-center text-[13px] text-cyan-700 dark:bg-cyan-500/15 dark:border-cyan-500/40 dark:text-cyan-100\">\n                  1\n                </span>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold text-slate-900 dark:text-slate-50\">\n                    Ingest engine native\n                  </p>\n                  <p className=\"text-slate-500 text-[10px] dark:text-slate-400\">\n                    Reuses the same ingestion layer powering AvidiaExtract.\n                  </p>\n                </div>\n              </div>\n              <div className=\"inline-flex items-center gap-2 rounded-xl bg-white/90 border border-slate-200 px-3 py-2 shadow-sm dark:bg-slate-950/80 dark:border-slate-700/70\">\n                <span className=\"h-5 w-5 rounded-lg bg-sky-500/10 border border-sky-300 flex items-center justify-center text-[13px] text-sky-700 dark:bg-sky-500/15 dark:border-sky-500/40 dark:text-sky-100\">\n                  2\n                </span>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold text-slate-900 dark:text-slate-50\">\n                    Custom GPT brain\n                  </p>\n                  <p className=\"text-slate-500 text-[10px] dark:text-slate-400\">\n                    Runs your instruction sheet, not a generic prompt.\n                  </p>\n                </div>\n              </div>\n              <div className=\"inline-flex items-center gap-2 rounded-xl bg-white/90 border border-slate-200 px-3 py-2 shadow-sm dark:bg-slate-950/80 dark:border-slate-700/70\">\n                <span className=\"h-5 w-5 rounded-lg bg-emerald-500/10 border border-emerald-300 flex items-center justify-center text-[13px] text-emerald-700 dark:bg-emerald-500/15 dark:border-emerald-500/40 dark:text-emerald-100\">\n                  3\n                </span>\n                <div className=\"space-y-0\">\n                  <p className=\"font-semibold text-slate-900 dark:text-slate-50\">\n                    JSON + HTML ready\n                  </p>\n                  <p className=\"text-slate-500 text-[10px] dark:text-slate-400\">\n                    Mirrors your BigCommerce / automation schema.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Callout row (Compact guidance + status pill) */}\n            <div className=\"flex flex-wrap items-center gap-3 pt-1\">\n              <div className=\"inline-flex items-center gap-2 rounded-full bg-slate-100 border border-cyan-200 px-3 py-1.5 text-[11px] shadow-sm dark:bg-slate-950/80 dark:border-cyan-500/30\">\n                <span className=\"text-[11px] font-semibold text-cyan-700 uppercase tracking-[0.16em] dark:text-cyan-200\">\n                  Step 1\n                </span>\n                <span className=\"text-[11px] text-slate-600 dark:text-slate-300\">\n                  Paste the manufacturer URL in the{\" \"}\n                  <span className=\"font-semibold text-cyan-700 dark:text-cyan-200\">\n                    URL box directly below\n                  </span>\n                  .\n                </span>\n              </div>\n              <div className=\"inline-flex items-center gap-1.5 rounded-full bg-slate-100 border border-slate-200 px-3 py-1.5 text-[11px] text-slate-600 shadow-sm dark:bg-slate-950/80 dark:border-slate-700 dark:text-slate-300\">\n                <span className=\"text-xs\">⬇</span>\n                <span>Step 2 — hit “Generate &amp; Save” for full cascade.</span>\n              </div>\n              {statusMessage && (\n                <div className=\"inline-flex items-center gap-2 rounded-full bg-slate-100 border border-cyan-200 px-3 py-1.5 text-[11px] text-cyan-700 shadow-sm dark:bg-slate-950/80 dark:border-cyan-500/40 dark:text-cyan-100\">\n                  <span className=\"h-1.5 w-1.5 rounded-full bg-cyan-400 animate-pulse\" />\n                  {statusMessage}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Right: 3-step flow + live pipeline snapshot (compact cards) */}\n          <div className=\"w-full lg:w-[430px] xl:w-[480px] flex flex-col gap-3\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <p className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                Real-time pipeline\n              </p>\n              <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                {loading || generating ? \"Running…\" : \"Idle\"}\n              </span>\n            </div>\n\n            <div className=\"flex flex-col md:flex-row gap-3\">\n              {/* 3-step visual flow */}\n              <div className=\"flex-1 rounded-2xl bg-white/95 border border-slate-200 px-4 py-3 space-y-2 shadow-sm dark:bg-slate-950/80 dark:border-slate-700/80\">\n                <p className=\"text-[11px] font-medium uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400\">\n                  3-step visual flow\n                </p>\n                <ol className=\"space-y-2.5 text-xs mt-1\">\n                  {statusPills.map((pill, index) => {\n                    const isDone = pill.state === \"done\";\n                    const isActive = pill.state === \"active\";\n                    return (\n                      <li\n                        key={pill.key}\n                        className=\"flex items-center gap-3 relative\"\n                      >\n                        <div className=\"flex flex-col items-center\">\n                          <div\n                            className={[\n                              \"flex h-7 w-7 items-center justify-center rounded-full border text-[11px] font-semibold shadow-sm\",\n                              isDone\n                                ? \"bg-emerald-400 text-slate-900 border-emerald-300 shadow-emerald-500/40\"\n                                : isActive\n                                ? \"bg-cyan-500 text-slate-900 border-cyan-300 animate-pulse shadow-cyan-500/40\"\n                                : \"bg-slate-100 text-slate-500 border-slate-300 dark:bg-slate-900 dark:text-slate-400 dark:border-slate-600\",\n                            ].join(\" \")}\n                          >\n                            {index + 1}\n                          </div>\n                          {index < statusPills.length - 1 && (\n                            <div\n                              className={[\n                                \"mt-1 h-6 w-px\",\n                                isDone || isActive\n                                  ? \"bg-gradient-to-b from-cyan-400 via-emerald-400 to-transparent\"\n                                  : \"bg-slate-200 dark:bg-slate-700\",\n                              ].join(\" \")}\n                            />\n                          )}\n                        </div>\n                        <div className=\"flex-1\">\n                          <p className=\"text-[11px] font-medium text-slate-800 dark:text-slate-100\">\n                            {pill.label}\n                          </p>\n                          <p className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                            {pill.hint}\n                          </p>\n                        </div>\n                      </li>\n                    );\n                  })}\n                </ol>\n              </div>\n\n              {/* Live pipeline status */}\n              <div className=\"flex-1 rounded-2xl bg-white/95 border border-slate-200 px-4 py-3 space-y-2 shadow-sm dark:bg-slate-950/80 dark:border-slate-700/80\">\n                <div className=\"flex items-center justify-between\">\n                  <p className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                    Live pipeline status\n                  </p>\n                  {loading && (\n                    <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                      Loading…\n                    </span>\n                  )}\n                </div>\n                <div className=\"space-y-2 mt-1\">\n                  {statusPills.map((pill) => (\n                    <div\n                      key={pill.key}\n                      className={`flex items-center justify-between px-3 py-1.5 rounded-xl border text-[11px] ${\n                        pill.state === \"done\"\n                          ? \"bg-emerald-50 border-emerald-200 text-emerald-700 dark:bg-emerald-950/70 dark:border-emerald-500/40 dark:text-emerald-100\"\n                          : pill.state === \"active\"\n                          ? \"bg-amber-50 border-amber-200 text-amber-700 dark:bg-amber-950/70 dark:border-amber-500/40 dark:text-amber-100\"\n                          : \"bg-slate-50 border-slate-200 text-slate-600 dark:bg-slate-950/70 dark:border-slate-700 dark:text-slate-300\"\n                      }`}\n                    >\n                      <div className=\"flex items-center gap-2\">\n                        <span\n                          className={`h-2 w-2 rounded-full ${\n                            pill.state === \"done\"\n                              ? \"bg-emerald-400\"\n                              : pill.state === \"active\"\n                              ? \"bg-amber-400 animate-pulse\"\n                              : \"bg-slate-400 dark:bg-slate-500\"\n                          }`}\n                        />\n                        <span className=\"font-medium\">{pill.label}</span>\n                      </div>\n                      <span className=\"text-[10px]\">{pill.hint}</span>\n                    </div>\n                  ))}\n                </div>\n                <p className=\"text-[10px] text-slate-500 mt-1 dark:text-slate-500\">\n                  Every state here reflects real ingestion + SEO calls — not a\n                  fake demo.\n                </p>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Error banner (compact, inline) */}\n        {error && (\n          <div className=\"rounded-2xl border border-rose-300 bg-rose-50 text-rose-800 px-4 py-3 text-sm shadow-sm dark:border-rose-500/40 dark:bg-rose-950/60 dark:text-rose-50\">\n            {error}\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6\">\n          {/* Main work column */}\n          <div className=\"lg:col-span-2 space-y-4\">\n            {/* URL + Generate (directly under header, no heavy hero frame) */}\n            <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 lg:p-5 space-y-3 dark:bg-slate-900/80 dark:border-slate-700/60\">\n              <div className=\"flex items-start justify-between gap-3\">\n                <div>\n                  <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                    One-click AvidiaSEO\n                  </h4>\n                  <p className=\"text-xs text-slate-600 max-w-xl dark:text-slate-400\">\n                    Step 1 — paste the manufacturer URL. Step 2 — hit{\" \"}\n                    <span className=\"font-semibold text-cyan-700 dark:text-cyan-300\">\n                      Generate &amp; Save\n                    </span>\n                    . AvidiaSEO runs ingest → poll → GPT SEO in a single shot.\n                  </p>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <div className=\"flex flex-col sm:flex-row gap-2\">\n                  <input\n                    value={urlInput}\n                    onChange={(e) => {\n                      const next = e.target.value;\n                      setUrlInput(next);\n\n                      // User is preparing a new run: clear previous outputs\n                      setJob(null);\n                      setIsPreviewResult(false);\n                      setRawIngestResponse(null);\n                      setPollingState(null);\n                      setStatusMessage(null);\n                      setError(null);\n                    }}\n                    placeholder=\"https://manufacturer.com/product...\"\n                    className=\"w-full px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-900 placeholder:text-slate-400 focus:border-cyan-400 focus:ring-2 focus:ring-cyan-500/30 text-sm dark:border-slate-700 dark:bg-slate-950/60 dark:text-slate-50 dark:placeholder:text-slate-500\"\n                    type=\"url\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      handleGenerateAndSave();\n                    }}\n                    disabled={generating}\n                    className=\"sm:w-48 w-full px-4 py-3 rounded-lg bg-cyan-500 text-slate-950 text-sm font-semibold shadow-sm hover:bg-cyan-400 disabled:opacity-60 disabled:shadow-none transition-transform hover:-translate-y-[1px]\"\n                  >\n                    {generating ? \"Generating…\" : \"Generate & Save\"}\n                  </button>\n                </div>\n                <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                  <p className=\"text-[11px] text-slate-500 dark:text-slate-500\">\n                    This always runs the full cascade for the current URL. If\n                    the URL matches an existing ingestion, AvidiaSEO reuses it.\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setUrlInput(demoUrl);\n                      setJob(null);\n                      setIsPreviewResult(false);\n                      setRawIngestResponse(null);\n                      setPollingState(null);\n                      setStatusMessage(\"Demo URL loaded — hit Generate & Save\");\n                      setError(null);\n                    }}\n                    className=\"text-[11px] text-cyan-700 hover:text-cyan-600 underline underline-offset-4 dark:text-cyan-300 dark:hover:text-cyan-200\"\n                  >\n                    Try a demo URL\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Premium HTML viewer (flattened: no big gradient halo) */}\n            <div className=\"rounded-2xl bg-white text-slate-900 shadow-sm p-5 border border-slate-200 dark:bg-slate-900/85 dark:text-white dark:border-slate-700/80\">\n              <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                <div>\n                  <p className=\"text-[11px] uppercase tracking-[0.22em] text-slate-500 mb-1 dark:text-slate-400\">\n                    Description window\n                  </p>\n                  <h3 className=\"text-xl sm:text-2xl font-semibold mb-1\">\n                    Premium HTML viewer\n                  </h3>\n                  <p className=\"text-slate-600 text-xs max-w-2xl dark:text-slate-300\">\n                    See the final copy exactly as it will appear on a product\n                    page. Highlight any claim, copy it into your CMS, or export\n                    the HTML for your automation layer.\n                  </p>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  <button\n                    type=\"button\"\n                    onClick={handleCopyDescription}\n                    disabled={!descriptionHtml}\n                    className=\"px-3 py-2 rounded-lg bg-slate-900 text-xs text-slate-50 border border-slate-900 shadow-sm hover:bg-slate-800 disabled:opacity-40 dark:bg-white/5 dark:border-white/25 dark:text-white dark:hover:bg-white/10\"\n                  >\n                    {copyState === \"copied\"\n                      ? \"Copied!\"\n                      : copyState === \"error\"\n                      ? \"Copy failed\"\n                      : \"Copy description\"}\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handleDownloadDescription}\n                    disabled={!descriptionHtml}\n                    className=\"px-3 py-2 rounded-lg bg-slate-900 text-xs text-slate-50 font-semibold border border-slate-900 shadow-sm hover:-translate-y-[1px] transition disabled:opacity-40 disabled:shadow-none dark:bg-white dark:text-slate-900 dark:border-white/30\"\n                  >\n                    Download HTML\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setSearchTerm((prev) => prev.trim())}\n                    className=\"px-3 py-2 rounded-lg bg-amber-400 text-xs text-slate-900 font-semibold shadow-sm hover:bg-amber-300\"\n                  >\n                    Search in text\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"mt-4 flex flex-col gap-3\">\n                <div className=\"flex items-center gap-2 bg-white border border-slate-200 rounded-lg px-3 py-2 dark:bg-white/5 dark:border-white/15\">\n                  <input\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    placeholder=\"Search headline, claims, or FAQs\"\n                    className=\"flex-1 bg-transparent text-xs text-slate-900 placeholder:text-slate-400 focus:outline-none dark:text-white dark:placeholder:text-slate-300\"\n                  />\n                  <span className=\"text-[11px] text-slate-500 dark:text-slate-200\">\n                    Live highlight\n                  </span>\n                </div>\n\n                <div className=\"rounded-2xl bg-white text-slate-900 shadow-inner border border-slate-200 overflow-hidden dark:bg-white dark:text-slate-900 dark:border-slate-200\">\n                  <div className=\"flex items-center justify-between px-4 py-3 border-b border-slate-100 bg-slate-50 dark:bg-slate-50\">\n                    <div>\n                      <p className=\"text-[11px] uppercase tracking-wide text-slate-500 mb-1\">\n                        Rendered description\n                      </p>\n                      <p className=\"text-xs text-slate-600 m-0\">\n                        Mirrors your custom GPT instructions — headings, lists,\n                        disclaimers, and manuals stay structured.\n                      </p>\n                    </div>\n                    {isPreviewResult && (\n                      <span className=\"px-3 py-1 rounded-full bg-amber-100 text-amber-700 text-[11px] font-semibold\">\n                        Preview only — sign in to persist\n                      </span>\n                    )}\n                  </div>\n                  <div className=\"prose prose-slate max-w-none px-6 py-5 text-sm\">\n                    {descriptionHtml ? (\n                      <article\n                        className=\"prose-headings:scroll-mt-20 prose-h2:mt-6 prose-h3:mt-4 prose-ul:list-disc prose-li:marker:text-slate-400\"\n                        dangerouslySetInnerHTML={{\n                          __html: highlightedDescription,\n                        }}\n                      />\n                    ) : (\n                      <div className=\"text-slate-500 text-sm italic\">\n                        No description generated yet. Paste a URL above and run\n                        the pipeline.\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Side column: structure, features, debug */}\n          <div className=\"space-y-4\">\n            {/* SEO structure */}\n            <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 space-y-3 dark:bg-slate-900/80 dark:border-slate-700/60\">\n              <div className=\"flex items-center justify-between\">\n                <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                  SEO structure\n                </h4>\n                <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                  Driven by custom instructions\n                </span>\n              </div>\n              <div className=\"space-y-2 text-xs\">\n                <div className=\"p-3 rounded-lg bg-slate-50 border border-slate-200 dark:bg-slate-950/60 dark:border-slate-700\">\n                  <p className=\"text-[11px] uppercase text-slate-500 mb-1 dark:text-slate-400\">\n                    H1\n                  </p>\n                  <p className=\"font-semibold text-slate-900 dark:text-slate-50\">\n                    {seoPayload?.h1 ??\n                      seoPayload?.name_best ??\n                      \"Not yet generated\"}\n                  </p>\n                </div>\n                <div className=\"p-3 rounded-lg bg-slate-50 border border-slate-200 dark:bg-slate-950/60 dark:border-slate-700\">\n                  <p className=\"text-[11px] uppercase text-slate-500 mb-1 dark:text-slate-400\">\n                    Page title\n                  </p>\n                  <p className=\"font-semibold text-slate-900 dark:text-slate-50\">\n                    {seoPayload?.pageTitle ??\n                      seoPayload?.title ??\n                      \"Not yet generated\"}\n                  </p>\n                </div>\n                <div className=\"p-3 rounded-lg bg-slate-50 border border-slate-200 dark:bg-slate-950/60 dark:border-slate-700\">\n                  <p className=\"text-[11px] uppercase text-slate-500 mb-1 dark:text-slate-400\">\n                    Meta description\n                  </p>\n                  <p className=\"text-slate-800 leading-relaxed dark:text-slate-100\">\n                    {seoPayload?.metaDescription ??\n                      seoPayload?.meta_description ??\n                      \"Not yet generated\"}\n                  </p>\n                </div>\n                <div className=\"p-3 rounded-lg bg-slate-50 border border-slate-200 dark:bg-slate-950/60 dark:border-slate-700\">\n                  <p className=\"text-[11px] uppercase text-slate-500 mb-1 dark:text-slate-400\">\n                    Short description\n                  </p>\n                  <p className=\"text-slate-800 dark:text-slate-100\">\n                    {seoPayload?.seoShortDescription ??\n                      seoPayload?.seo_short_description ??\n                      \"Not yet generated\"}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Features + parked extras */}\n            <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 space-y-3 dark:bg-slate-900/80 dark:border-slate-700/60\">\n              <div className=\"flex items-center justify-between\">\n                <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                  Feature bullets\n                </h4>\n                <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                  What the enforcer kept\n                </span>\n              </div>\n              {Array.isArray(features) && features.length > 0 ? (\n                <ul className=\"list-disc list-inside space-y-1 text-xs text-slate-800 dark:text-slate-100\">\n                  {features.map((feat: string, idx: number) => (\n                    <li key={idx}>{feat}</li>\n                  ))}\n                </ul>\n              ) : (\n                <p className=\"text-slate-500 text-xs dark:text-slate-400\">\n                  No features captured yet. Generate SEO to see normalized\n                  bullets.\n                </p>\n              )}\n\n              {parkedExtras.length > 0 && (\n                <div className=\"mt-3 border-t border-slate-200 pt-3 dark:border-slate-700\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowRawExtras((v) => !v)}\n                    className=\"text-xs text-cyan-700 hover:text-cyan-600 underline underline-offset-4 dark:text-cyan-300 dark:hover:text-cyan-200\"\n                  >\n                    {showRawExtras ? \"Hide\" : \"Show\"} parked extras (\n                    {parkedExtras.length})\n                  </button>\n                  {showRawExtras && (\n                    <pre className=\"mt-2 p-3 rounded-lg bg-slate-900 text-[11px] text-slate-100 border border-slate-700 overflow-auto dark:bg-slate-950/70\">\n                      {JSON.stringify(\n                        Object.fromEntries(parkedExtras),\n                        null,\n                        2\n                      )}\n                    </pre>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Debug: Source SEO */}\n            {jobData && ingestionId && (\n              <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 space-y-3 dark:bg-slate-900/80 dark:border-slate-700/60\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                    Source SEO (scraped)\n                  </h4>\n                  <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                    Live from ingestion\n                  </span>\n                </div>\n                <pre className=\"bg-slate-900/95 border border-slate-800 rounded-lg p-3 text-[11px] text-slate-100 whitespace-pre-wrap break-words dark:bg-slate-950/70\">\n                  {JSON.stringify(\n                    jobData.normalized_payload ?? jobData,\n                    null,\n                    2\n                  )}\n                </pre>\n              </div>\n            )}\n\n            {/* Debug: raw ingest response */}\n            {rawIngestResponse && (\n              <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 space-y-3 dark:bg-slate-900/80 dark:border-slate-700/60\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">\n                    Raw /api/v1/ingest response\n                  </h4>\n                  {pollingState && (\n                    <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                      {pollingState}\n                    </span>\n                  )}\n                </div>\n                <pre className=\"bg-slate-900/95 border border-slate-800 rounded-lg p-3 text-[11px] text-slate-100 whitespace-pre-wrap break-words dark:bg-slate-950/70\">\n                  {JSON.stringify(rawIngestResponse, null, 2)}\n                </pre>\n              </div>\n            )}\n\n            {/* Inline preview if no ingestionId but we got a payload */}\n            {job && !ingestionId && (job.seo_payload || job.seoPayload) && (\n              <div className=\"rounded-2xl bg-white border border-slate-200 shadow-sm p-4 space-y-2 text-xs text-slate-800 dark:bg-slate-900/80 dark:border-slate-700/60 dark:text-slate-100\">\n                <h5 className=\"text-xs font-semibold text-slate-900 dark:text-slate-50\">\n                  Preview Generated SEO\n                </h5>\n                <p>\n                  <strong>H1:</strong>{\" \"}\n                  {(job.seo_payload ?? job.seoPayload)?.h1 ?? \"\"}\n                </p>\n                <p>\n                  <strong>Title:</strong>{\" \"}\n                  {(job.seo_payload ?? job.seoPayload)?.title ?? \"\"}\n                </p>\n                <p>\n                  <strong>Meta:</strong>{\" \"}\n                  {(job.seo_payload ?? job.seoPayload)?.meta_description ??\n                    (job.seo_payload ?? job.seoPayload)?.metaDescription ??\n                    \"\"}\n                </p>\n                <div\n                  className=\"rounded-lg border border-slate-200 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-950/70\"\n                  dangerouslySetInnerHTML={{\n                    __html:\n                      job.description_html ||\n                      job.descriptionHtml ||\n                      \"<em>No description generated</em>\",\n                  }}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}