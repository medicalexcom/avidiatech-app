{"version":3,"sources":["../../../../src/app/dashboard/seo/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\n\n/**\n * /dashboard/seo\n *\n * Premium hybrid page (Extract + Describe + Monitor patterns)\n *\n * Key behaviors:\n * - Lets operators run SEO in two ways:\n *   1) From a URL (create a new ingestion)\n *   2) From an existing ingestionId (re-run / replay)\n * - Two run modes:\n *   - \"SEO only\": extract → seo\n *   - \"Full pipeline\": extract → seo → audit → import → monitor → price\n *\n * Bulk:\n * - Paste many URLs (optional price column) or upload a CSV to populate the paste box.\n * - Create a bulk job by calling POST /api/v1/bulk (existing wiring).\n *\n * Operator guardrails:\n * - Never report “completed” if pipeline status is “failed”.\n * - Ingestion polling treats terminal errors as terminal (server returns 409).\n * - When running a pipeline against an existing ingestion id (no new ingestion created),\n *   we persist a small diagnostics “re-run” flag (best-effort) so operators can see it was a re-run.\n */\n\ntype AnyObj = Record<string, any>;\n\ntype PipelineRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\";\ntype ModuleRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\" | \"skipped\";\n\ntype PipelineModule = {\n  id?: string;\n  module_index: number;\n  module_name: string;\n  status: ModuleRunStatus;\n  started_at?: string | null;\n  finished_at?: string | null;\n  output_ref?: string | null;\n  error?: any;\n};\n\ntype PipelineSnapshot = {\n  run?: ({ id: string; status: PipelineRunStatus } & Record<string, any>) | null;\n  modules?: PipelineModule[] | null;\n};\n\ntype RunMode = \"seo\" | \"full\";\ntype SourceMode = \"url\" | \"ingestion\";\n\ntype BulkItem = { input_url: string; metadata: Record<string, any> };\n\ntype ToastTone = \"info\" | \"success\" | \"error\" | \"warn\";\ntype Toast = { id: string; tone: ToastTone; message: string };\n\n\nconst SEO_ONLY_STEPS = [\"extract\", \"seo\"] as const;\nconst FULL_STEPS = [\"extract\", \"seo\", \"audit\", \"import\", \"monitor\", \"price\"] as const;\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction safeDateMs(v?: string | null) {\n  if (!v) return null;\n  const ms = Date.parse(v);\n  return Number.isFinite(ms) ? ms : null;\n}\n\nfunction clamp(n: number, min: number, max: number) {\n  return Math.max(min, Math.min(max, n));\n}\n\nfunction formatDuration(ms: number) {\n  if (!Number.isFinite(ms) || ms < 0) return \"—\";\n  const s = Math.floor(ms / 1000);\n  if (s < 60) return `${s}s`;\n  const m = Math.floor(s / 60);\n  const r = s % 60;\n  return `${m}m ${r}s`;\n}\n\nfunction extractEngineErrorMessage(payload: any): string {\n  const e = payload?.error;\n  if (typeof e === \"string\" && e.trim()) return e;\n  if (e && typeof e === \"object\") {\n    return String(e.message || e.detail || e.code || \"ingest_engine_error\");\n  }\n  return String(payload?.last_error || \"ingest_engine_error\");\n}\n\nfunction shortId(id?: string | null, keep = 6) {\n  if (!id) return \"—\";\n  const s = String(id);\n  if (s.length <= keep * 2 + 2) return s;\n  return `${s.slice(0, keep)}…${s.slice(-keep)}`;\n}\n\nfunction statusPillTone(status?: string | null) {\n  const s = String(status || \"\").toLowerCase();\n  if (s === \"succeeded\" || s === \"success\") return \"bg-emerald-50 text-emerald-800 border-emerald-200\";\n  if (s === \"failed\" || s === \"error\") return \"bg-rose-50 text-rose-800 border-rose-200\";\n  if (s === \"running\") return \"bg-sky-50 text-sky-800 border-sky-200\";\n  if (s === \"queued\" || s === \"pending\") return \"bg-amber-50 text-amber-800 border-amber-200\";\n  return \"bg-slate-50 text-slate-700 border-slate-200\";\n}\n\n\nfunction Spinner({ className }: { className?: string }) {\n  return (\n    <svg\n      className={cx(\"h-4 w-4 animate-spin\", className)}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n      <path\n        className=\"opacity-75\"\n        fill=\"currentColor\"\n        d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"\n      />\n    </svg>\n  );\n}\n\n/* ---- Bulk parse helper (inline) ----\n   Accept lines like:\n     https://example.com/product\n     https://example.com/prod, 19.99\n   Returns [{ input_url, metadata }]\n*/\nfunction parseBulkText(text: string): BulkItem[] {\n  if (!text) return [];\n  const lines = text\n    .split(/\\r?\\n/)\n    .map((l) => l.trim())\n    .filter((l) => l.length > 0);\n  const items: BulkItem[] = [];\n  for (const raw of lines) {\n    // split by comma or tab\n    const parts = raw.split(/[,|\\t]/).map((p) => p.trim());\n    const url = parts[0];\n    if (!url) continue;\n    const meta: Record<string, any> = {};\n    if (parts[1]) {\n      const p = parts[1].replace(/\\$/g, \"\");\n      const f = parseFloat(p);\n      if (!Number.isNaN(f)) meta.price = f;\n      else meta.note = parts[1];\n    }\n    items.push({ input_url: url, metadata: meta });\n  }\n  return items;\n}\n\n/* ---- Minimal CSV parsing to populate bulkText ----\n   - Detect header row if it contains \"url\"\n   - Accept columns: url, price (optional)\n   - Produces bulkText lines in: url, price\n*/\nfunction splitCsvLine(line: string): string[] {\n  const out: string[] = [];\n  let cur = \"\";\n  let inQuotes = false;\n\n  for (let i = 0; i < line.length; i++) {\n    const ch = line[i];\n\n    if (ch === '\"') {\n      // escaped quote\n      if (inQuotes && line[i + 1] === '\"') {\n        cur += '\"';\n        i++;\n      } else {\n        inQuotes = !inQuotes;\n      }\n      continue;\n    }\n\n    if (!inQuotes && ch === \",\") {\n      out.push(cur.trim());\n      cur = \"\";\n      continue;\n    }\n\n    cur += ch;\n  }\n\n  out.push(cur.trim());\n  return out.map((v) => v.replace(/^\"|\"$/g, \"\").trim());\n}\n\nfunction csvToBulkText(csv: string): string {\n  if (!csv) return \"\";\n  const rows = csv\n    .split(/\\r?\\n/)\n    .map((r) => r.trim())\n    .filter((r) => r.length > 0);\n\n  if (!rows.length) return \"\";\n\n  const first = splitCsvLine(rows[0]).map((h) => h.toLowerCase());\n  const hasHeader = first.some((h) => h.includes(\"url\"));\n\n  let urlIdx = 0;\n  let priceIdx = -1;\n  let startAt = 0;\n\n  if (hasHeader) {\n    urlIdx = Math.max(\n      0,\n      first.findIndex((h) => h === \"url\" || h.includes(\"product_url\") || h.includes(\"product url\") || h.includes(\"link\"))\n    );\n    priceIdx = first.findIndex((h) => h === \"price\" || h.includes(\"msrp\") || h.includes(\"cost\"));\n    startAt = 1;\n  } else {\n    // best guess: first col = url, second col = price\n    urlIdx = 0;\n    priceIdx = 1;\n    startAt = 0;\n  }\n\n  const lines: string[] = [];\n  for (let i = startAt; i < rows.length; i++) {\n    const cols = splitCsvLine(rows[i]);\n    const url = (cols[urlIdx] || \"\").trim();\n    if (!url) continue;\n\n    const priceRaw = priceIdx >= 0 ? (cols[priceIdx] || \"\").trim() : \"\";\n    if (priceRaw) lines.push(`${url}, ${priceRaw}`);\n    else lines.push(url);\n  }\n\n  return lines.join(\"\\n\");\n}\n\n/* ----------------- Component ----------------- */\nexport default function AvidiaSeoPage() {\n  const params = useSearchParams();\n  const router = useRouter();\n\n  const ingestionIdParam = params?.get(\"ingestionId\") || \"\";\n  const urlParam = params?.get(\"url\") || \"\";\n  const pipelineRunIdParam = params?.get(\"pipelineRunId\") || \"\";\n\n  const [sourceMode, setSourceMode] = useState<SourceMode>(urlParam ? \"url\" : ingestionIdParam ? \"ingestion\" : \"url\");\n  const [runMode, setRunMode] = useState<RunMode>(urlParam ? \"full\" : \"seo\");\n  const [panelMode, setPanelMode] = useState<\"single\" | \"bulk\">(urlParam || ingestionIdParam ? \"single\" : \"single\");\n\n  const [urlInput, setUrlInput] = useState<string>(urlParam || \"\");\n  const [ingestionIdInput, setIngestionIdInput] = useState<string>(ingestionIdParam || \"\");\n\n  // If a URL equals the current page urlParam and we already have an ingestionId, we can re-run without creating a new ingestion.\n  const [reuseExistingWhenSameUrl, setReuseExistingWhenSameUrl] = useState<boolean>(true);\n\n  const [job, setJob] = useState<AnyObj | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [copyState, setCopyState] = useState<\"idle\" | \"copied\" | \"error\">(\"idle\");\n\n  const [toasts, setToasts] = useState<Toast[]>([]);\n\n  function pushToast(message: string, tone: ToastTone = \"info\", ttlMs = 2600) {\n    const id = `${Date.now()}-${Math.random().toString(16).slice(2)}`;\n    setToasts((prev) => [...prev, { id, tone, message }].slice(-4));\n    window.setTimeout(() => {\n      setToasts((prev) => prev.filter((t) => t.id !== id));\n    }, ttlMs);\n  }\n\n\n  // Debug / polling state\n  const [rawIngestResponse, setRawIngestResponse] = useState<any | null>(null);\n  const [pollingState, setPollingState] = useState<string | null>(null);\n\n  // Pipeline state\n  const [pipelineRunId, setPipelineRunId] = useState<string | null>(pipelineRunIdParam || null);\n  const [pipelineSnapshot, setPipelineSnapshot] = useState<PipelineSnapshot | null>(null);\n\n  // ---- Bulk UI state ----\n  const [bulkText, setBulkText] = useState<string>(\"\");\n  const [bulkPreview, setBulkPreview] = useState<BulkItem[]>([]);\n  const [bulkName, setBulkName] = useState<string>(\"\");\n  const [bulkCreating, setBulkCreating] = useState(false);\n  const [bulkJobId, setBulkJobId] = useState<string | null>(null);\n  const [bulkError, setBulkError] = useState<string | null>(null);\n  const [bulkCsvName, setBulkCsvName] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (pipelineRunIdParam) setPipelineRunId(pipelineRunIdParam);\n  }, [pipelineRunIdParam]);\n\n  useEffect(() => {\n    // Keep UI sensible when page loads with params.\n    if (urlParam) {\n      setPanelMode(\"single\");\n      setSourceMode(\"url\");\n      setRunMode(\"full\");\n      setUrlInput(urlParam);\n    } else if (ingestionIdParam) {\n      setPanelMode(\"single\");\n      setSourceMode(\"ingestion\");\n      setIngestionIdInput(ingestionIdParam);\n    }\n  }, [urlParam, ingestionIdParam]);\n\n  useEffect(() => {\n    // Auto-fetch ingestion data when ingestionId changes.\n    const id = ingestionIdInput.trim();\n    if (!id) return;\n    fetchIngestionData(id).catch((e) => {\n      console.warn(\"fetchIngestionData failed\", e);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ingestionIdInput]);\n\n  async function fetchIngestionData(id: string) {\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/v1/ingest/${encodeURIComponent(id)}`);\n      const json = await res.json().catch(() => null);\n      if (!res.ok) throw new Error(json?.error?.message || json?.error || `Fetch failed: ${res.status}`);\n      const row = json?.data ?? json;\n      setJob(row);\n      return row;\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function fetchPipelineSnapshot(runId: string) {\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline fetch failed: ${res.status}`);\n    return json as PipelineSnapshot;\n  }\n\n  async function pollPipeline(runId: string, timeoutMs = 180_000, intervalMs = 2000) {\n    const start = Date.now();\n    while (Date.now() - start < timeoutMs) {\n      const snap = await fetchPipelineSnapshot(runId);\n      setPipelineSnapshot(snap);\n      const s = snap?.run?.status;\n      if (s === \"succeeded\" || s === \"failed\") return snap;\n      await sleep(intervalMs);\n    }\n    throw new Error(\"Pipeline did not complete within timeout\");\n  }\n\n  /**\n   * Polls /api/v1/ingest/job/:jobId until:\n   * - 200 => returns payload\n   * - 409 => throws terminal error (stop polling)\n   * - 202 => continues polling\n   */\n  async function pollForIngestion(jobId: string, timeoutMs = 120_000, intervalMs = 3000) {\n    const start = Date.now();\n    setPollingState(`polling job ${jobId}`);\n    setStatusMessage(\"Scraping & normalizing\");\n\n    while (Date.now() - start < timeoutMs) {\n      const res = await fetch(`/api/v1/ingest/job/${encodeURIComponent(jobId)}`);\n      const payload = await res.json().catch(() => null);\n\n      if (res.status === 200) {\n        setPollingState(`completed: ingestionId=${payload?.ingestionId}`);\n        setStatusMessage(\"Ingestion callback received\");\n        return payload;\n      }\n\n      if (res.status === 409) {\n        const msg = extractEngineErrorMessage(payload);\n        setPollingState(`failed: ${msg}`);\n        setStatusMessage(null);\n        const err: any = new Error(msg);\n        err.code = payload?.error?.code || \"ingest_engine_error\";\n        err.payload = payload;\n        throw err;\n      }\n\n      const elapsed = Math.floor((Date.now() - start) / 1000);\n      setPollingState(`waiting... ${elapsed}s`);\n      await sleep(intervalMs);\n    }\n\n    setPollingState(\"timeout\");\n    setStatusMessage(null);\n    throw new Error(\"Ingestion did not complete within timeout\");\n  }\n\n  async function createIngestion(url: string) {\n    if (!url) throw new Error(\"Please enter a URL\");\n\n    setError(null);\n    setRawIngestResponse(null);\n    setPollingState(null);\n    setStatusMessage(\"Submitting ingestion\");\n\n    const res = await fetch(\"/api/v1/ingest\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        url,\n        persist: true,\n        options: { includeSeo: true },\n      }),\n    });\n\n    const json = await res.json().catch(() => null);\n    console.debug(\"POST /api/v1/ingest response:\", res.status, json);\n    setRawIngestResponse({ status: res.status, body: json });\n\n    if (!res.ok) {\n      throw new Error(json?.error?.message || json?.error || `Ingest failed: ${res.status}`);\n    }\n\n    const possibleIngestionId = json?.ingestionId ?? json?.id ?? json?.data?.id ?? json?.data?.ingestionId ?? null;\n\n    if (possibleIngestionId) {\n      if (json?.status === \"accepted\" || res.status === 202) {\n        const jobId = json?.jobId ?? json?.ingestionId ?? possibleIngestionId;\n        const pollResult = await pollForIngestion(jobId, 120_000, 3000);\n        return String(pollResult?.ingestionId ?? possibleIngestionId);\n      }\n      return String(possibleIngestionId);\n    }\n\n    const jobId = json?.jobId ?? json?.job?.id ?? null;\n    if (!jobId) throw new Error(\"Ingest did not return an ingestionId or jobId. See debug.\");\n    const pollResult = await pollForIngestion(jobId, 120_000, 3000);\n    const newId = pollResult?.ingestionId ?? pollResult?.id ?? null;\n    if (!newId) throw new Error(\"Polling returned no ingestionId.\");\n    return String(newId);\n  }\n\n  async function startPipelineRun(forIngestionId: string, mode: RunMode) {\n    const steps = mode === \"seo\" ? SEO_ONLY_STEPS : FULL_STEPS;\n\n    setStatusMessage(\"Starting pipeline\");\n    const res = await fetch(\"/api/v1/pipeline/run\", {\n      method: \"POST\",\n      headers: { \"content-type\": \"application/json\" },\n      body: JSON.stringify({\n        ingestionId: forIngestionId,\n        triggerModule: \"seo\",\n        steps,\n        options: {},\n      }),\n    });\n\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline start failed: ${res.status}`);\n\n    const runId = String(json?.pipelineRunId ?? \"\");\n    if (!runId) throw new Error(\"Pipeline start did not return pipelineRunId\");\n\n    setPipelineRunId(runId);\n\n    // Keep page URL stable + shareable for operators\n    const qp = new URLSearchParams();\n    qp.set(\"ingestionId\", forIngestionId);\n    if (urlInput.trim()) qp.set(\"url\", urlInput.trim());\n    qp.set(\"pipelineRunId\", runId);\n    router.push(`/dashboard/seo?${qp.toString()}`);\n\n    setStatusMessage(\"Pipeline running\");\n    return runId;\n  }\n\n  /**\n   * markIngestionRerun\n   *\n   * Best-effort: attempt to persist a small diagnostics flag on the ingestion indicating this UI triggered a rerun.\n   * Tries POST /api/v1/ingest/{id}/diagnostics with minimal payload; if it fails we log a warning and continue.\n   * After success (or even failure), we refresh the ingestion row to show operators the current diagnostics.\n   */\n  async function markIngestionRerun(ingestionIdToMark: string, modeToMark: RunMode) {\n    try {\n      const payload = {\n        rerun_by_ui: true,\n        rerun_at: new Date().toISOString(),\n        rerun_mode: modeToMark,\n        note: \"ui_rerun_flag\",\n      };\n\n      // Primary attempt: POST to diagnostics endpoint (preferred)\n      const res = await fetch(`/api/v1/ingest/${encodeURIComponent(ingestionIdToMark)}/diagnostics`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n\n      if (res.ok) {\n        await fetchIngestionData(ingestionIdToMark);\n        return true;\n      }\n\n      // Fallback: try PATCH-ing the ingestion record (best-effort)\n      const fallback = await fetch(`/api/v1/ingest/${encodeURIComponent(ingestionIdToMark)}`, {\n        method: \"PATCH\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ diagnostics: { ...(job as any)?.diagnostics, ui_rerun: payload } }),\n      });\n\n      if (fallback.ok) {\n        await fetchIngestionData(ingestionIdToMark);\n        return true;\n      }\n\n      console.warn(\"markIngestionRerun: all attempts failed\", {\n        resStatus: res.status,\n        fallbackStatus: fallback.status,\n      });\n      return false;\n    } catch (err) {\n      console.warn(\"markIngestionRerun failed\", err);\n      return false;\n    }\n  }\n\n  async function runNow() {\n    if (generating) return;\n\n    setGenerating(true);\n    setError(null);\n    setStatusMessage(null);\n    setPipelineSnapshot(null);\n\n    try {\n      const trimmedUrl = (urlInput || \"\").trim();\n      const trimmedIngestion = (ingestionIdInput || \"\").trim();\n\n      let idToUse: string | null = null;\n      let createdNewIngestion = false;\n\n      if (sourceMode === \"ingestion\") {\n        if (!trimmedIngestion) throw new Error(\"Please enter an ingestionId\");\n        idToUse = trimmedIngestion;\n      } else {\n        if (!trimmedUrl) throw new Error(\"Please enter a URL\");\n        // If operator keeps the same url as the one in query params AND we already have an ingestion id,\n        // allow replay without creating a new ingestion (optional toggle).\n        const isSameAsInitial = Boolean(urlParam && trimmedUrl && urlParam === trimmedUrl);\n        if (reuseExistingWhenSameUrl && isSameAsInitial && ingestionIdParam) {\n          idToUse = ingestionIdParam;\n          setIngestionIdInput(ingestionIdParam);\n        } else {\n          setJob(null);\n          setRawIngestResponse(null);\n          setPollingState(null);\n          idToUse = await createIngestion(trimmedUrl);\n          createdNewIngestion = true;\n          setIngestionIdInput(String(idToUse));\n        }\n      }\n\n      if (!idToUse) throw new Error(\"No ingestionId available to run pipeline\");\n\n      // If we didn't create a new ingestion, mark as rerun (best-effort)\n      if (!createdNewIngestion) {\n        await markIngestionRerun(idToUse, runMode);\n      }\n\n      // fetch current ingestion row before starting pipeline (improves telemetry)\n      await fetchIngestionData(idToUse);\n\n      const runId = await startPipelineRun(idToUse, runMode);\n\n      const snap = await pollPipeline(runId, runMode === \"seo\" ? 180_000 : 300_000, 2000);\n\n      // Always refresh ingestion after pipeline stops (success or failure)\n      await fetchIngestionData(idToUse);\n\n      const finalStatus = snap?.run?.status;\n\n      if (finalStatus === \"succeeded\") {\n        setStatusMessage(runMode === \"seo\" ? \"SEO run succeeded\" : \"Full pipeline succeeded\");\n        pushToast(runMode === \"seo\" ? \"SEO run succeeded\" : \"Full pipeline succeeded\", \"success\");\n      } else if (finalStatus === \"failed\") {\n        setStatusMessage(null);\n        throw new Error(\"Pipeline failed (see pipeline telemetry + module output).\");\n      } else {\n        setStatusMessage(null);\n        throw new Error(`Pipeline ended in unexpected status: ${String(finalStatus)}`);\n      }\n    } catch (e: any) {\n      if (e?.payload) console.warn(\"Terminal ingest error payload:\", e.payload);\n      const msg = String(e?.message || e);\n      setError(msg);\n      pushToast(msg, \"error\");\n      setStatusMessage(null);\n    } finally {\n      setGenerating(false);\n      setPollingState(null);\n    }\n  }\n\n  const jobData = useMemo(() => {\n    if (!job) return null;\n    if ((job as any)?.data?.data) return (job as any).data.data;\n    if ((job as any)?.data) return (job as any).data;\n    return job;\n  }, [job]);\n\n  const seo = useMemo(() => {\n    return (jobData as any)?.seo ?? (jobData as any)?.seoPayload ?? (jobData as any)?.seo_payload ?? null;\n  }, [jobData]);\n\n  const rawDescriptionHtml =\n    (jobData as any)?.descriptionHtml ?? (jobData as any)?.description_html ?? (jobData as any)?._debug?.description_html ?? null;\n\n  const descriptionHtml = typeof rawDescriptionHtml === \"string\" && rawDescriptionHtml.trim().length > 0 ? rawDescriptionHtml : null;\n\n  const features = useMemo(() => {\n    if (Array.isArray((jobData as any)?.features)) return (jobData as any).features;\n    if (Array.isArray((jobData as any)?.seo_payload?.features)) return (jobData as any).seo_payload.features;\n    return null;\n  }, [jobData]);\n\n  const highlightedDescription = useMemo(() => {\n    if (!descriptionHtml) return \"<em>No description generated yet</em>\";\n    if (!searchTerm) return descriptionHtml;\n    try {\n      const escaped = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n      const regex = new RegExp(`(${escaped})`, \"gi\");\n      return descriptionHtml.replace(regex, '<mark class=\"bg-amber-200 text-gray-900 px-1 rounded-sm\">$1</mark>');\n    } catch (err) {\n      console.warn(\"Unable to highlight search term\", err);\n      return descriptionHtml;\n    }\n  }, [descriptionHtml, searchTerm]);\n\n  const knownSeoKeys = [\n    \"h1\",\n    \"pageTitle\",\n    \"title\",\n    \"metaDescription\",\n    \"meta_description\",\n    \"seoShortDescription\",\n    \"seo_short_description\",\n    \"shortDescription\",\n    \"short_description\",\n    \"keywords\",\n    \"slug\",\n    \"name_best\",\n  ];\n\n  const parkedExtras = useMemo(() => {\n    if (!seo || typeof seo !== \"object\") return [] as [string, any][];\n    return Object.entries(seo).filter(([key]) => !knownSeoKeys.includes(key));\n  }, [seo]);\n\n  const handleCopyDescription = async () => {\n    if (!descriptionHtml) return;\n    try {\n      await navigator.clipboard.writeText(descriptionHtml);\n      setCopyState(\"copied\");\n      pushToast(\"Description copied\", \"success\");\n      setTimeout(() => setCopyState(\"idle\"), 1500);\n    } catch (err) {\n      console.warn(\"clipboard copy failed\", err);\n      setCopyState(\"error\");\n      pushToast(\"Copy failed\", \"error\");\n      setTimeout(() => setCopyState(\"idle\"), 1500);\n    }\n  };\n\n  const moduleDurations = useMemo(() => {\n    const mods = (pipelineSnapshot?.modules ?? []) as PipelineModule[];\n    return mods.map((m) => {\n      const start = safeDateMs(m.started_at ?? null);\n      const end = safeDateMs(m.finished_at ?? null);\n      const duration = start != null && end != null ? clamp(end - start, 0, 24 * 60 * 60 * 1000) : null;\n      return { ...m, duration_ms: duration };\n    });\n  }, [pipelineSnapshot]);\n\n  // Rerun indicator from persisted diagnostics (if present)\n  const rerunInfo = useMemo(() => {\n    const d = (jobData as any)?.diagnostics;\n    if (!d) return null;\n    if (d?.ui_rerun) return d.ui_rerun;\n    if (d?.rerun_by_ui) {\n      return { rerun_by_ui: true, rerun_at: d?.rerun_at, rerun_mode: d?.rerun_mode };\n    }\n    if (d?.ui_rerun?.rerun_by_ui) return d.ui_rerun;\n    return null;\n  }, [jobData]);\n\n  const pipelineStatus = pipelineSnapshot?.run?.status || (pipelineRunId ? \"running\" : null);\n\n  const canRun =\n    !generating &&\n    ((sourceMode === \"url\" && urlInput.trim().length > 0) || (sourceMode === \"ingestion\" && ingestionIdInput.trim().length > 0));\n\n\n  useEffect(() => {\n    function onKeyDown(e: KeyboardEvent) {\n      const isEnter = e.key === \"Enter\";\n      if (!isEnter) return;\n\n      // Ctrl/⌘ + Enter => run single\n      if ((e.ctrlKey || e.metaKey) && panelMode === \"single\" && canRun && !generating) {\n        e.preventDefault();\n        runNow();\n        return;\n      }\n\n      // Shift + Enter => create bulk\n      if (e.shiftKey && panelMode === \"bulk\" && bulkText.trim().length > 0 && !bulkCreating) {\n        e.preventDefault();\n        createBulk();\n      }\n    }\n\n    window.addEventListener(\"keydown\", onKeyDown);\n    return () => window.removeEventListener(\"keydown\", onKeyDown);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [panelMode, canRun, generating, bulkCreating, bulkText]);\n\n  /* ---------------- Bulk helpers ---------------- */\n  function previewBulk() {\n    try {\n      const items = parseBulkText(bulkText);\n      setBulkPreview(items);\n      setBulkError(null);\n    } catch (e: any) {\n      setBulkError(String(e?.message || e));\n      setBulkPreview([]);\n    }\n  }\n\n  const bulkDecoratedPreview = useMemo(() => {\n    const items = bulkPreview || [];\n    const seen = new Set<string>();\n    return items.map((it, idx) => {\n      const key = it.input_url.trim();\n      const dup = seen.has(key);\n      seen.add(key);\n      return { ...it, _idx: idx, _key: key || String(idx), _dup: dup };\n    });\n  }, [bulkPreview]);\n\n  const bulkStats = useMemo(() => {\n    const items = bulkPreview || [];\n    const seen = new Set<string>();\n    let kept = 0;\n    let deduped = 0;\n    for (const it of items) {\n      const k = it.input_url.trim();\n      if (!k) continue;\n      if (seen.has(k)) deduped++;\n      else {\n        seen.add(k);\n        kept++;\n      }\n    }\n    return { total: items.length, kept, deduped };\n  }, [bulkPreview]);\n\n  const bulkCanSubmit = useMemo(() => {\n    return !bulkCreating && bulkText.trim().length > 0;\n  }, [bulkCreating, bulkText]);\n\n  async function onBulkCsvPicked(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    try {\n      const t = await file.text();\n      const converted = csvToBulkText(t);\n      if (!converted.trim()) throw new Error(\"CSV contained no usable URL rows\");\n      setBulkCsvName(file.name);\n      setBulkText(converted);\n      setBulkError(null);\n      pushToast(`Loaded CSV: ${file.name}`, \"success\");\n      setBulkPreview([]);\n    } catch (err: any) {\n      const msg = String(err?.message || err);\n      setBulkError(msg);\n      pushToast(msg, \"error\");\n    } finally {\n      // reset so picking same file again triggers onChange\n      e.target.value = \"\";\n    }\n  }\n\n  async function createBulk() {\n    if (bulkCreating) return;\n    setBulkCreating(true);\n    setBulkError(null);\n    setBulkJobId(null);\n\n    try {\n      // basic validation\n      if (!bulkText.trim()) throw new Error(\"Paste at least one URL\");\n      const name = bulkName.trim() || `bulk-${new Date().toISOString()}`;\n      const res = await fetch(\"/api/v1/bulk\", {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ name, pasted: bulkText }),\n      });\n      const j = await res.json().catch(() => null);\n      if (!res.ok || !j?.bulkJobId) {\n        throw new Error(j?.error || j?.message || `Bulk create failed: ${res?.status}`);\n      }\n      setBulkJobId(String(j.bulkJobId));\n      pushToast(\"Bulk job created\", \"success\");\n      // Navigate to bulk dashboard (existing page) with the id as param for operator convenience\n      router.push(`/dashboard/bulk?bulkJobId=${encodeURIComponent(String(j.bulkJobId))}`);\n    } catch (err: any) {\n      const msg = String(err?.message || err);\n      setBulkError(msg);\n      pushToast(msg, \"error\");\n    } finally {\n      setBulkCreating(false);\n    }\n  }\n\n  /* ---------------- Layout ---------------- */\n  return (\n    <main className=\"relative min-h-[calc(100vh-64px)]\">\n      {/* Background treatment (artsy, module-gradients) */}\n      <div className=\"pointer-events-none absolute inset-0 -z-10\">\n        <div className=\"absolute inset-0 bg-gradient-to-b from-slate-50 via-white to-white dark:from-slate-950 dark:via-slate-950 dark:to-slate-950\" />\n        <div\n          className=\"absolute inset-0\"\n          style={{\n            background:\n              \"radial-gradient(circle at 18% 6%, rgba(14,165,233,0.22), transparent 45%), radial-gradient(circle at 78% 10%, rgba(16,185,129,0.18), transparent 48%), radial-gradient(circle at 72% 76%, rgba(245,158,11,0.16), transparent 50%)\",\n          }}\n        />\n        <div\n          className=\"absolute inset-0 opacity-30\"\n          style={{\n            backgroundSize: \"24px 24px\",\n            backgroundImage:\n              \"linear-gradient(to right, rgba(148,163,184,0.08) 1px, transparent 1px), linear-gradient(to bottom, rgba(148,163,184,0.08) 1px, transparent 1px)\",\n          }}\n        />\n        <div className=\"absolute -top-24 left-1/2 h-72 w-[70rem] -translate-x-1/2 rounded-full bg-sky-200/35 blur-3xl dark:bg-sky-900/20\" />\n        <div className=\"absolute top-64 -left-24 h-72 w-72 rounded-full bg-emerald-200/30 blur-3xl dark:bg-emerald-900/15\" />\n        <div className=\"absolute bottom-0 -right-24 h-72 w-72 rounded-full bg-amber-200/25 blur-3xl dark:bg-amber-900/15\" />\n      </div>\n\n      {/* Toasts */}\n      {toasts.length ? (\n        <div className=\"fixed right-4 top-[84px] z-50 flex w-[min(420px,calc(100vw-2rem))] flex-col gap-2\">\n          {toasts.map((t) => (\n            <div\n              key={t.id}\n              className={cx(\n                \"rounded-2xl border bg-white/90 px-3 py-2 text-sm shadow-lg backdrop-blur dark:bg-slate-950/70\",\n                t.tone === \"success\" && \"border-emerald-200 text-emerald-900 dark:border-emerald-900/40 dark:text-emerald-200\",\n                t.tone === \"error\" && \"border-rose-200 text-rose-900 dark:border-rose-900/40 dark:text-rose-200\",\n                t.tone === \"warn\" && \"border-amber-200 text-amber-900 dark:border-amber-900/40 dark:text-amber-200\",\n                t.tone === \"info\" && \"border-slate-200 text-slate-800 dark:border-slate-800 dark:text-slate-200\"\n              )}\n            >\n              <div className=\"flex items-start gap-2\">\n                <span\n                  className={cx(\n                    \"mt-1 inline-block h-2 w-2 rounded-full\",\n                    t.tone === \"success\" && \"bg-emerald-500\",\n                    t.tone === \"error\" && \"bg-rose-500\",\n                    t.tone === \"warn\" && \"bg-amber-500\",\n                    t.tone === \"info\" && \"bg-sky-500\"\n                  )}\n                />\n                <div className=\"min-w-0\">\n                  <div className=\"break-words\">{t.message}</div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : null}\n\n      <div className=\"mx-auto w-full max-w-7xl px-4 py-6 md:px-6 lg:px-8\">\n        {/* Hero (no extra frame) */}\n        <section className=\"relative\">\n          <div className=\"flex flex-col gap-4 md:flex-row md:items-end md:justify-between\">\n            <div className=\"max-w-3xl\">\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\">\n                <span className=\"h-2 w-2 rounded-full bg-gradient-to-r from-sky-500 via-emerald-500 to-amber-500\" />\n                AvidiaSEO <span className=\"text-slate-400\">•</span> <span className=\"text-slate-500 dark:text-slate-300\">Extract → SEO → HTML</span>\n              </div>\n\n              <h1 className=\"mt-3 text-2xl font-semibold tracking-tight text-slate-900 dark:text-slate-100 md:text-3xl\">\n                SEO-ready fields + description HTML, with full run telemetry\n              </h1>\n              <p className=\"mt-2 text-sm text-slate-600 dark:text-slate-300\">\n                Run SEO from a URL, replay a stored ingestion, or queue many URLs in bulk. You always keep the diagnostic trail:\n                module statuses, per-module outputs, and the raw ingestion JSON.\n              </p>\n            </div>\n\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <div className={cx(\"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs\", statusPillTone(pipelineStatus))}>\n                <span className=\"font-medium\">Pipeline</span>\n                <span className=\"text-slate-400\">•</span>\n                <span>{pipelineStatus || \"—\"}</span>\n              </div>\n\n              {ingestionIdInput.trim() ? (\n                <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\">\n                  <span className=\"font-medium\">Ingestion</span>\n                  <span className=\"text-slate-400\">•</span>\n                  <span className=\"font-mono\">{shortId(ingestionIdInput.trim())}</span>\n                </div>\n              ) : null}\n\n              {pipelineRunId ? (\n                <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\">\n                  <span className=\"font-medium\">Run</span>\n                  <span className=\"text-slate-400\">•</span>\n                  <span className=\"font-mono\">{shortId(pipelineRunId)}</span>\n                </div>\n              ) : null}\n\n              {rerunInfo ? (\n                <div className=\"inline-flex items-center gap-2 rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-xs text-amber-900 shadow-sm\">\n                  <span className=\"font-medium\">Re-run</span>\n                  <span className=\"text-amber-500\">•</span>\n                  <span>{rerunInfo?.rerun_mode || \"—\"}</span>\n                  {rerunInfo?.rerun_at ? <span className=\"text-amber-700\">{new Date(rerunInfo.rerun_at).toLocaleString()}</span> : null}\n                </div>\n              ) : null}\n            </div>\n          </div>\n\n          {/* Launcher / Bulk (full-width, mode switch) */}\n          <div className=\"mt-5 rounded-3xl bg-gradient-to-r from-sky-500/35 via-emerald-500/25 to-amber-500/30 p-[1px]\">\n            <div className=\"rounded-3xl border border-white/30 bg-white/80 p-5 shadow-sm backdrop-blur dark:border-slate-800/70 dark:bg-slate-950/35 md:p-6\">\n              <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n                <div className=\"min-w-0\">\n                  <div className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Run SEO</div>\n                  <div className=\"mt-0.5 text-xs text-slate-500 dark:text-slate-400\">\n                    Choose input + run mode, or switch to bulk. No hidden assumptions.\n                  </div>\n                </div>\n\n                <div className=\"inline-flex w-full max-w-[420px] rounded-2xl bg-slate-100/80 p-1 text-xs shadow-sm dark:bg-slate-900/50\">\n                  <button\n                    className={cx(\n                      \"flex-1 rounded-xl px-3 py-2 text-left\",\n                      panelMode === \"single\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                    )}\n                    onClick={() => setPanelMode(\"single\")}\n                    disabled={generating || bulkCreating}\n                  >\n                    Single run\n                    <div className=\"mt-0.5 text-[11px] text-slate-500 dark:text-slate-400\">URL or ingestionId</div>\n                  </button>\n\n                  <button\n                    className={cx(\n                      \"flex-1 rounded-xl px-3 py-2 text-left\",\n                      panelMode === \"bulk\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                    )}\n                    onClick={() => setPanelMode(\"bulk\")}\n                    disabled={generating || bulkCreating}\n                  >\n                    Bulk URLs\n                    <div className=\"mt-0.5 text-[11px] text-slate-500 dark:text-slate-400\">Paste or upload CSV</div>\n                  </button>\n                </div>\n              </div>\n\n              {panelMode === \"single\" ? (\n                <div className=\"mt-5 grid grid-cols-1 gap-4 lg:grid-cols-12\">\n                  <div className=\"min-w-0 lg:col-span-8\">\n                    <div className=\"inline-flex rounded-2xl bg-slate-100/80 p-1 text-xs shadow-sm dark:bg-slate-900/50\">\n                      <button\n                        className={cx(\n                          \"rounded-xl px-3 py-2 text-left\",\n                          sourceMode === \"url\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                        )}\n                        onClick={() => setSourceMode(\"url\")}\n                        disabled={generating}\n                      >\n                        From URL\n                      </button>\n                      <button\n                        className={cx(\n                          \"rounded-xl px-3 py-2 text-left\",\n                          sourceMode === \"ingestion\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                        )}\n                        onClick={() => setSourceMode(\"ingestion\")}\n                        disabled={generating}\n                      >\n                        From ingestionId\n                      </button>\n                    </div>\n\n                    {sourceMode === \"url\" ? (\n                      <div className=\"mt-3\">\n                        <label className=\"text-xs font-medium text-slate-700 dark:text-slate-200\">Source URL</label>\n                        <input\n                          value={urlInput}\n                          onChange={(e) => setUrlInput(e.target.value)}\n                          className=\"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm outline-none placeholder:text-slate-400 focus:border-sky-400 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                          placeholder=\"https://example.com/product/...\"\n                          disabled={generating}\n                        />\n\n                        {ingestionIdParam && urlParam ? (\n                          <label className=\"mt-2 flex cursor-pointer items-center gap-2 text-xs text-slate-600 dark:text-slate-300\">\n                            <input\n                              type=\"checkbox\"\n                              checked={reuseExistingWhenSameUrl}\n                              onChange={(e) => setReuseExistingWhenSameUrl(e.target.checked)}\n                              disabled={generating}\n                            />\n                            Re-use existing ingestionId when URL matches this page\n                          </label>\n                        ) : null}\n                      </div>\n                    ) : (\n                      <div className=\"mt-3\">\n                        <label className=\"text-xs font-medium text-slate-700 dark:text-slate-200\">Ingestion ID</label>\n                        <input\n                          value={ingestionIdInput}\n                          onChange={(e) => setIngestionIdInput(e.target.value)}\n                          className=\"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm outline-none placeholder:text-slate-400 focus:border-sky-400 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                          placeholder=\"ing_...\"\n                          disabled={generating}\n                        />\n                        <div className=\"mt-2 text-[11px] text-slate-500 dark:text-slate-400\">\n                          Replays a stored ingestion and marks diagnostics as a re-run (best-effort).\n                        </div>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"lg:col-span-4\">\n                    <div className=\"rounded-2xl border border-slate-200/70 bg-white/70 p-4 shadow-sm dark:border-slate-800/70 dark:bg-slate-950/25\">\n                      <div className=\"flex items-center justify-between gap-3\">\n                        <div>\n                          <div className=\"text-xs font-medium text-slate-600 dark:text-slate-300\">Run mode</div>\n                          <div className=\"mt-0.5 text-sm font-semibold text-slate-900 dark:text-slate-100\">\n                            {runMode === \"seo\" ? \"SEO only\" : \"Full pipeline\"}\n                          </div>\n                        </div>\n\n                        {ingestionIdInput.trim() ? (\n                          <a\n                            className=\"text-xs text-slate-600 underline dark:text-slate-300\"\n                            href={`/dashboard/monitor?ingestionId=${encodeURIComponent(ingestionIdInput.trim())}`}\n                          >\n                            Open Monitor\n                          </a>\n                        ) : null}\n                      </div>\n\n                      <div className=\"mt-3 grid grid-cols-2 gap-2 rounded-2xl bg-slate-100/80 p-1 text-xs dark:bg-slate-900/50\">\n                        <button\n                          className={cx(\n                            \"rounded-xl px-3 py-2 text-left\",\n                            runMode === \"seo\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                          )}\n                          onClick={() => setRunMode(\"seo\")}\n                          disabled={generating}\n                        >\n                          SEO only\n                          <div className=\"mt-0.5 text-[11px] text-slate-500 dark:text-slate-400\">extract → seo</div>\n                        </button>\n\n                        <button\n                          className={cx(\n                            \"rounded-xl px-3 py-2 text-left\",\n                            runMode === \"full\" ? \"bg-white text-slate-900 shadow-sm dark:bg-slate-950 dark:text-slate-100\" : \"text-slate-600 dark:text-slate-300\"\n                          )}\n                          onClick={() => setRunMode(\"full\")}\n                          disabled={generating}\n                        >\n                          Full pipeline\n                          <div className=\"mt-0.5 text-[11px] text-slate-500 dark:text-slate-400\">extract → … → price</div>\n                        </button>\n                      </div>\n\n                      <div className=\"mt-3 flex items-center gap-2\">\n                        <button\n                          className={cx(\n                            \"inline-flex flex-1 items-center justify-center rounded-2xl px-3 py-2 text-sm font-semibold text-white shadow-sm\",\n                            canRun ? \"bg-gradient-to-r from-sky-600 via-emerald-600 to-amber-600 hover:brightness-[1.05]\" : \"bg-slate-300 dark:bg-slate-700\"\n                          )}\n                          onClick={runNow}\n                          disabled={!canRun}\n                        >\n                          {generating ? (\n                            <span className=\"inline-flex items-center gap-2\">\n                              <Spinner className=\"text-white\" />\n                              Running…\n                            </span>\n                          ) : runMode === \"seo\" ? \"Run SEO\" : \"Run Full Pipeline\"}\n                        </button>\n\n                        {ingestionIdInput.trim() ? (\n                          <button\n                            className=\"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-200\"\n                            onClick={() => fetchIngestionData(ingestionIdInput.trim())}\n                            disabled={generating}\n                            title=\"Refresh ingestion row\"\n                          >\n                            Refresh\n                          </button>\n                        ) : null}\n                      </div>\n                      <div className=\"mt-2 text-[11px] text-slate-500 dark:text-slate-400\">\n                        Shortcut: <span className=\"font-mono\">Ctrl/⌘ + Enter</span> to run.\n                      </div>\n\n                      {statusMessage ? (\n                        <div className=\"mt-3 rounded-2xl border border-slate-200/70 bg-white/60 px-3 py-2 text-xs text-slate-700 dark:border-slate-800/70 dark:bg-slate-950/30 dark:text-slate-200\">\n                          <span className=\"font-medium\">Status</span>\n                          <span className=\"text-slate-400\"> • </span>\n                          <span>{statusMessage}</span>\n                        </div>\n                      ) : null}\n\n                      {pollingState ? (\n                        <div className=\"mt-2 rounded-2xl border border-slate-200/70 bg-white/60 px-3 py-2 text-xs text-slate-700 dark:border-slate-800/70 dark:bg-slate-950/30 dark:text-slate-200\">\n                          <span className=\"font-medium\">Ingest</span>\n                          <span className=\"text-slate-400\"> • </span>\n                          <span>{pollingState}</span>\n                        </div>\n                      ) : null}\n\n                      {error ? (\n                        <div className=\"mt-3 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-900\">\n                          {error}\n                        </div>\n                      ) : null}\n\n                      {rawIngestResponse ? (\n                        <details className=\"mt-3\">\n                          <summary className=\"cursor-pointer text-xs text-slate-600 dark:text-slate-300\">Ingest debug</summary>\n                          <pre className=\"mt-2 max-h-[220px] overflow-auto rounded-2xl border border-slate-800 bg-black p-3 text-[11px] text-white\">\n                            {JSON.stringify(rawIngestResponse, null, 2)}\n                          </pre>\n                        </details>\n                      ) : null}\n                    </div>\n                  </div>\n\n                  <div className=\"lg:col-span-12\">\n                    <div className=\"mt-1 flex flex-wrap items-center gap-2\">\n                      {ingestionIdInput.trim() ? (\n                        <a\n                          className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\"\n                          href={`/dashboard/extract?ingestionId=${encodeURIComponent(ingestionIdInput.trim())}`}\n                        >\n                          Open Extract\n                        </a>\n                      ) : null}\n\n                      {ingestionIdInput.trim() ? (\n                        <a\n                          className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\"\n                          href={`/dashboard/describe?ingestionId=${encodeURIComponent(ingestionIdInput.trim())}`}\n                        >\n                          Open Describe\n                        </a>\n                      ) : null}\n\n                      {ingestionIdInput.trim() ? (\n                        <a\n                          className=\"inline-flex items-center gap-2 rounded-full border border-slate-200/70 bg-white/70 px-3 py-1 text-xs text-slate-700 shadow-sm dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-200\"\n                          href={`/dashboard/monitor?ingestionId=${encodeURIComponent(ingestionIdInput.trim())}`}\n                        >\n                          Open Monitor\n                        </a>\n                      ) : null}\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-5\">\n                  <div className=\"grid grid-cols-1 gap-4 lg:grid-cols-12\">\n                    <div className=\"lg:col-span-8\">\n                      <div className=\"flex items-start justify-between gap-3\">\n                        <div>\n                          <h3 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Bulk URLs</h3>\n                          <p className=\"mt-0.5 text-xs text-slate-500 dark:text-slate-400\">\n                            Paste one URL per line. Optional price may follow after a comma: <code>https://... , 19.99</code>\n                          </p>\n                        </div>\n\n                        <label className=\"inline-flex cursor-pointer items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 shadow-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-200\">\n                          Upload CSV\n                          <input type=\"file\" accept=\".csv,text/csv\" className=\"hidden\" onChange={onBulkCsvPicked} />\n                        </label>\n                      </div>\n\n                      <textarea\n                        value={bulkText}\n                        onChange={(e) => setBulkText(e.target.value)}\n                        placeholder=\"https://example.com/product-1, 19.99\\nhttps://example.com/product-2\"\n                        className=\"mt-3 w-full min-h-[180px] rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm outline-none placeholder:text-slate-400 focus:border-sky-400 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                      />\n\n                      {bulkCsvName ? (\n                        <div className=\"mt-2 text-xs text-slate-500 dark:text-slate-400\">\n                          Loaded CSV: <span className=\"font-medium\">{bulkCsvName}</span>\n                        </div>\n                      ) : null}\n                    </div>\n\n                    <div className=\"lg:col-span-4\">\n                      <div className=\"rounded-2xl border border-slate-200/70 bg-white/70 p-4 shadow-sm dark:border-slate-800/70 dark:bg-slate-950/25\">\n                        <div className=\"text-xs font-medium text-slate-600 dark:text-slate-300\">Job setup</div>\n\n                        <input\n                          value={bulkName}\n                          onChange={(e) => setBulkName(e.target.value)}\n                          placeholder=\"Job name (optional)\"\n                          className=\"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm outline-none placeholder:text-slate-400 focus:border-sky-400 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                        />\n\n                        <div className=\"mt-3 flex flex-wrap items-center gap-2\">\n                          <button\n                            className=\"inline-flex items-center justify-center rounded-2xl bg-sky-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:brightness-[1.05]\"\n                            onClick={previewBulk}\n                            disabled={!bulkText.trim() || bulkCreating}\n                          >\n                            {bulkCreating ? (\n                              <span className=\"inline-flex items-center gap-2\">\n                                <Spinner className=\"text-white\" />\n                                Preview\n                              </span>\n                            ) : (\n                              \"Preview\"\n                            )}\n                          </button>\n                          <button\n                            className={cx(\n                              \"inline-flex flex-1 items-center justify-center rounded-2xl px-3 py-2 text-sm font-semibold text-white shadow-sm\",\n                              bulkCanSubmit ? \"bg-gradient-to-r from-emerald-600 via-sky-600 to-amber-600 hover:brightness-[1.05]\" : \"bg-slate-300 dark:bg-slate-700\"\n                            )}\n                            onClick={createBulk}\n                            disabled={!bulkCanSubmit}\n                          >\n                            {bulkCreating ? (\n                              <span className=\"inline-flex items-center gap-2\">\n                                <Spinner className=\"text-white\" />\n                                Creating…\n                              </span>\n                            ) : (\n                              \"Create Bulk Job\"\n                            )}\n                          </button>\n                        </div>\n                        <div className=\"mt-2 text-[11px] text-slate-500 dark:text-slate-400\">\n                          Shortcut: <span className=\"font-mono\">Shift + Enter</span> to create job.\n                        </div>\n\n                        <div className=\"mt-3 flex flex-wrap items-center gap-2 text-xs\">\n                          <span className=\"rounded-full border border-slate-200 bg-white/60 px-2 py-1 text-slate-700 dark:border-slate-800 dark:bg-slate-950/30 dark:text-slate-200\">\n                            Total: <span className=\"font-semibold\">{bulkStats.total}</span>\n                          </span>\n                          <span className=\"rounded-full border border-slate-200 bg-white/60 px-2 py-1 text-slate-700 dark:border-slate-800 dark:bg-slate-950/30 dark:text-slate-200\">\n                            Kept: <span className=\"font-semibold\">{bulkStats.kept}</span>\n                          </span>\n                          <span className=\"rounded-full border border-slate-200 bg-white/60 px-2 py-1 text-slate-700 dark:border-slate-800 dark:bg-slate-950/30 dark:text-slate-200\">\n                            Deduped: <span className=\"font-semibold\">{bulkStats.deduped}</span>\n                          </span>\n                        </div>\n\n                        {bulkError ? (\n                          <div className=\"mt-3 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-900\">\n                            {bulkError}\n                          </div>\n                        ) : null}\n\n                        {bulkJobId ? (\n                          <div className=\"mt-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-700 dark:border-slate-800 dark:bg-slate-950/30 dark:text-slate-200\">\n                            Bulk job created:{\" \"}\n                            <a className=\"font-mono underline\" href={`/dashboard/bulk?bulkJobId=${encodeURIComponent(bulkJobId)}`}>\n                              {bulkJobId}\n                            </a>\n                          </div>\n                        ) : null}\n                      </div>\n                    </div>\n\n                    {bulkDecoratedPreview.length > 0 ? (\n                      <div className=\"lg:col-span-12\">\n                        <div className=\"mt-1 overflow-hidden rounded-2xl border border-slate-200 bg-white/80 shadow-sm dark:border-slate-800 dark:bg-slate-950/25\">\n                          <div className=\"flex items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3 text-xs text-slate-600 dark:border-slate-800 dark:bg-slate-900/40 dark:text-slate-300\">\n                            <div className=\"font-medium\">Preview</div>\n                            <div className=\"text-slate-500 dark:text-slate-400\">Showing first 50 rows (duplicates flagged)</div>\n                          </div>\n\n                          <div className=\"max-h-[260px] overflow-auto\">\n                            <table className=\"w-full text-sm\">\n                              <thead className=\"sticky top-0 bg-white text-xs text-slate-600 dark:bg-slate-950 dark:text-slate-300\">\n                                <tr>\n                                  <th className=\"px-3 py-2 text-left\">#</th>\n                                  <th className=\"px-3 py-2 text-left\">URL</th>\n                                  <th className=\"px-3 py-2 text-left\">Price</th>\n                                  <th className=\"px-3 py-2 text-left\">Dedup</th>\n                                </tr>\n                              </thead>\n                              <tbody>\n                                {bulkDecoratedPreview.slice(0, 50).map((it: any) => (\n                                  <tr key={`${it._key}-${it._idx}`} className=\"border-t border-slate-200 dark:border-slate-800\">\n                                    <td className=\"px-3 py-2 text-xs text-slate-500\">{it._idx + 1}</td>\n                                    <td className=\"px-3 py-2 break-words\">{it.input_url}</td>\n                                    <td className=\"px-3 py-2\">{it.metadata?.price ?? \"—\"}</td>\n                                    <td className=\"px-3 py-2\">\n                                      {it._dup ? (\n                                        <span className=\"inline-flex items-center rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-xs text-amber-900\">\n                                          duplicate\n                                        </span>\n                                      ) : (\n                                        <span className=\"text-xs text-slate-400\">—</span>\n                                      )}\n                                    </td>\n                                  </tr>\n                                ))}\n                              </tbody>\n                            </table>\n                          </div>\n                        </div>\n                      </div>\n                    ) : null}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </section>\n\n        {/* Body */}\n        <div className=\"mt-6 grid grid-cols-1 gap-4 lg:grid-cols-12\">\n          {/* Left: human canvas */}\n          <div className=\"space-y-4 lg:col-span-8\">\n            <section className=\"rounded-2xl border border-slate-200 bg-white/80 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/25\">\n              <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n                <div>\n                  <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Description HTML</h2>\n                  <p className=\"mt-0.5 text-xs text-slate-500 dark:text-slate-400\">\n                    Live preview (search + copy). Uses canonical field: <span className=\"font-mono\">descriptionHtml</span>\n                  </p>\n                </div>\n\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <input\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"h-9 w-[220px] rounded-2xl border border-slate-200 bg-white px-3 text-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                    placeholder=\"Search in HTML…\"\n                  />\n                  <button\n                    className=\"h-9 rounded-2xl border border-slate-200 bg-white px-3 text-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-200\"\n                    onClick={handleCopyDescription}\n                    disabled={!descriptionHtml}\n                  >\n                    {copyState === \"copied\" ? \"Copied\" : \"Copy HTML\"}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"mt-3 rounded-2xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-950/40\">\n                <div className=\"prose max-w-none dark:prose-invert\" dangerouslySetInnerHTML={{ __html: highlightedDescription }} />\n              </div>\n            </section>\n\n            <section className=\"rounded-2xl border border-slate-200 bg-white/80 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/25\">\n              <div className=\"flex items-start justify-between gap-3\">\n                <div>\n                  <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Pipeline telemetry</h2>\n                  <p className=\"mt-0.5 text-xs text-slate-500 dark:text-slate-400\">\n                    Module statuses, durations, and direct module output links (even on failure).\n                  </p>\n                </div>\n\n                {pipelineSnapshot?.run?.id || pipelineRunId ? (\n                  <div className=\"text-right text-xs text-slate-600 dark:text-slate-300\">\n                    <div>\n                      Run: <span className=\"font-mono\">{shortId(pipelineSnapshot?.run?.id || pipelineRunId)}</span>\n                    </div>\n                    <div>\n                      Status: <span className=\"font-semibold\">{pipelineSnapshot?.run?.status || \"—\"}</span>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-xs text-slate-500 dark:text-slate-400\">No run yet.</div>\n                )}\n              </div>\n\n              <div className=\"mt-3 overflow-auto rounded-2xl border border-slate-200 bg-white dark:border-slate-800 dark:bg-slate-950/40\">\n                <table className=\"w-full min-w-[760px] text-sm\">\n                  <thead className=\"bg-slate-50 text-xs text-slate-600 dark:bg-slate-900/40 dark:text-slate-300\">\n                    <tr>\n                      <th className=\"px-3 py-2 text-left\">Module</th>\n                      <th className=\"px-3 py-2 text-left\">Status</th>\n                      <th className=\"px-3 py-2 text-left\">Duration</th>\n                      <th className=\"px-3 py-2 text-left\">Output</th>\n                      <th className=\"px-3 py-2 text-left\">Error</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {moduleDurations.map((m: any) => (\n                      <tr key={`${m.module_name}-${m.module_index}`} className=\"border-t border-slate-200 dark:border-slate-800\">\n                        <td className=\"px-3 py-2\">\n                          <span className=\"font-medium\">{m.module_name}</span>{\" \"}\n                          <span className=\"text-xs text-slate-400\">#{m.module_index}</span>\n                        </td>\n                        <td className=\"px-3 py-2\">\n                          <span className={cx(\"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\", statusPillTone(m.status))}>\n                            {m.status}\n                          </span>\n                        </td>\n                        <td className=\"px-3 py-2\">{m.duration_ms != null ? formatDuration(m.duration_ms) : \"—\"}</td>\n                        <td className=\"px-3 py-2\">\n                          {pipelineRunId ? (\n                            <a\n                              className=\"text-sm text-slate-700 underline dark:text-slate-200\"\n                              href={`/api/v1/pipeline/run/${encodeURIComponent(pipelineRunId)}/output/${encodeURIComponent(String(m.module_index))}`}\n                              target=\"_blank\"\n                              rel=\"noreferrer\"\n                            >\n                              View output\n                            </a>\n                          ) : (\n                            <span className=\"text-slate-400\">—</span>\n                          )}\n                        </td>\n                        <td className=\"px-3 py-2 text-xs\">\n                          {m.status === \"failed\" ? (\n                            <span className=\"line-clamp-2\">{typeof m.error === \"string\" ? m.error : JSON.stringify(m.error || \"\")}</span>\n                          ) : (\n                            <span className=\"text-slate-400\">—</span>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n\n                    {!moduleDurations.length ? (\n                      <tr>\n                        <td className=\"px-3 py-3 text-sm text-slate-500 dark:text-slate-400\" colSpan={5}>\n                          No module telemetry available yet.\n                        </td>\n                      </tr>\n                    ) : null}\n                  </tbody>\n                </table>\n              </div>\n            </section>\n\n            {loading ? <div className=\"text-sm text-slate-600 dark:text-slate-300\">Loading ingestion…</div> : null}\n          </div>\n\n          {/* Right rail */}\n          <aside className=\"space-y-4 lg:col-span-4\">\n            {/* SEO card */}\n            <section className=\"rounded-2xl border border-slate-200 bg-white/80 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/25\">\n              <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">SEO</h2>\n              <div className=\"mt-3 space-y-2 text-sm text-slate-800 dark:text-slate-200\">\n                <div>\n                  <div className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">H1</div>\n                  <div className=\"mt-0.5 break-words\">{seo?.h1 ?? \"—\"}</div>\n                </div>\n                <div>\n                  <div className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">Title</div>\n                  <div className=\"mt-0.5 break-words\">{seo?.pageTitle ?? seo?.title ?? \"—\"}</div>\n                </div>\n                <div>\n                  <div className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">Meta description</div>\n                  <div className=\"mt-0.5 break-words\">{seo?.metaDescription ?? seo?.meta_description ?? \"—\"}</div>\n                </div>\n                <div>\n                  <div className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">Short description</div>\n                  <div className=\"mt-0.5 break-words\">\n                    {seo?.shortDescription ?? seo?.seoShortDescription ?? seo?.seo_short_description ?? \"—\"}\n                  </div>\n                </div>\n              </div>\n\n              {Array.isArray(features) && features.length > 0 ? (\n                <>\n                  <h3 className=\"mt-4 text-sm font-semibold text-slate-900 dark:text-slate-100\">Features</h3>\n                  <ul className=\"mt-2 list-disc space-y-1 pl-5 text-sm text-slate-800 dark:text-slate-200\">\n                    {features.map((f: any, i: number) => (\n                      <li key={i} className=\"break-words\">\n                        {String(f)}\n                      </li>\n                    ))}\n                  </ul>\n                </>\n              ) : (\n                <div className=\"mt-4 text-xs text-slate-500 dark:text-slate-400\">No features found.</div>\n              )}\n\n              {parkedExtras.length > 0 ? (\n                <details className=\"mt-4\">\n                  <summary className=\"cursor-pointer text-sm text-slate-600 dark:text-slate-300\">Extra SEO keys</summary>\n                  <pre className=\"mt-2 max-h-[260px] overflow-auto rounded-2xl border border-slate-800 bg-black p-3 text-[11px] text-white\">\n                    {JSON.stringify(Object.fromEntries(parkedExtras), null, 2)}\n                  </pre>\n                </details>\n              ) : (\n                <div className=\"mt-3 text-xs text-slate-500 dark:text-slate-400\">No extra SEO keys.</div>\n              )}\n            </section>\n\n            {/* Raw ingestion JSON */}\n            <section className=\"rounded-2xl border border-slate-200 bg-white/80 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/25\">\n              <details>\n                <summary className=\"cursor-pointer text-sm font-semibold text-slate-900 dark:text-slate-100\">Raw ingestion JSON</summary>\n                <div className=\"mt-2 text-xs text-slate-500 dark:text-slate-400\">The full persisted ingestion row used by downstream modules.</div>\n                <pre className=\"mt-3 max-h-[420px] overflow-auto rounded-2xl border border-slate-800 bg-black p-3 text-[11px] text-white\">\n                  {JSON.stringify(jobData ?? null, null, 2)}\n                </pre>\n              </details>\n            </section>\n          </aside>\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}