module.exports=[13185,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(...a){return a.filter(Boolean).join(" ")}function e(a){return Math.max(1,Math.round(24*a*3600))}function f({days:a,onChange:e,ariaLabel:f,className:g}){let h=[1,7,14,30],i=Math.max(1,Math.round(a||14)),[j,k]=(0,c.useState)(h.includes(i)?String(i):"custom"),[l,m]=(0,c.useState)(i);return(0,c.useEffect)(()=>{let b=Math.max(1,Math.round(a||14));k(h.includes(b)?String(b):"custom"),m(b)},[a]),(0,b.jsxs)("div",{className:d("relative inline-flex items-center gap-2",g),children:[(0,b.jsxs)("select",{"aria-label":f??"frequency-presets",value:j,onChange:a=>{let b=a.target.value;if(k(b),"custom"===b)return;let c=Number(b);m(c),e(c)},className:"h-8 rounded-md border border-slate-200 bg-white px-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-200",children:[h.map(a=>(0,b.jsx)("option",{value:String(a),children:String(a)},a)),(0,b.jsx)("option",{value:"custom",children:"Custom…"})]}),(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"days"}),"custom"===j?(0,b.jsxs)("div",{className:"absolute left-0 top-full z-20 mt-2 w-[260px] rounded-xl border border-slate-200 bg-white p-3 shadow-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"number",min:1,step:1,value:l,onChange:a=>m(Number(a.target.value)),className:"h-8 w-24 rounded-md border border-slate-200 bg-white px-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-200",title:"Custom days between checks"}),(0,b.jsx)("button",{onClick:()=>e(Math.max(1,Math.round(l))),className:"h-8 rounded-md bg-indigo-600 px-3 text-xs font-semibold text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200",title:"Apply custom frequency (days)",children:"Apply"}),(0,b.jsx)("button",{onClick:()=>k(String(14)),className:"h-8 rounded-md border border-slate-200 bg-white px-3 text-xs font-semibold text-slate-700 shadow-sm hover:bg-slate-50",title:"Close",children:"Close"})]}),(0,b.jsx)("div",{className:"mt-2 text-[11px] text-slate-500",children:"Enter a number of days, then Apply."})]}):null]})}function g({status:a}){let c=(a??"unknown").toLowerCase(),e={ok:"border-emerald-200 bg-emerald-50 text-emerald-700",changed:"border-amber-200 bg-amber-50 text-amber-700",scrape_failed:"border-red-200 bg-red-50 text-red-700",error:"border-red-200 bg-red-50 text-red-700",unknown:"border-slate-200 bg-slate-50 text-slate-700"},f=e[c]??e.unknown;return(0,b.jsx)("span",{className:d("inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-semibold capitalize",f),children:c.replace("_"," ")})}function h({tone:a}){return(0,b.jsx)("span",{className:d("inline-block h-2 w-2 rounded-full","ok"===a?"bg-emerald-500":"warn"===a?"bg-amber-500":"bad"===a?"bg-red-500":"bg-slate-400")})}let i="h-8 rounded-md px-3 text-xs font-semibold shadow-sm transition focus:outline-none focus:ring-2";d(i,"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 focus:ring-slate-200");let j=d(i,"bg-sky-600 text-white hover:bg-sky-500 focus:ring-sky-200"),k=d(i,"bg-indigo-600 text-white hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed focus:ring-indigo-200"),l=d(i,"bg-slate-900 text-white hover:bg-slate-800 focus:ring-slate-300");function m({watch:a,onSaveFreq:d,onTriggerCheck:e,onUpdate:i}){var m;let n=((m=a?.frequency_seconds)&&"number"==typeof m?Math.max(1,Math.round(m/86400)):null)??14,[o,p]=(0,c.useState)(n),[q,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{p(n)},[n]);let s=String(a?.last_status??"unknown").toLowerCase(),t="ok"===s?"ok":"changed"===s?"warn":s.includes("error")||s.includes("fail")?"bad":"neutral";return(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row lg:items-start lg:justify-between",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h,{tone:t}),(0,b.jsx)("div",{className:"truncate text-sm font-semibold text-slate-900",children:a.source_url})]}),(0,b.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[(0,b.jsx)(g,{status:a.last_status}),(0,b.jsx)("span",{className:"text-slate-300",children:"·"}),(0,b.jsx)("span",{className:"whitespace-nowrap",children:a.last_check_at?new Date(a.last_check_at).toLocaleString():"never"}),a.muted_until?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-slate-300",children:"·"}),(0,b.jsx)("span",{className:"whitespace-nowrap text-slate-400",children:"muted"})]}):null]})]}),(0,b.jsxs)("div",{className:"flex shrink-0 flex-wrap items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>e(a.id),className:j,title:"Run a check now",children:"Check"}),(0,b.jsx)("button",{onClick:async()=>{r(!0);try{await d(a.id,o)}finally{r(!1)}},disabled:q,className:k,title:"Save frequency",children:q?"Saving…":"Save"}),(0,b.jsx)("button",{onClick:()=>i(a.id,{muted_until:a.muted_until?null:new Date(Date.now()+864e5).toISOString()}),className:l,title:a.muted_until?"Unmute":"Mute 24h",children:a.muted_until?"Unmute":"Mute"})]})]}),(0,b.jsxs)("div",{className:"mt-3 flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-slate-600",children:"Frequency"}),(0,b.jsx)(f,{days:o,onChange:a=>p(a),ariaLabel:`Frequency for ${a.source_url}`})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 lg:justify-end",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-slate-600",children:"Price Δ %"}),(0,b.jsx)("input",{type:"number",defaultValue:a.price_threshold_percent??"",onBlur:b=>i(a.id,{price_threshold_percent:b.currentTarget.value?Number(b.currentTarget.value):null}),className:"h-8 w-24 rounded-md border border-slate-200 bg-white px-2 text-xs shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-200"})]})]})]})}function n(){let[a,d]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[n,o]=(0,c.useState)(14);async function p(){j(!0);try{let a=await fetch("/api/monitor/watches"),b=await a.json().catch(()=>null);a.ok&&b?.ok?d(b.watches??[]):d([])}finally{j(!1)}}async function q(a){j(!0);try{let b=a?`/api/monitor/events?watchId=${encodeURIComponent(a)}`:"/api/monitor/events",c=await fetch(b),d=await c.json().catch(()=>null);c.ok&&d?.ok?h(d.events??[]):h([])}finally{j(!1)}}async function r(){if(!k)return void alert("Enter a URL to watch");j(!0);try{let a={source_url:k,frequency_seconds:e(n)},b=await fetch("/api/monitor/watches",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(a)}),c=await b.json().catch(()=>null);b.ok&&c?.ok?(l(""),await p()):alert("Failed to create watch: "+(c?.error??b.statusText))}finally{j(!1)}}async function s(a,b){let c={frequency_seconds:e(b)},d=await fetch(`/api/monitor/watches/${encodeURIComponent(a)}`,{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(c)}),f=await d.json().catch(()=>null);d.ok&&f?.ok?await p():alert("Save frequency failed: "+(f?.error??d.statusText))}async function t(a,b){try{let c=await fetch(`/api/monitor/watches/${encodeURIComponent(a)}`,{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(b)}),d=await c.json().catch(()=>null);c.ok&&d?.ok?await p():alert("Update failed: "+(d?.error??c.statusText))}catch(a){alert(String(a?.message??a))}}async function u(a){j(!0);try{let b=await fetch("/api/monitor/check",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({watchId:a})}),c=await b.json().catch(()=>null);b.ok&&c?.ok?(alert("Check result: "+(c?.result?.changed?"changed":"no_change")),await p(),await q(a)):alert("Check failed: "+(c?.error??b.statusText))}finally{j(!1)}}return(0,c.useEffect)(()=>{p(),q();let a=setInterval(()=>{p(),q()},3e4);return()=>clearInterval(a)},[]),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row lg:items-center",children:[(0,b.jsx)("input",{value:k,onChange:a=>l(a.target.value),className:"border rounded px-3 py-2 flex-1",placeholder:"https://example.com/product/...","aria-label":"New watch URL"}),(0,b.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:(0,b.jsx)(f,{days:n,onChange:a=>o(a),ariaLabel:"New watch frequency (days)"})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:r,className:"px-3 py-2 rounded bg-indigo-600 text-white shadow hover:bg-indigo-500",children:"Add Watch"}),(0,b.jsx)("button",{onClick:()=>{p(),q()},className:"px-3 py-2 rounded border border-slate-200 bg-white hover:bg-slate-50",children:"Refresh"})]})]}),(0,b.jsxs)("div",{style:{maxHeight:"64vh",overflowY:"auto"},className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold",children:"Watches"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.length?`${a.length} total`:""})]}),(0,b.jsx)("div",{className:"mt-2 space-y-3",children:i&&!a.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"Loading…"}):0===a.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"No watches configured yet"}):a.slice(0,10).map(a=>(0,b.jsx)(m,{watch:a,onSaveFreq:s,onTriggerCheck:u,onUpdate:t},a.id))}),a.length>10?(0,b.jsxs)("div",{className:"mt-3 text-xs text-slate-500",children:["Showing ",10," of ",a.length," watches. ",(0,b.jsx)("a",{className:"underline",href:"/dashboard/monitor/all",children:"View all"})]}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold",children:"Recent events"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:g.length?`${g.length} total`:""})]}),(0,b.jsx)("div",{className:"mt-2 space-y-2",children:i&&!g.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"Loading…"}):0===g.length?(0,b.jsx)("div",{className:"text-sm text-slate-500",children:"No events"}):g.slice(0,10).map(a=>(0,b.jsxs)("div",{className:"p-2 border rounded bg-slate-50",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.event_type}),(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900 break-words",children:a.payload?.snapshot?.title??a.payload?.snapshot?.url}),(0,b.jsx)("div",{className:"text-xs text-slate-400",children:new Date(a.created_at).toLocaleString()})]},a.id))}),g.length>10?(0,b.jsxs)("div",{className:"mt-3 text-xs text-slate-500",children:["Showing ",10," of ",g.length," events. ",(0,b.jsx)("a",{className:"underline",href:"/dashboard/monitor/events",children:"View all"})]}):null]})]})]})}function o(...a){return a.filter(Boolean).join(" ")}function p({title:a,value:c,caption:d,tone:e="blue"}){let f={blue:{border:"border-sky-200/70 dark:border-sky-500/20",wash:"from-sky-500/10 via-sky-500/0 to-transparent dark:from-sky-400/10 dark:via-sky-400/0",glowA:"bg-sky-400/16 dark:bg-sky-500/12",glowB:"bg-indigo-400/10 dark:bg-indigo-500/10",top:"from-sky-400/55 via-sky-300/20 to-transparent dark:from-sky-300/35 dark:via-sky-300/15"},purple:{border:"border-violet-200/70 dark:border-violet-500/20",wash:"from-violet-500/10 via-violet-500/0 to-transparent dark:from-violet-400/10 dark:via-violet-400/0",glowA:"bg-violet-400/16 dark:bg-violet-500/12",glowB:"bg-fuchsia-400/10 dark:bg-fuchsia-500/10",top:"from-violet-400/55 via-violet-300/20 to-transparent dark:from-violet-300/35 dark:via-violet-300/15"},teal:{border:"border-emerald-200/70 dark:border-emerald-500/20",wash:"from-emerald-500/10 via-emerald-500/0 to-transparent dark:from-emerald-400/10 dark:via-emerald-400/0",glowA:"bg-emerald-400/14 dark:bg-emerald-500/12",glowB:"bg-cyan-400/10 dark:bg-cyan-500/10",top:"from-emerald-400/55 via-emerald-300/20 to-transparent dark:from-emerald-300/35 dark:via-emerald-300/15"},amber:{border:"border-amber-200/70 dark:border-amber-500/20",wash:"from-amber-500/12 via-amber-500/0 to-transparent dark:from-amber-400/10 dark:via-amber-400/0",glowA:"bg-amber-400/16 dark:bg-amber-500/12",glowB:"bg-orange-400/10 dark:bg-orange-500/10",top:"from-amber-400/60 via-amber-300/20 to-transparent dark:from-amber-300/35 dark:via-amber-300/15"}}[e];return(0,b.jsxs)("div",{className:o("group relative overflow-hidden rounded-2xl border bg-white/88 p-4","shadow-[0_10px_30px_-20px_rgba(2,6,23,0.35)] backdrop-blur-xl","dark:bg-slate-950/45",f.border),children:[(0,b.jsx)("div",{className:o("pointer-events-none absolute inset-x-0 top-0 h-px bg-gradient-to-r",f.top)}),(0,b.jsx)("div",{className:o("pointer-events-none absolute inset-0 bg-gradient-to-br",f.wash)}),(0,b.jsx)("div",{className:o("pointer-events-none absolute -right-10 -top-12 h-28 w-28 rounded-full blur-2xl",f.glowA)}),(0,b.jsx)("div",{className:o("pointer-events-none absolute -left-10 -bottom-12 h-28 w-28 rounded-full blur-2xl",f.glowB)}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"text-[13px] font-semibold leading-none text-slate-900 dark:text-slate-50",children:(0,b.jsx)("span",{className:"block truncate whitespace-nowrap",children:a})}),(0,b.jsx)("div",{className:"mt-3 flex items-end justify-between gap-3",children:(0,b.jsx)("div",{className:"text-[28px] font-semibold leading-none tracking-tight text-slate-900 dark:text-slate-50",children:c})}),d?(0,b.jsx)("div",{className:"mt-2 text-[11px] leading-none text-slate-500 dark:text-slate-400",children:(0,b.jsx)("span",{className:"block truncate whitespace-nowrap",children:d})}):null]})]})}function q({href:a,children:c,variant:d="secondary",className:e}){let f="inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold transition active:translate-y-[0.5px] focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-50 dark:focus-visible:ring-offset-slate-950";return"primary"===d?(0,b.jsx)("a",{href:a,className:o(f,"text-slate-950 shadow-[0_16px_34px_-22px_rgba(2,6,23,0.55)]","bg-gradient-to-r from-amber-400 via-amber-500 to-orange-500","hover:from-amber-300 hover:via-amber-500 hover:to-orange-400","focus-visible:ring-amber-400/70",e),children:c}):(0,b.jsx)("a",{href:a,className:o(f,"border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50","focus-visible:ring-slate-300/70 dark:focus-visible:ring-slate-700/70",e),children:c})}function r({children:a,tone:c="neutral"}){return(0,b.jsx)("span",{className:o("inline-flex items-center gap-2 rounded-full border px-2.5 py-1 text-[11px] shadow-sm backdrop-blur","signal"===c?"border-amber-200/60 bg-amber-50 text-amber-700 dark:border-amber-400/30 dark:bg-amber-500/10 dark:text-amber-100":"success"===c?"border-emerald-200/60 bg-emerald-50 text-emerald-700 dark:border-emerald-400/30 dark:bg-emerald-500/10 dark:text-emerald-100":"border-slate-200/70 bg-white/75 text-slate-600 dark:border-slate-700/70 dark:bg-slate-950/45 dark:text-slate-300"),children:a})}function s(){let[a,d]=(0,c.useState)(null),[e,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!1),[m,s]=(0,c.useState)(null);async function t(){l(!0);try{let[a,b,c,e]=await Promise.all([fetch("/api/monitor/watches"),fetch("/api/monitor/events"),fetch("/api/monitor/rules"),fetch("/api/monitor/notifications")]),g=await a.json().catch(()=>null),i=await b.json().catch(()=>null),k=await c.json().catch(()=>null),l=await e.json().catch(()=>null),m=a.ok&&g?.ok?g.watches??[]:[],n=b.ok&&i?.ok?i.events??[]:[],o=c.ok&&k?.ok?k.rules??[]:[],p=e.ok&&l?.ok?l.notifications??[]:[];d(m),f(n),h(o),j(p),s(n?.[0]??null)}catch(a){d([]),f([]),h([]),j([]),s(null)}finally{l(!1)}}(0,c.useEffect)(()=>{t();let a=setInterval(()=>t(),3e4);return()=>clearInterval(a)},[]);let u=a?.length??"—",v=e?e.filter(a=>{let b=new Date(a.created_at).getTime();return Date.now()-b<864e5}).length:"—",w=(0,c.useMemo)(()=>a&&0!==a.length?Math.round(a.reduce((a,b)=>a+Number(b.frequency_seconds??86400)/86400,0)/a.length*10)/10:"—",[a]),x=(0,c.useMemo)(()=>a?a.filter(a=>a.last_status&&"ok"!==String(a.last_status)||Number(a.retry_count??0)>0).length:"—",[a]),y=(0,c.useMemo)(()=>e?Math.round(e.filter(a=>{let b=new Date(a.created_at).getTime();return Date.now()-b<6048e5}).length/7*10)/10:"—",[e]),z=(0,c.useMemo)(()=>i?i.filter(a=>{let b=new Date(a.created_at).getTime();return Date.now()-b<6048e5}).length:"—",[i]),A=(0,c.useMemo)(()=>e&&0!==e.length?Math.round(e.filter(a=>!0===a.processed).length/e.length*100):"—",[e]),B=(0,c.useMemo)(()=>a&&0!==a.length?Math.round(a.filter(a=>!!a.auto_watch).length/a.length*100):"—",[a]),C=(0,c.useMemo)(()=>a&&0!==a.length?Math.round(a.filter(a=>!!a.product_id).length/a.length*100):"—",[a]),D=(0,c.useMemo)(()=>a&&0!==a.length?Math.round(a.reduce((a,b)=>a+Number(b.retry_count??0),0)/a.length*10)/10:"—",[a]),E=i?i.filter(a=>!a.read).length:"—",F=g?.length??"—";return(0,b.jsxs)("main",{className:"relative min-h-screen overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50",children:[(0,b.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,b.jsx)("div",{className:"absolute -top-44 -left-36 h-96 w-96 rounded-full bg-sky-300/20 blur-3xl dark:bg-sky-500/15"}),(0,b.jsx)("div",{className:"absolute -bottom-44 right-[-12rem] h-[28rem] w-[28rem] rounded-full bg-amber-300/20 blur-3xl dark:bg-amber-500/14"}),(0,b.jsx)("div",{className:"absolute top-24 right-12 h-56 w-56 rounded-full bg-emerald-300/12 blur-3xl dark:bg-emerald-500/10"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.92)_58%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.92)_58%,_rgba(15,23,42,1)_100%)]"}),(0,b.jsx)("div",{className:"absolute inset-0 opacity-[0.045] dark:opacity-[0.065]",children:(0,b.jsx)("div",{className:"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:46px_46px] dark:bg-[linear-gradient(to_right,#1e293b_1px,transparent_1px),linear-gradient(to_bottom,#1e293b_1px,transparent_1px)]"})})]}),(0,b.jsxs)("div",{className:"relative mx-auto max-w-7xl space-y-6 px-4 pt-4 pb-8 sm:px-6 lg:px-8 lg:pt-6 lg:pb-10",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-5 lg:flex-row lg:items-start lg:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full border border-amber-300/60 bg-white/80 px-3 py-1.5 text-[11px] font-medium uppercase tracking-[0.18em] text-amber-700 shadow-sm backdrop-blur dark:border-amber-400/35 dark:bg-slate-950/55 dark:text-amber-100",children:[(0,b.jsx)("span",{className:"inline-flex h-4 w-4 items-center justify-center rounded-full border border-amber-400/60 bg-slate-100 dark:border-amber-400/35 dark:bg-slate-900",children:(0,b.jsx)("span",{className:"h-2 w-2 animate-pulse rounded-full bg-amber-500 dark:bg-amber-300"})}),"Commerce • AvidiaMonitor"]}),(0,b.jsxs)(r,{tone:"success",children:[(0,b.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"Workers • Rules • Notifier"]}),(0,b.jsx)(r,{tone:"signal",children:"✨ Change detection → alerts → automation"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h1",{className:"text-2xl font-semibold leading-tight text-slate-900 lg:text-3xl dark:text-slate-50",children:["Monitor"," ",(0,b.jsx)("span",{className:"bg-gradient-to-r from-amber-500 via-orange-500 to-sky-500 bg-clip-text text-transparent dark:from-amber-300 dark:via-orange-300 dark:to-sky-300",children:"changes, notifications & automation"})]}),(0,b.jsx)("p",{className:"max-w-2xl text-sm text-slate-600 dark:text-slate-300",children:"Watch product sources, detect deltas, and trigger pipelines or alerts. Manage watches, rules, and notifications here."})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 lg:justify-end",children:[(0,b.jsx)(q,{href:"#add-watch",variant:"primary",children:"Add watch"}),(0,b.jsxs)(q,{href:"/dashboard/monitor/rules",variant:"secondary",children:["Rules (",F,")"]}),(0,b.jsxs)(q,{href:"/dashboard/monitor/notifications",variant:"secondary",children:["Notifications (",E,")"]})]})]}),(0,b.jsxs)("section",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12 lg:gap-8",children:[(0,b.jsxs)("div",{className:"space-y-4 lg:col-span-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsx)(p,{title:"Watches",tone:"blue",value:k?"…":u,caption:"Configured watches"}),(0,b.jsx)(p,{title:"Events (24h)",tone:"purple",value:k?"…":v,caption:"Events in last 24 hours"}),(0,b.jsx)(p,{title:"Avg frequency (days)",tone:"teal",value:k?"…":w,caption:"Average check frequency"}),(0,b.jsx)(p,{title:"Failing watches",tone:"amber",value:k?"…":x,caption:"Watches with errors/retries"})]}),(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200/70 bg-white/80 p-4 shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/45",children:(0,b.jsx)(n,{})}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200/70 bg-white/80 p-4 shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/45",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 dark:text-slate-50",children:"Recent monitor events"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Quick view of recent events. Use Rules to automate alerts and Notifier to deliver webhooks / emails."})]}),(0,b.jsx)("div",{className:"shrink-0 text-xs text-slate-500 dark:text-slate-400",children:"Most recent"})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("div",{className:"space-y-2 pr-2",style:{maxHeight:"36vh",overflowY:"auto"},children:null===e?(0,b.jsx)("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Loading…"}):0===e.length?(0,b.jsx)("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No events yet — add a watch or upload/import a product to get started."}):e.slice(0,50).map(a=>(0,b.jsxs)("div",{className:o("rounded-xl border border-slate-200/70 bg-slate-50/70 p-3","shadow-sm","flex items-start justify-between gap-3","dark:border-slate-800/60 dark:bg-slate-900/30"),children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[a.event_type," · ",a.severity]}),(0,b.jsx)("div",{className:"mt-0.5 truncate font-medium text-slate-900 dark:text-slate-50",children:a.payload?.snapshot?.title??a.payload?.snapshot?.url??"Event"}),(0,b.jsx)("div",{className:"mt-1 truncate text-xs text-slate-400 dark:text-slate-500",children:a.payload?.snapshot?.url})]}),(0,b.jsxs)("div",{className:"shrink-0 text-right",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:new Date(a.created_at).toLocaleString()}),(0,b.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(a.payload??a,null,2)),alert("Event payload copied")},className:o("rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Copy"}),(0,b.jsx)("a",{href:"/dashboard/monitor/notifications",className:o("rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Notifications"})]})]})]},a.id))}),e&&e.length>50?(0,b.jsxs)("div",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400",children:["Showing latest 50 events."," ",(0,b.jsx)("a",{className:"underline underline-offset-2",href:"/dashboard/monitor/events",children:"View all events"})]}):null]})]})]}),(0,b.jsxs)("aside",{className:"space-y-4 lg:col-span-4",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200/70 bg-white/80 p-4 shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/45",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 dark:text-slate-50",children:"Quick actions"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Admin utilities for Monitor"})]}),(0,b.jsxs)(r,{children:[(0,b.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-sky-400"}),"Ops"]})]}),(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 dark:border-slate-800/60 dark:bg-slate-900/30",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Run all due checks"}),(0,b.jsx)("div",{className:"truncate text-sm font-medium text-slate-900 dark:text-slate-50",children:"Worker (manual)"})]}),(0,b.jsx)("button",{onClick:()=>{t(),alert("Summary refreshed. To run checks start the worker process.")},className:o("shrink-0 rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Refresh"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 dark:border-slate-800/60 dark:bg-slate-900/30",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Notifier worker"}),(0,b.jsx)("div",{className:"truncate text-sm font-medium text-slate-900 dark:text-slate-50",children:"Deliver webhooks & emails"})]}),(0,b.jsx)("button",{onClick:()=>alert("Dev command:\n\nNODE_ENV=production node -r dotenv/config ./dist/lib/monitor/notifierWorker.js"),className:o("shrink-0 rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Show command"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 dark:border-slate-800/60 dark:bg-slate-900/30",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Manage rules"}),(0,b.jsx)("div",{className:"truncate text-sm font-medium text-slate-900 dark:text-slate-50",children:"Create automation for events"})]}),(0,b.jsx)("a",{href:"/dashboard/monitor/rules",className:o("shrink-0 rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Open"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 dark:border-slate-800/60 dark:bg-slate-900/30",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"View notifications"}),(0,b.jsx)("div",{className:"truncate text-sm font-medium text-slate-900 dark:text-slate-50",children:"App notifications & history"})]}),(0,b.jsx)("a",{href:"/dashboard/monitor/notifications",className:o("shrink-0 rounded-full px-3 py-1 text-xs font-medium","border border-slate-200/80 bg-white/70 text-slate-700 shadow-sm","hover:bg-white hover:text-slate-900","dark:border-slate-800/70 dark:bg-slate-950/40 dark:text-slate-200 dark:hover:bg-slate-950/65 dark:hover:text-slate-50"),children:"Open"})]})]})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200/70 bg-white/70 p-4 text-xs shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/35",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900 dark:text-slate-50",children:"Monitor Metrics"}),(0,b.jsxs)(r,{children:[(0,b.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"Summary"]})]}),(0,b.jsx)("div",{className:"mt-2 text-xs text-slate-600 dark:text-slate-400",children:"Operational metrics and high-level signals — no repository paths or environment values are shown here."}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3 text-xs",children:[[{v:u,l:"Watches"},{v:w,l:"Avg frequency (days)"},{v:x,l:"Failing watches"},{v:y,l:"Events/day (est.)"},{v:z,l:"Notifications (7d)"},{v:"—"===A?"—":`${A}%`,l:"Processed rate"},{v:"—"===B?"—":`${B}%`,l:"Auto watches"},{v:"—"===C?"—":`${C}%`,l:"Linked to product"}].map(a=>(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200/70 bg-white/75 p-3 text-center shadow-sm dark:border-slate-800/60 dark:bg-slate-950/35",children:[(0,b.jsx)("div",{className:"text-2xl font-semibold text-slate-900 dark:text-slate-50",children:a.v}),(0,b.jsx)("div",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:a.l})]},a.l)),(0,b.jsxs)("div",{className:"col-span-2 rounded-xl border border-slate-200/70 bg-white/75 p-3 text-center shadow-sm dark:border-slate-800/60 dark:bg-slate-950/35",children:[(0,b.jsx)("div",{className:"text-2xl font-semibold text-slate-900 dark:text-slate-50",children:D}),(0,b.jsx)("div",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:"Avg retry count"})]})]})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200/70 bg-white/80 p-4 text-xs shadow-[0_14px_40px_-28px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/60 dark:bg-slate-950/45",children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900 dark:text-slate-50",children:"Operational tips"}),(0,b.jsxs)("ul",{className:"mt-3 space-y-2 text-slate-600 dark:text-slate-300",children:[(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"mt-[6px] h-1.5 w-1.5 shrink-0 rounded-full bg-amber-400"}),(0,b.jsx)("span",{children:"Start small: monitor a seed of important SKUs first."})]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"mt-[6px] h-1.5 w-1.5 shrink-0 rounded-full bg-sky-400"}),(0,b.jsx)("span",{children:"Set frequency per vendor to avoid rate-limits and CAPTCHAs."})]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"mt-[6px] h-1.5 w-1.5 shrink-0 rounded-full bg-emerald-400"}),(0,b.jsx)("span",{children:"Use rules to limit noise — e.g., alert only on price changes > X%."})]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"mt-[6px] h-1.5 w-1.5 shrink-0 rounded-full bg-violet-400"}),(0,b.jsx)("span",{children:"Use a headless-renderer fallback for JS-heavy pages (separate Playwright worker)."})]})]}),m?(0,b.jsxs)("div",{className:"mt-4 rounded-xl border border-slate-200/70 bg-slate-50/70 p-3 text-[11px] text-slate-600 dark:border-slate-800/60 dark:bg-slate-900/30 dark:text-slate-300",children:[(0,b.jsx)("div",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Latest signal (sample)"}),(0,b.jsx)("div",{className:"mt-1 truncate",children:m?.payload?.snapshot?.url??m?.payload?.snapshot?.title??"—"})]}):null]})]})]})]})]})}a.s(["default",()=>s],13185)}];

//# sourceMappingURL=src_app_dashboard_monitor_page_tsx_1e0ab964._.js.map