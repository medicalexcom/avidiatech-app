{"version":3,"sources":["../../../../src/app/dashboard/translate/%5BproductId%5D/page.tsx","../../../../src/lib/translate/languageMap.ts"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useState } from \"react\";\nimport { SUPPORTED_LANGUAGES } from \"@/lib/translate/languageMap\";\n\n/**\n * Translation workspace (client component).\n * - Loads product via client fetch to /api/translate/product?productId=...\n * - Allows selecting languages and fields, then calls POST /api/translate\n */\n\nexport default function TranslateWorkspace({ params }: { params: { productId: string } }) {\n  const productId = params.productId;\n  const [product, setProduct] = useState<any>(null);\n  const [selectedLangs, setSelectedLangs] = useState<string[]>([\"es\"]);\n  const [selectedFields, setSelectedFields] = useState<string[]>([\"name\", \"description_html\"]);\n  const [loading, setLoading] = useState(false);\n  const [translations, setTranslations] = useState<Record<string, any> | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    setError(null);\n    fetch(`/api/translate/product?productId=${productId}`)\n      .then((r) => r.json())\n      .then((d) => setProduct(d.product ?? null))\n      .catch(() => setError(\"Failed to load product\"));\n  }, [productId]);\n\n  async function runTranslate() {\n    setError(null);\n    setLoading(true);\n    setTranslations(null);\n    try {\n      const res = await fetch(\"/api/translate\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ productId, languages: selectedLangs, fields: selectedFields })\n      });\n      const json = await res.json();\n      if (!res.ok) {\n        setError(json.error || \"translation_failed\");\n      } else {\n        setTranslations(json.translations ?? null);\n      }\n    } catch (err: any) {\n      setError(err?.message || \"network_error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <main style={{ padding: 20 }}>\n      <h1>Translate Product</h1>\n      {!product && <p>Loading product...</p>}\n      {product && (\n        <>\n          <h2>Source</h2>\n          <div>\n            <strong>{product.name_raw || \"(no name)\"}</strong>\n            <div dangerouslySetInnerHTML={{ __html: product.description_html || product.description_raw || \"\" }} />\n          </div>\n\n          <div style={{ marginTop: 16 }}>\n            <label>Languages</label>\n            <div>\n              {SUPPORTED_LANGUAGES.map((l) => (\n                <label key={l.code} style={{ marginRight: 12 }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedLangs.includes(l.code)}\n                    onChange={(e) => {\n                      const next = e.target.checked ? [...selectedLangs, l.code] : selectedLangs.filter((x) => x !== l.code);\n                      setSelectedLangs(next);\n                    }}\n                  />{\" \"}\n                  {l.label}\n                </label>\n              ))}\n            </div>\n          </div>\n\n          <div style={{ marginTop: 12 }}>\n            <label>Fields</label>\n            <div>\n              {[\"name\", \"description_html\", \"features\", \"specs\"].map((f) => (\n                <label key={f} style={{ marginRight: 12 }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedFields.includes(f)}\n                    onChange={(e) => {\n                      const next = e.target.checked ? [...selectedFields, f] : selectedFields.filter((x) => x !== f);\n                      setSelectedFields(next);\n                    }}\n                  />{\" \"}\n                  {f}\n                </label>\n              ))}\n            </div>\n          </div>\n\n          <div style={{ marginTop: 12 }}>\n            <button onClick={runTranslate} disabled={loading}>\n              Translate Selected\n            </button>\n            <button\n              onClick={() => {\n                if (!translations) return;\n                const blob = new Blob([JSON.stringify(translations, null, 2)], { type: \"application/json\" });\n                const url = URL.createObjectURL(blob);\n                const a = document.createElement(\"a\");\n                a.href = url;\n                a.download = `${productId}-translations.json`;\n                a.click();\n                URL.revokeObjectURL(url);\n              }}\n              style={{ marginLeft: 8 }}\n            >\n              Export JSON\n            </button>\n          </div>\n\n          {loading && <p>Translatingâ€¦</p>}\n          {error && <p style={{ color: \"red\" }}>{error}</p>}\n\n          {translations && (\n            <div style={{ marginTop: 20 }}>\n              <h3>Results</h3>\n              {Object.entries(translations as Record<string, any>).map(([lang, payload]) => {\n                const p = payload as Record<string, any>;\n                return (\n                  <div key={lang} style={{ borderTop: \"1px solid #eee\", paddingTop: 12 }}>\n                    <h4>{lang}</h4>\n                    <div>\n                      <strong>Name</strong>\n                      <div>{p?.name ?? \"(none)\"}</div>\n                    </div>\n                    <div>\n                      <strong>Description</strong>\n                      <div dangerouslySetInnerHTML={{ __html: p?.description_html ?? \"\" }} />\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </>\n      )}\n    </main>\n  );\n}\n","export const SUPPORTED_LANGUAGES = [\n  { code: \"es\", label: \"Spanish\" },\n  { code: \"fr\", label: \"French\" },\n  { code: \"de\", label: \"German\" },\n  { code: \"it\", label: \"Italian\" },\n  { code: \"pt\", label: \"Portuguese\" },\n  { code: \"zh_CN\", label: \"Chinese (Simplified)\" }\n];\n"],"names":[],"mappings":"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"}