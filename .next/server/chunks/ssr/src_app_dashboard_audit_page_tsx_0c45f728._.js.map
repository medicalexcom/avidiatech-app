{"version":3,"sources":["../../../../src/app/dashboard/audit/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\n\n/**\n * AvidiaAudit workspace (client)\n *\n * Goals:\n * - Above-the-fold CTA (URL + Run buttons)\n * - Two modes:\n *   1) Run from URL: ingest → poll → pipeline(extract+seo+audit)\n *   2) Run on existing ingestionId: pipeline(audit) OR pipeline(extract+seo+audit) selectable\n * - Live pipeline telemetry (status, progress, module runtimes, output_refs)\n * - Audit dashboard (score, pass/fail, blockers/warnings, checks table)\n * - Raw JSON viewer + export\n *\n * Notes:\n * - Audit persistence is stored at product_ingestions.diagnostics.audit\n * - Durable artifacts are stored in pipeline-outputs and linked via module_runs.output_ref\n */\n\ntype AnyObj = Record<string, any>;\n\ntype PipelineRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\";\ntype ModuleRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\" | \"skipped\";\n\ntype PipelineModule = {\n  id?: string;\n  module_index: number;\n  module_name: string;\n  status: ModuleRunStatus;\n  started_at?: string | null;\n  finished_at?: string | null;\n  output_ref?: string | null;\n  error?: any;\n};\n\ntype PipelineSnapshot = {\n  run?: {\n    id: string;\n    status: PipelineRunStatus;\n    created_at?: string;\n    started_at?: string;\n    finished_at?: string;\n  } & AnyObj;\n  modules?: PipelineModule[];\n};\n\ntype Mode = \"url\" | \"ingestion\";\ntype IngestionAuditMode = \"audit_only\" | \"extract_seo_audit\";\n\nconst STEPS_URL_FLOW = [\"extract\", \"seo\", \"audit\"] as const;\nconst STEPS_AUDIT_ONLY = [\"audit\"] as const;\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\nfunction fmtMs(ms: number | null) {\n  if (ms == null || Number.isNaN(ms)) return \"—\";\n  if (ms < 1000) return `${ms}ms`;\n  const s = Math.round(ms / 100) / 10;\n  return `${s}s`;\n}\n\nfunction moduleLabel(name: string) {\n  switch (name) {\n    case \"extract\":\n      return \"Extract\";\n    case \"seo\":\n      return \"SEO\";\n    case \"audit\":\n      return \"Audit\";\n    case \"import\":\n      return \"Import\";\n    case \"monitor\":\n      return \"Monitor\";\n    case \"price\":\n      return \"Price\";\n    default:\n      return name;\n  }\n}\n\nfunction badgeClassForSeverity(sev: string) {\n  const s = (sev || \"\").toLowerCase();\n  if (s === \"critical\" || s === \"blocker\" || s === \"high\" || s === \"error\") {\n    return \"bg-rose-100 text-rose-800 border-rose-200 dark:bg-rose-950/40 dark:text-rose-100 dark:border-rose-500/40\";\n  }\n  if (s === \"warn\" || s === \"warning\" || s === \"medium\") {\n    return \"bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-950/40 dark:text-amber-100 dark:border-amber-500/40\";\n  }\n  return \"bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-950/40 dark:text-emerald-100 dark:border-emerald-500/40\";\n}\n\nfunction statusChipClass(status: string) {\n  const s = (status || \"\").toLowerCase();\n  if (s === \"running\")\n    return \"bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-950/40 dark:text-amber-100 dark:border-amber-500/40\";\n  if (s === \"failed\")\n    return \"bg-rose-100 text-rose-800 border-rose-200 dark:bg-rose-950/40 dark:text-rose-100 dark:border-rose-500/40\";\n  if (s === \"succeeded\" || s === \"completed\")\n    return \"bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-950/40 dark:text-emerald-100 dark:border-emerald-500/40\";\n  if (s === \"skipped\")\n    return \"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-950/40 dark:text-slate-300 dark:border-slate-800\";\n  return \"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-950/40 dark:text-slate-300 dark:border-slate-800\";\n}\n\n/**\n * Shape-detection so this page doesn't hardcode a strict audit schema.\n * Our current minimal audit lives at diagnostics.audit:\n *   { status, score, blockers[], warnings[], summary, checks[] }\n */\nfunction normalizeAudit(auditAny: any) {\n  const audit = auditAny ?? null;\n  if (!audit || typeof audit !== \"object\") {\n    return {\n      ok: null as boolean | null,\n      status: null as string | null,\n      score: null as number | null,\n      summary: null as string | null,\n      blockers: [] as string[],\n      warnings: [] as string[],\n      checks: [] as any[],\n      categories: [] as Array<{\n        key: string;\n        label: string;\n        score: number | null;\n        status: string | null;\n      }>,\n      issues: [] as Array<any>,\n      raw: auditAny ?? null,\n      lastRunAt: null as string | null,\n    };\n  }\n\n  const score = typeof audit.score === \"number\" ? audit.score : null;\n\n  const status =\n    typeof audit.status === \"string\"\n      ? audit.status\n      : typeof audit.state === \"string\"\n      ? audit.state\n      : null;\n\n  const ok =\n    typeof audit.ok === \"boolean\"\n      ? audit.ok\n      : status\n      ? [\"passed\", \"ok\", \"success\", \"completed\"].includes(status.toLowerCase())\n      : null;\n\n  const blockers = Array.isArray(audit.blockers) ? audit.blockers : [];\n  const warnings = Array.isArray(audit.warnings) ? audit.warnings : [];\n\n  const issues = Array.isArray(audit.issues)\n    ? audit.issues\n    : Array.isArray(audit.findings)\n    ? audit.findings\n    : [];\n\n  const checks = Array.isArray(audit.checks) ? audit.checks : [];\n\n  const categoriesRaw = audit.categories || audit.categoryScores || null;\n  const categories =\n    Array.isArray(categoriesRaw)\n      ? categoriesRaw.map((c: any, idx: number) => ({\n          key: String(c.key ?? c.name ?? idx),\n          label: String(c.label ?? c.name ?? c.key ?? `Category ${idx + 1}`),\n          score: typeof c.score === \"number\" ? c.score : null,\n          status: typeof c.status === \"string\" ? c.status : null,\n        }))\n      : [];\n\n  const summary = typeof audit.summary === \"string\" ? audit.summary : null;\n  const lastRunAt =\n    typeof audit.last_run_at === \"string\"\n      ? audit.last_run_at\n      : typeof audit.lastRunAt === \"string\"\n      ? audit.lastRunAt\n      : typeof audit.updated_at === \"string\"\n      ? audit.updated_at\n      : null;\n\n  return {\n    ok,\n    status,\n    score,\n    summary,\n    blockers,\n    warnings,\n    checks,\n    categories,\n    issues,\n    raw: audit,\n    lastRunAt,\n  };\n}\n\n/** tiny UI helpers (no deps) */\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction ProgressRing({ value }: { value: number }) {\n  const v = Math.max(0, Math.min(100, value));\n  return (\n    <div\n      className=\"relative h-12 w-12 shrink-0 rounded-full border border-slate-200 bg-white/80 shadow-sm dark:border-slate-800 dark:bg-slate-950/50\"\n      style={{\n        // Orange-forward (matches page accents)\n        background: `conic-gradient(from 225deg, rgba(249,115,22,0.95) ${v}%, rgba(226,232,240,1) 0)`,\n      }}\n      aria-label={`Progress ${v}%`}\n      title={`Progress ${v}%`}\n    >\n      <div className=\"absolute inset-1.5 rounded-full bg-slate-50 dark:bg-slate-950\" />\n      <div className=\"absolute inset-0 grid place-items-center text-[10px] font-semibold text-slate-700 dark:text-slate-200\">\n        {v}%\n      </div>\n    </div>\n  );\n}\n\nexport default function AuditPage() {\n  const params = useSearchParams();\n  const router = useRouter();\n\n  const ingestionIdParam = params?.get(\"ingestionId\") || \"\";\n  const urlParam = params?.get(\"url\") || \"\";\n  const pipelineRunIdParam = params?.get(\"pipelineRunId\") || \"\";\n\n  const [mode, setMode] = useState<Mode>(urlParam ? \"url\" : \"ingestion\");\n  const [ingestionAuditMode, setIngestionAuditMode] =\n    useState<IngestionAuditMode>(\"extract_seo_audit\");\n\n  const [urlInput, setUrlInput] = useState(urlParam || \"\");\n  const [ingestionIdInput, setIngestionIdInput] = useState(ingestionIdParam || \"\");\n\n  const [job, setJob] = useState<any | null>(null);\n  const [pipelineRunId, setPipelineRunId] = useState<string>(pipelineRunIdParam || \"\");\n  const [pipelineSnapshot, setPipelineSnapshot] = useState<PipelineSnapshot | null>(null);\n\n  const [loading, setLoading] = useState(false);\n  const [running, setRunning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n\n  // Debug/polling\n  const [rawIngestResponse, setRawIngestResponse] = useState<any | null>(null);\n  const [pollingState, setPollingState] = useState<string | null>(null);\n\n  const [showRawAuditJson, setShowRawAuditJson] = useState(false);\n  const [issueFilter, setIssueFilter] = useState<\"all\" | \"errors\" | \"warnings\">(\"all\");\n  const [search, setSearch] = useState(\"\");\n  const [showDevPanels, setShowDevPanels] = useState(false);\n\n  const fetchIngestionData = useCallback(async (id: string) => {\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/v1/ingest/${encodeURIComponent(id)}`);\n      const json = await res.json();\n      if (!res.ok)\n        throw new Error(\n          json?.error?.message || json?.error || `Ingest fetch failed: ${res.status}`\n        );\n      setJob(json?.data ?? json);\n      return json?.data ?? json;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const fetchPipelineSnapshot = useCallback(async (runId: string) => {\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok)\n      throw new Error(\n        json?.error?.message || json?.error || `Pipeline fetch failed: ${res.status}`\n      );\n    return json as PipelineSnapshot;\n  }, []);\n\n  async function pollPipeline(runId: string, timeoutMs = 300_000, intervalMs = 2000) {\n    const start = Date.now();\n    setStatusMessage(\"Pipeline running\");\n    while (Date.now() - start < timeoutMs) {\n      const snap = await fetchPipelineSnapshot(runId);\n      setPipelineSnapshot(snap);\n      const s = snap?.run?.status;\n      if (s === \"succeeded\" || s === \"failed\") return snap;\n      await sleep(intervalMs);\n    }\n    throw new Error(\"Pipeline did not complete within timeout\");\n  }\n\n  async function pollForIngestion(jobId: string, timeoutMs = 120_000, intervalMs = 3000) {\n    const start = Date.now();\n    setPollingState(`polling job ${jobId}`);\n    setStatusMessage(\"Scraping & normalizing\");\n    while (Date.now() - start < timeoutMs) {\n      const res = await fetch(`/api/v1/ingest/job/${encodeURIComponent(jobId)}`);\n      if (res.status === 200) {\n        const j = await res.json();\n        setPollingState(`completed: ingestionId=${j.ingestionId}`);\n        setStatusMessage(\"Ingestion completed\");\n        return j;\n      }\n      const elapsed = Math.floor((Date.now() - start) / 1000);\n      setPollingState(`waiting... ${elapsed}s`);\n      await sleep(intervalMs);\n    }\n    setPollingState(\"timeout\");\n    setStatusMessage(null);\n    throw new Error(\"Ingestion did not complete within timeout\");\n  }\n\n  async function createIngestion(url: string) {\n    if (!url) throw new Error(\"Please enter a URL\");\n\n    setRawIngestResponse(null);\n    setPollingState(null);\n    setStatusMessage(\"Submitting ingestion\");\n\n    const res = await fetch(\"/api/v1/ingest\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        url,\n        persist: true,\n        options: { includeSeo: true },\n      }),\n    });\n\n    const json = await res.json().catch(() => null);\n    setRawIngestResponse({ status: res.status, body: json });\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Ingest failed: ${res.status}`);\n\n    const possibleIngestionId =\n      json?.ingestionId ?? json?.id ?? json?.data?.id ?? json?.data?.ingestionId ?? null;\n\n    if (possibleIngestionId) {\n      if (json?.status === \"accepted\" || res.status === 202) {\n        const jobId = json?.jobId ?? json?.ingestionId ?? possibleIngestionId;\n        const pollResult = await pollForIngestion(jobId, 120_000, 3000);\n        return pollResult?.ingestionId ?? possibleIngestionId;\n      }\n      return possibleIngestionId;\n    }\n\n    const jobId = json?.jobId ?? json?.job?.id ?? null;\n    if (!jobId) throw new Error(\"Ingest did not return an ingestionId or jobId. See debug.\");\n    const pollResult = await pollForIngestion(jobId, 120_000, 3000);\n    const newId = pollResult?.ingestionId ?? pollResult?.id ?? null;\n    if (!newId) throw new Error(\"Polling returned no ingestionId.\");\n    return newId;\n  }\n\n  async function startPipeline(ingestionId: string, steps: string[]) {\n    setStatusMessage(\"Starting pipeline\");\n    const res = await fetch(\"/api/v1/pipeline/run\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        ingestionId,\n        triggerModule: \"audit\",\n        steps,\n        options: {},\n      }),\n    });\n    const json = await res.json().catch(() => null);\n    if (!res.ok)\n      throw new Error(json?.error?.message || json?.error || `Pipeline start failed: ${res.status}`);\n    const runId = String(json?.pipelineRunId ?? \"\");\n    if (!runId) throw new Error(\"Pipeline start did not return pipelineRunId\");\n    setPipelineRunId(runId);\n    return runId;\n  }\n\n  async function runAuditFromUrl() {\n    if (running) return;\n    setRunning(true);\n    setError(null);\n    setStatusMessage(null);\n    setPipelineSnapshot(null);\n\n    try {\n      const ingestionId = await createIngestion(urlInput);\n      setIngestionIdInput(ingestionId);\n\n      router.push(\n        `/dashboard/audit?url=${encodeURIComponent(urlInput)}&ingestionId=${encodeURIComponent(ingestionId)}`\n      );\n\n      await fetchIngestionData(ingestionId);\n      const runId = await startPipeline(ingestionId, [...STEPS_URL_FLOW]);\n      router.push(\n        `/dashboard/audit?url=${encodeURIComponent(urlInput)}&ingestionId=${encodeURIComponent(\n          ingestionId\n        )}&pipelineRunId=${encodeURIComponent(runId)}`\n      );\n\n      await pollPipeline(runId, 300_000, 2000);\n      await fetchIngestionData(ingestionId);\n\n      setStatusMessage(\"Audit completed\");\n    } catch (e: any) {\n      setError(String(e?.message || e));\n      setStatusMessage(null);\n    } finally {\n      setRunning(false);\n      setPollingState(null);\n    }\n  }\n\n  async function runAuditOnIngestion() {\n    if (running) return;\n    setRunning(true);\n    setError(null);\n    setStatusMessage(null);\n    setPipelineSnapshot(null);\n\n    try {\n      const id = ingestionIdInput.trim();\n      if (!id) throw new Error(\"Please enter an ingestionId\");\n\n      router.push(`/dashboard/audit?ingestionId=${encodeURIComponent(id)}`);\n\n      await fetchIngestionData(id);\n\n      const steps =\n        ingestionAuditMode === \"audit_only\" ? [...STEPS_AUDIT_ONLY] : [...STEPS_URL_FLOW];\n\n      const runId = await startPipeline(id, steps);\n      router.push(\n        `/dashboard/audit?ingestionId=${encodeURIComponent(id)}&pipelineRunId=${encodeURIComponent(runId)}`\n      );\n\n      await pollPipeline(runId, 300_000, 2000);\n      await fetchIngestionData(id);\n\n      setStatusMessage(\"Audit completed\");\n    } catch (e: any) {\n      setError(String(e?.message || e));\n      setStatusMessage(null);\n    } finally {\n      setRunning(false);\n      setPollingState(null);\n    }\n  }\n\n  // initial load if ingestionId is present\n  useEffect(() => {\n    if (!ingestionIdParam) return;\n    (async () => {\n      try {\n        await fetchIngestionData(ingestionIdParam);\n      } catch (e: any) {\n        setError(String(e?.message || e));\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ingestionIdParam]);\n\n  // load pipeline snapshot if pipelineRunId present\n  useEffect(() => {\n    if (!pipelineRunIdParam) return;\n    (async () => {\n      try {\n        const snap = await fetchPipelineSnapshot(pipelineRunIdParam);\n        setPipelineSnapshot(snap);\n      } catch (e: any) {\n        setError(String(e?.message || e));\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pipelineRunIdParam]);\n\n  const jobData = useMemo(() => {\n    if (!job) return null;\n    if ((job as any)?.data?.data) return (job as any).data.data;\n    if ((job as any)?.data) return (job as any).data;\n    return job;\n  }, [job]);\n\n  const auditDiagnostics = jobData?.diagnostics?.audit ?? null;\n  const audit = useMemo(() => normalizeAudit(auditDiagnostics), [auditDiagnostics]);\n\n  const runStatus = pipelineSnapshot?.run?.status ?? null;\n\n  const moduleRuntimeMs = useMemo(() => {\n    const map = new Map<string, number>();\n    for (const m of pipelineSnapshot?.modules ?? []) {\n      if (m.started_at && m.finished_at) {\n        const ms = new Date(m.finished_at).getTime() - new Date(m.started_at).getTime();\n        if (!Number.isNaN(ms) && ms >= 0) map.set(m.module_name, ms);\n      }\n    }\n    return map;\n  }, [pipelineSnapshot]);\n\n  const progress = useMemo(() => {\n    const mods = pipelineSnapshot?.modules ?? [];\n    if (!mods.length) return 0;\n    let done = 0;\n    for (const m of mods) if ([\"succeeded\", \"failed\", \"skipped\"].includes(m.status)) done++;\n    return Math.round((done / mods.length) * 100);\n  }, [pipelineSnapshot]);\n\n  const derivedIssues = useMemo(() => {\n    const issues: any[] = [];\n    for (const b of audit.blockers ?? []) {\n      issues.push({ severity: \"blocker\", rule: \"blocker\", message: b, location: \"audit\" });\n    }\n    for (const w of audit.warnings ?? []) {\n      issues.push({ severity: \"warning\", rule: \"warning\", message: w, location: \"audit\" });\n    }\n    for (const it of audit.issues ?? []) issues.push(it);\n    return issues;\n  }, [audit.blockers, audit.issues, audit.warnings]);\n\n  const filteredIssues = useMemo(() => {\n    const term = search.trim().toLowerCase();\n    return derivedIssues.filter((i) => {\n      const sev = String(i?.severity ?? i?.level ?? \"\").toLowerCase();\n      if (issueFilter === \"errors\") {\n        if (\n          !(\n            sev.includes(\"block\") ||\n            sev.includes(\"crit\") ||\n            sev.includes(\"high\") ||\n            sev.includes(\"error\") ||\n            sev.includes(\"fail\")\n          )\n        ) {\n          return false;\n        }\n      }\n      if (issueFilter === \"warnings\") {\n        if (!(sev.includes(\"warn\") || sev.includes(\"medium\"))) return false;\n      }\n      if (!term) return true;\n      const hay = `${i?.rule ?? \"\"} ${i?.message ?? \"\"} ${i?.location ?? \"\"}`.toLowerCase();\n      return hay.includes(term);\n    });\n  }, [derivedIssues, issueFilter, search]);\n\n  const scoreTone =\n    audit.score == null ? \"slate\" : audit.score >= 90 ? \"emerald\" : audit.score >= 75 ? \"amber\" : \"rose\";\n\n  const scoreChipClass =\n    scoreTone === \"emerald\"\n      ? \"bg-emerald-500/10 border-emerald-400/60 text-emerald-700 dark:text-emerald-200\"\n      : scoreTone === \"amber\"\n      ? \"bg-amber-500/10 border-amber-400/60 text-amber-700 dark:text-amber-200\"\n      : scoreTone === \"rose\"\n      ? \"bg-rose-500/10 border-rose-400/60 text-rose-700 dark:text-rose-200\"\n      : \"bg-slate-500/10 border-slate-400/60 text-slate-700 dark:text-slate-200\";\n\n  const downloadableAuditJson = useMemo(() => {\n    return {\n      ingestionId: jobData?.id ?? ingestionIdInput ?? null,\n      pipelineRunId: pipelineRunId || null,\n      audit: audit.raw ?? null,\n      diagnostics_audit: auditDiagnostics ?? null,\n      pipeline: pipelineSnapshot ?? null,\n    };\n  }, [audit.raw, auditDiagnostics, ingestionIdInput, jobData?.id, pipelineRunId, pipelineSnapshot]);\n\n  const downloadJson = (filename: string, data: any) => {\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const copyText = async (text: string) => {\n    try {\n      await navigator.clipboard.writeText(text);\n      setStatusMessage(\"Copied to clipboard\");\n      setTimeout(() => setStatusMessage(null), 1500);\n    } catch {\n      // silent\n    }\n  };\n\n  const demoUrl = \"https://www.apple.com/iphone-17/\";\n\n  const ingestionId = String(jobData?.id ?? ingestionIdInput ?? \"\");\n  const blockersCount = (audit.blockers ?? []).length;\n  const warningsCount = (audit.warnings ?? []).length;\n  const checksCount = Array.isArray(audit.checks) ? audit.checks.length : 0;\n\n  const headerState =\n    running || loading || pollingState || runStatus === \"running\"\n      ? \"Running…\"\n      : pipelineRunId\n      ? \"Ready\"\n      : \"Idle\";\n\n  return (\n    <main className=\"relative min-h-screen overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50\">\n      {/* Ambient background — match Audit (amber/orange/pink blobs) */}\n      <div className=\"pointer-events-none absolute inset-0 -z-10\">\n        {/* top-left: amber */}\n        <div className=\"absolute -top-36 -left-28 h-[26rem] w-[26rem] rounded-full bg-amber-300/28 blur-3xl dark:bg-amber-500/16\" />\n        {/* top-right: orange */}\n        <div className=\"absolute -top-28 right-[-10rem] h-[24rem] w-[24rem] rounded-full bg-orange-300/22 blur-3xl dark:bg-orange-500/12\" />\n        {/* bottom-right: pink */}\n        <div className=\"absolute -bottom-48 right-[-12rem] h-[30rem] w-[30rem] rounded-full bg-pink-300/18 blur-3xl dark:bg-pink-500/10\" />\n\n        {/* soft vignette */}\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.88)_55%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.92)_55%,_rgba(15,23,42,1)_100%)]\" />\n\n        {/* grid */}\n        <div className=\"absolute inset-0 opacity-[0.035] mix-blend-soft-light dark:opacity-[0.07]\">\n          <div className=\"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:46px_46px] dark:bg-[linear-gradient(to_right,#1e293b_1px,transparent_1px),linear-gradient(to_bottom,#1e293b_1px,transparent_1px)]\" />\n        </div>\n      </div>\n\n      <div className=\"mx-auto max-w-7xl space-y-5 px-4 py-6 sm:px-6 lg:px-10 lg:py-8\">\n        {/* Top bar */}\n        <section className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/90 px-3 py-1.5 text-[10px] font-medium uppercase tracking-[0.18em] text-slate-600 shadow-sm dark:border-slate-800 dark:bg-slate-950/70 dark:text-slate-300\">\n              <span className=\"inline-flex h-3 w-3 items-center justify-center rounded-full bg-slate-50 border border-amber-200 dark:bg-slate-900 dark:border-amber-400/30\">\n                <span\n                  className={cx(\n                    \"h-1.5 w-1.5 rounded-full\",\n                    running ? \"bg-amber-400 animate-pulse\" : \"bg-orange-400\"\n                  )}\n                />\n              </span>\n              Data Intelligence · AvidiaAudit\n              {ingestionId ? (\n                <>\n                  <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                  <button\n                    type=\"button\"\n                    onClick={() => copyText(ingestionId)}\n                    className=\"font-mono text-[10px] text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white\"\n                    title=\"Copy ingestionId\"\n                  >\n                    {ingestionId.slice(0, 8)}…\n                  </button>\n                </>\n              ) : null}\n              {pipelineRunId ? (\n                <>\n                  <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                  <button\n                    type=\"button\"\n                    onClick={() => copyText(pipelineRunId)}\n                    className=\"font-mono text-[10px] text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white\"\n                    title=\"Copy pipelineRunId\"\n                  >\n                    run:{pipelineRunId.slice(0, 8)}…\n                  </button>\n                </>\n              ) : null}\n            </div>\n\n            <div className=\"hidden sm:flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400\">\n              <span className=\"h-1.5 w-1.5 rounded-full bg-slate-300 dark:bg-slate-700\" />\n              {headerState}\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap items-center gap-2\">\n            {statusMessage ? (\n              <div className=\"inline-flex items-center gap-2 rounded-full border border-amber-200 bg-amber-50 px-3 py-1.5 text-[11px] text-amber-900 shadow-sm dark:border-amber-500/30 dark:bg-slate-950/70 dark:text-amber-100\">\n                <span className=\"h-1.5 w-1.5 rounded-full bg-amber-400 animate-pulse\" />\n                {statusMessage}\n              </div>\n            ) : null}\n\n            <button\n              type=\"button\"\n              onClick={async () => {\n                try {\n                  setError(null);\n                  if (!pipelineRunId) return;\n                  const snap = await fetchPipelineSnapshot(pipelineRunId);\n                  setPipelineSnapshot(snap);\n                  setStatusMessage(\"Snapshot refreshed\");\n                  setTimeout(() => setStatusMessage(null), 1500);\n                } catch (e: any) {\n                  setError(String(e?.message || e));\n                }\n              }}\n              disabled={!pipelineRunId || running}\n              className=\"inline-flex items-center justify-center rounded-full border border-slate-200 bg-white/90 px-3 py-1.5 text-[11px] text-slate-700 shadow-sm hover:bg-white disabled:opacity-60 dark:border-slate-800 dark:bg-slate-950/60 dark:text-slate-200 dark:hover:bg-slate-950\"\n              title=\"Refresh pipeline snapshot\"\n            >\n              Refresh\n            </button>\n\n            <button\n              type=\"button\"\n              onClick={() => setShowDevPanels((v) => !v)}\n              className=\"inline-flex items-center justify-center rounded-full border border-slate-200 bg-white/90 px-3 py-1.5 text-[11px] text-slate-700 shadow-sm hover:bg-white dark:border-slate-800 dark:bg-slate-950/60 dark:text-slate-200 dark:hover:bg-slate-950\"\n            >\n              {showDevPanels ? \"Hide dev panels\" : \"Show dev panels\"}\n            </button>\n          </div>\n        </section>\n\n        {/* Hero / CTA + Scoreboard */}\n        <section className=\"rounded-3xl border border-slate-200 bg-white/92 shadow-[0_18px_45px_rgba(148,163,184,0.22)] backdrop-blur dark:border-slate-800 dark:bg-slate-950/55 dark:shadow-[0_18px_45px_rgba(15,23,42,0.75)]\">\n          <div className=\"grid grid-cols-1 gap-4 p-4 lg:grid-cols-12 lg:gap-5 lg:p-5\">\n            {/* Left: headline + run */}\n            <div className=\"lg:col-span-7 space-y-4\">\n              <div className=\"space-y-2\">\n                <h1 className=\"text-xl font-semibold leading-tight text-slate-900 sm:text-2xl dark:text-slate-50\">\n                  Turn your product rules into a{\" \"}\n                  <span\n                    className=\"audit-title-gradient bg-clip-text text-transparent\"\n                    style={{\n                      backgroundImage:\n                        \"linear-gradient(90deg, rgba(251,191,36,1), rgba(249,115,22,1), rgba(236,72,153,1), rgba(251,191,36,1))\",\n                    }}\n                  >\n                    measurable, enforceable audit score\n                  </span>\n                  .\n                </h1>\n                <p className=\"max-w-2xl text-sm text-slate-600 dark:text-slate-300\">\n                  Run deterministic checks now (v1), persist a structured audit payload, and use it as a guardrail for\n                  safe automation. When audit fails, downstream modules can be skipped automatically.\n                </p>\n              </div>\n\n              {/* quick chips */}\n              <div className=\"flex flex-wrap gap-2 text-[11px]\">\n                <span className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-slate-700 dark:border-slate-800 dark:bg-slate-950/60 dark:text-slate-200\">\n                  <span className=\"font-mono text-slate-600 dark:text-slate-300\">URL flow</span>\n                  <span className=\"text-slate-500 dark:text-slate-400\">ingest → extract → seo → audit</span>\n                </span>\n                <span className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-slate-700 dark:border-slate-800 dark:bg-slate-950/60 dark:text-slate-200\">\n                  <span className=\"font-mono text-slate-600 dark:text-slate-300\">Ingestion flow</span>\n                  <span className=\"text-slate-500 dark:text-slate-400\">audit-only or full chain</span>\n                </span>\n                <span className=\"inline-flex items-center gap-2 rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-amber-950 dark:border-amber-500/30 dark:bg-amber-500/10 dark:text-amber-100\">\n                  <span className=\"h-1.5 w-1.5 rounded-full bg-amber-400\" />\n                  auditResult JSON per run\n                </span>\n              </div>\n\n              {/* Run mode */}\n              <div className=\"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm dark:border-slate-800 dark:bg-slate-950/50\">\n                <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                  <div className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                    Run mode\n                  </div>\n\n                  <div className=\"inline-flex rounded-full border border-slate-200 bg-slate-50 p-1 text-[11px] dark:border-slate-800 dark:bg-slate-950/60\">\n                    <button\n                      type=\"button\"\n                      className={cx(\n                        \"px-3 py-1 rounded-full transition\",\n                        mode === \"url\"\n                          ? \"bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500 text-slate-950 shadow-sm\"\n                          : \"text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white\"\n                      )}\n                      onClick={() => setMode(\"url\")}\n                    >\n                      From URL\n                    </button>\n                    <button\n                      type=\"button\"\n                      className={cx(\n                        \"px-3 py-1 rounded-full transition\",\n                        mode === \"ingestion\"\n                          ? \"bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500 text-slate-950 shadow-sm\"\n                          : \"text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white\"\n                      )}\n                      onClick={() => setMode(\"ingestion\")}\n                    >\n                      From ingestionId\n                    </button>\n                  </div>\n                </div>\n\n                {mode === \"url\" ? (\n                  <div className=\"mt-3 space-y-2\">\n                    <label className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                      Manufacturer Product URL\n                    </label>\n                    <div className=\"flex flex-col gap-2 sm:flex-row\">\n                      <input\n                        value={urlInput}\n                        onChange={(e) => setUrlInput(e.target.value)}\n                        placeholder=\"https://manufacturer.com/product/...\"\n                        className=\"w-full rounded-xl border border-slate-300 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-amber-400 focus:ring-2 focus:ring-amber-500/25 dark:border-slate-700 dark:bg-slate-950/60 dark:text-slate-50 dark:placeholder:text-slate-500\"\n                        type=\"url\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={runAuditFromUrl}\n                        disabled={running}\n                        className=\"w-full rounded-xl px-4 py-3 text-sm font-semibold text-slate-950 shadow-sm transition hover:opacity-95 disabled:opacity-60 sm:w-48 bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500\"\n                      >\n                        {running ? \"Running…\" : \"Run Audit\"}\n                      </button>\n                    </div>\n\n                    <div className=\"flex items-center justify-between gap-2\">\n                      <p className=\"text-[11px] text-slate-500 dark:text-slate-500\">\n                        Creates an ingestion + pipeline run, then persists an audit result to diagnostics.\n                      </p>\n                      <button\n                        type=\"button\"\n                        className=\"text-[11px] text-orange-700 hover:text-orange-600 underline underline-offset-4 dark:text-orange-300 dark:hover:text-orange-200\"\n                        onClick={() => setUrlInput(demoUrl)}\n                      >\n                        Try demo URL\n                      </button>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"mt-3 space-y-2\">\n                    <label className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                      ingestionId\n                    </label>\n\n                    <div className=\"flex flex-col gap-2 sm:flex-row\">\n                      <input\n                        value={ingestionIdInput}\n                        onChange={(e) => setIngestionIdInput(e.target.value)}\n                        placeholder=\"b0324634-1593-4fad-a9de-70215a2deb38\"\n                        className=\"w-full rounded-xl border border-slate-300 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-amber-400 focus:ring-2 focus:ring-amber-500/25 dark:border-slate-700 dark:bg-slate-950/60 dark:text-slate-50 dark:placeholder:text-slate-500\"\n                        type=\"text\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={runAuditOnIngestion}\n                        disabled={running}\n                        className=\"w-full rounded-xl px-4 py-3 text-sm font-semibold text-slate-950 shadow-sm transition hover:opacity-95 disabled:opacity-60 sm:w-48 bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500\"\n                      >\n                        {running ? \"Running…\" : \"Run Audit\"}\n                      </button>\n                    </div>\n\n                    <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                      <div className=\"inline-flex items-center gap-2 text-[11px] text-slate-600 dark:text-slate-300\">\n                        <span className=\"text-slate-500 dark:text-slate-400\">Steps:</span>\n                        <select\n                          value={ingestionAuditMode}\n                          onChange={(e) => setIngestionAuditMode(e.target.value as IngestionAuditMode)}\n                          className=\"rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] dark:border-slate-800 dark:bg-slate-950/60\"\n                        >\n                          <option value=\"extract_seo_audit\">extract + seo + audit</option>\n                          <option value=\"audit_only\">audit only</option>\n                        </select>\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <button\n                          type=\"button\"\n                          className=\"text-[11px] text-slate-500 hover:text-slate-700 underline underline-offset-4 dark:text-slate-400 dark:hover:text-slate-200\"\n                          onClick={async () => {\n                            try {\n                              setError(null);\n                              if (!ingestionIdInput.trim()) throw new Error(\"Enter an ingestionId first.\");\n                              await fetchIngestionData(ingestionIdInput.trim());\n                              setStatusMessage(\"Loaded ingestion\");\n                            } catch (e: any) {\n                              setError(String(e?.message || e));\n                            }\n                          }}\n                        >\n                          Load existing\n                        </button>\n                        {ingestionIdInput ? (\n                          <button\n                            type=\"button\"\n                            className=\"text-[11px] text-slate-500 hover:text-slate-700 underline underline-offset-4 dark:text-slate-400 dark:hover:text-slate-200\"\n                            onClick={() => copyText(ingestionIdInput)}\n                          >\n                            Copy id\n                          </button>\n                        ) : null}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {error ? (\n                <div className=\"rounded-2xl border border-rose-300 bg-rose-50 px-4 py-3 text-sm text-rose-800 shadow-sm dark:border-rose-500/40 dark:bg-rose-950/60 dark:text-rose-50\">\n                  {error}\n                </div>\n              ) : null}\n            </div>\n\n            {/* Right: score + live stats */}\n            <div className=\"lg:col-span-5\">\n              <div className=\"rounded-2xl border border-slate-200 bg-slate-50/90 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/60\">\n                <div className=\"flex items-start justify-between gap-3\">\n                  <div className=\"min-w-0\">\n                    <p className=\"text-[11px] font-medium uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400\">\n                      Audit scoreboard\n                    </p>\n\n                    <div className=\"mt-2 flex flex-wrap items-center gap-2\">\n                      <span\n                        className={cx(\n                          \"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-sm font-semibold\",\n                          scoreChipClass\n                        )}\n                      >\n                        {audit.score == null ? \"—\" : `${audit.score} / 100`}\n                      </span>\n\n                      <span\n                        className={cx(\n                          \"inline-flex items-center rounded-full border px-2.5 py-1 text-[11px]\",\n                          statusChipClass(\n                            audit.status ??\n                              (audit.ok === true ? \"passed\" : audit.ok === false ? \"failed\" : \"unknown\")\n                          )\n                        )}\n                      >\n                        {audit.status ?? (audit.ok === true ? \"passed\" : audit.ok === false ? \"failed\" : \"unknown\")}\n                      </span>\n\n                      {blockersCount ? (\n                        <span className=\"inline-flex items-center gap-2 rounded-full border border-rose-200 bg-rose-50 px-2.5 py-1 text-[11px] text-rose-800 dark:border-rose-500/30 dark:bg-rose-950/40 dark:text-rose-100\">\n                          <span className=\"h-1.5 w-1.5 rounded-full bg-rose-500\" />\n                          {blockersCount} blockers\n                        </span>\n                      ) : (\n                        <span className=\"inline-flex items-center gap-2 rounded-full border border-emerald-200 bg-emerald-50 px-2.5 py-1 text-[11px] text-emerald-800 dark:border-emerald-500/30 dark:bg-emerald-950/35 dark:text-emerald-100\">\n                          <span className=\"h-1.5 w-1.5 rounded-full bg-emerald-500\" />\n                          No blockers\n                        </span>\n                      )}\n\n                      {warningsCount ? (\n                        <span className=\"inline-flex items-center gap-2 rounded-full border border-amber-200 bg-amber-50 px-2.5 py-1 text-[11px] text-amber-800 dark:border-amber-500/30 dark:bg-amber-950/35 dark:text-amber-100\">\n                          <span className=\"h-1.5 w-1.5 rounded-full bg-amber-500\" />\n                          {warningsCount} warnings\n                        </span>\n                      ) : null}\n                    </div>\n\n                    <p className=\"mt-2 text-xs text-slate-600 dark:text-slate-300\">\n                      {audit.summary ?? \"Run an audit to see a score, categories, and structured results.\"}\n                    </p>\n                  </div>\n\n                  <div className=\"flex flex-col items-end gap-2\">\n                    <ProgressRing value={pipelineSnapshot?.modules?.length ? progress : 0} />\n                    <div className=\"text-right text-[11px] text-slate-500 dark:text-slate-400\">\n                      <div>Last audit</div>\n                      <div className=\"font-mono\">\n                        {audit.lastRunAt ? new Date(audit.lastRunAt).toLocaleString() : \"—\"}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Pipeline progress bar */}\n                <div className=\"mt-4\">\n                  <div className=\"flex items-center justify-between text-[11px] text-slate-500 dark:text-slate-400\">\n                    <span>Pipeline progress</span>\n                    <span>{pipelineSnapshot?.modules?.length ? `${progress}%` : \"—\"}</span>\n                  </div>\n                  <div className=\"mt-1 h-2 w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-800\">\n                    <div\n                      className=\"h-full bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500\"\n                      style={{ width: `${progress}%` }}\n                    />\n                  </div>\n                </div>\n\n                {/* Categories (if present) */}\n                {audit.categories?.length ? (\n                  <div className=\"mt-4 rounded-xl border border-slate-200 bg-white px-3 py-2 dark:border-slate-800 dark:bg-slate-950/40\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-[11px] font-semibold uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                        Category scores\n                      </div>\n                      <div className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                        {audit.categories.length} categories\n                      </div>\n                    </div>\n                    <div className=\"mt-2 space-y-2\">\n                      {audit.categories.slice(0, 6).map((c) => {\n                        const v = c.score == null ? 0 : Math.max(0, Math.min(100, c.score));\n                        return (\n                          <div key={c.key} className=\"space-y-1\">\n                            <div className=\"flex items-center justify-between text-[11px]\">\n                              <span className=\"truncate text-slate-700 dark:text-slate-200\">{c.label}</span>\n                              <span className=\"font-mono text-slate-500 dark:text-slate-400\">\n                                {c.score == null ? \"—\" : `${c.score}`}\n                              </span>\n                            </div>\n                            <div className=\"h-1.5 w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-800\">\n                              <div\n                                className=\"h-full bg-gradient-to-r from-amber-400 via-orange-500 to-pink-500\"\n                                style={{ width: `${v}%` }}\n                              />\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                ) : null}\n\n                {/* Gate status */}\n                <div className=\"mt-4 rounded-xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-200\">\n                  <div className=\"font-semibold\">Gate policy</div>\n                  <div className=\"mt-1 text-slate-600 dark:text-slate-300\">\n                    If audit fails: <span className=\"font-semibold\">Import</span>,{\" \"}\n                    <span className=\"font-semibold\">Monitor</span>, and <span className=\"font-semibold\">Price</span> are\n                    skipped automatically.\n                  </div>\n                </div>\n\n                {/* Actions */}\n                <div className=\"mt-4 flex flex-wrap gap-2\">\n                  <button\n                    type=\"button\"\n                    onClick={() =>\n                      downloadJson(`audit-${jobData?.id ?? ingestionIdInput ?? \"unknown\"}.json`, downloadableAuditJson)\n                    }\n                    className=\"rounded-lg border border-slate-900 bg-slate-900 px-3 py-2 text-xs text-slate-50 shadow-sm hover:bg-slate-800 dark:border-white/20 dark:bg-white/5 dark:hover:bg-white/10\"\n                  >\n                    Export JSON\n                  </button>\n\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowRawAuditJson((v) => !v)}\n                    className=\"rounded-lg border border-slate-200 bg-slate-100 px-3 py-2 text-xs text-slate-900 shadow-sm hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-100\"\n                  >\n                    {showRawAuditJson ? \"Hide raw\" : \"Show raw\"}\n                  </button>\n\n                  {pipelineRunId ? (\n                    <button\n                      type=\"button\"\n                      onClick={() => copyText(JSON.stringify(downloadableAuditJson, null, 2))}\n                      className=\"rounded-lg border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-200\"\n                      title=\"Copy full JSON payload\"\n                    >\n                      Copy payload\n                    </button>\n                  ) : null}\n                </div>\n\n                {showRawAuditJson ? (\n                  <pre className=\"mt-3 max-h-[320px] overflow-auto rounded-xl border border-slate-200 bg-slate-900 p-3 text-[11px] text-slate-100 dark:border-slate-800\">\n                    {JSON.stringify(downloadableAuditJson, null, 2)}\n                  </pre>\n                ) : null}\n\n                <div className=\"mt-4 flex items-center justify-between text-[11px] text-slate-500 dark:text-slate-400\">\n                  <span>Checks: {checksCount || \"—\"}</span>\n                  <span>{pollingState ? `Ingest: ${pollingState}` : runStatus ? `Run: ${runStatus}` : \"\"}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Body: pipeline + issues/checks */}\n        <section className=\"grid grid-cols-1 gap-4 lg:grid-cols-12\">\n          {/* Live pipeline */}\n          <div className=\"lg:col-span-5 rounded-3xl border border-slate-200 bg-white/92 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/55\">\n            <div className=\"flex items-center justify-between gap-3\">\n              <div>\n                <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Live pipeline</h2>\n                <p className=\"mt-1 text-[11px] text-slate-500 dark:text-slate-400\">\n                  Status, runtime, output refs — in the order your pipeline executed.\n                </p>\n              </div>\n              <span\n                className={cx(\n                  \"inline-flex items-center rounded-full border px-2.5 py-1 text-[11px]\",\n                  statusChipClass(runStatus ?? \"idle\")\n                )}\n              >\n                {runStatus ?? \"idle\"}\n              </span>\n            </div>\n\n            <div className=\"mt-4 space-y-2\">\n              {(pipelineSnapshot?.modules ?? [])\n                .slice()\n                .sort((a, b) => a.module_index - b.module_index)\n                .map((m) => (\n                  <div\n                    key={`${m.module_index}-${m.module_name}`}\n                    className=\"group flex items-start justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5 transition hover:bg-white dark:border-slate-800 dark:bg-slate-950/40 dark:hover:bg-slate-950/60\"\n                  >\n                    <div className=\"min-w-0\">\n                      <div className=\"flex items-center gap-2\">\n                        <span\n                          className={cx(\n                            \"h-2 w-2 rounded-full\",\n                            m.status === \"succeeded\"\n                              ? \"bg-emerald-400\"\n                              : m.status === \"failed\"\n                              ? \"bg-rose-400\"\n                              : m.status === \"running\"\n                              ? \"bg-amber-400 animate-pulse\"\n                              : \"bg-slate-400\"\n                          )}\n                        />\n                        <div className=\"font-semibold text-slate-900 dark:text-slate-50 truncate\">\n                          {m.module_index}. {moduleLabel(m.module_name)}\n                        </div>\n                        <span\n                          className={cx(\n                            \"ml-auto inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]\",\n                            statusChipClass(m.status)\n                          )}\n                        >\n                          {m.status}\n                        </span>\n                      </div>\n\n                      <div className=\"mt-1.5 flex flex-wrap items-center gap-2 text-[11px] text-slate-500 dark:text-slate-400\">\n                        <span className=\"font-mono\">{fmtMs(moduleRuntimeMs.get(m.module_name) ?? null)}</span>\n                        <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                        <span className=\"truncate\">\n                          output_ref:{\" \"}\n                          <span className=\"font-mono text-slate-600 dark:text-slate-300\">\n                            {m.output_ref ?? \"—\"}\n                          </span>\n                        </span>\n                        {m.output_ref ? (\n                          <button\n                            type=\"button\"\n                            onClick={() => copyText(String(m.output_ref))}\n                            className=\"ml-auto rounded-full border border-slate-200 bg-white px-2 py-0.5 text-[10px] text-slate-600 shadow-sm hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-300 dark:hover:bg-slate-950\"\n                            title=\"Copy output_ref\"\n                          >\n                            Copy\n                          </button>\n                        ) : null}\n                      </div>\n\n                      {m.error ? (\n                        <div className=\"mt-1 text-[11px] text-rose-700 dark:text-rose-200\">\n                          error: {typeof m.error === \"string\" ? m.error : JSON.stringify(m.error)}\n                        </div>\n                      ) : null}\n                    </div>\n                  </div>\n                ))}\n\n              {!(pipelineSnapshot?.modules ?? []).length ? (\n                <div className=\"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-4 text-[11px] text-slate-500 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-400\">\n                  No pipeline run selected yet. Run an audit to see module telemetry.\n                </div>\n              ) : null}\n            </div>\n          </div>\n\n          {/* Issues + Checks */}\n          <div className=\"lg:col-span-7 space-y-4\">\n            {/* Issues */}\n            <div className=\"rounded-3xl border border-slate-200 bg-white/92 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/55\">\n              <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                <div>\n                  <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Issues</h2>\n                  <p className=\"mt-1 text-[11px] text-slate-500 dark:text-slate-400\">\n                    Blockers and warnings (v1). Filter, search, and export for workflows.\n                  </p>\n                </div>\n\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <select\n                    value={issueFilter}\n                    onChange={(e) => setIssueFilter(e.target.value as any)}\n                    className=\"rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] dark:border-slate-800 dark:bg-slate-950/60\"\n                  >\n                    <option value=\"all\">All</option>\n                    <option value=\"errors\">Errors/Blockers</option>\n                    <option value=\"warnings\">Warnings</option>\n                  </select>\n\n                  <input\n                    value={search}\n                    onChange={(e) => setSearch(e.target.value)}\n                    placeholder=\"Search issues…\"\n                    className=\"w-44 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] dark:border-slate-800 dark:bg-slate-950/60\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"mt-3 overflow-auto rounded-2xl border border-slate-200 dark:border-slate-800\">\n                <table className=\"min-w-full text-xs\">\n                  <thead className=\"sticky top-0 bg-slate-50 text-slate-600 dark:bg-slate-950/80 dark:text-slate-300\">\n                    <tr>\n                      <th className=\"px-3 py-2 text-left font-semibold\">Severity</th>\n                      <th className=\"px-3 py-2 text-left font-semibold\">Rule</th>\n                      <th className=\"px-3 py-2 text-left font-semibold\">Message</th>\n                      <th className=\"px-3 py-2 text-left font-semibold\">Location</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-slate-900/30\">\n                    {filteredIssues.length ? (\n                      filteredIssues.map((i, idx) => {\n                        const sev = String(i?.severity ?? i?.level ?? \"info\");\n                        return (\n                          <tr\n                            key={idx}\n                            className=\"border-t border-slate-200 hover:bg-slate-50/60 dark:border-slate-800 dark:hover:bg-slate-950/40\"\n                          >\n                            <td className=\"px-3 py-2\">\n                              <span\n                                className={cx(\n                                  \"inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]\",\n                                  badgeClassForSeverity(sev)\n                                )}\n                              >\n                                {sev}\n                              </span>\n                            </td>\n                            <td className=\"px-3 py-2 font-mono text-[11px] text-slate-700 dark:text-slate-200\">\n                              {String(i?.rule ?? i?.key ?? \"—\")}\n                            </td>\n                            <td className=\"px-3 py-2 text-slate-700 dark:text-slate-200\">\n                              {String(i?.message ?? i?.detail ?? i?.text ?? \"—\")}\n                            </td>\n                            <td className=\"px-3 py-2 text-slate-500 dark:text-slate-400\">\n                              {String(i?.location ?? i?.path ?? \"—\")}\n                            </td>\n                          </tr>\n                        );\n                      })\n                    ) : (\n                      <tr>\n                        <td className=\"px-3 py-4 text-slate-500 dark:text-slate-400\" colSpan={4}>\n                          No issues found (or run an audit to populate results).\n                        </td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n\n              <div className=\"mt-3 text-[11px] text-slate-500 dark:text-slate-400\">\n                Current v1 audit derives issues from blockers/warnings. Future audit can emit richer issue objects.\n              </div>\n            </div>\n\n            {/* Checks */}\n            <div className=\"rounded-3xl border border-slate-200 bg-white/92 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/55\">\n              <div className=\"flex items-center justify-between gap-3\">\n                <div>\n                  <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Checks</h2>\n                  <p className=\"mt-1 text-[11px] text-slate-500 dark:text-slate-400\">\n                    A per-check view you can trust for “go / no-go”.\n                  </p>\n                </div>\n                <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">\n                  {Array.isArray(audit.checks) ? `${audit.checks.length} checks` : \"—\"}\n                </span>\n              </div>\n\n              <div className=\"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2\">\n                {(audit.checks ?? []).map((c: any, idx: number) => {\n                  const st = String(c?.status ?? \"pass\");\n                  const badge =\n                    st === \"fail\"\n                      ? badgeClassForSeverity(\"error\")\n                      : st === \"warn\"\n                      ? badgeClassForSeverity(\"warning\")\n                      : badgeClassForSeverity(\"ok\");\n\n                  return (\n                    <div\n                      key={`${c?.key ?? idx}`}\n                      className=\"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5 dark:border-slate-800 dark:bg-slate-950/40\"\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"min-w-0\">\n                          <div className=\"truncate font-semibold text-slate-900 dark:text-slate-50\">\n                            {String(c?.label ?? c?.key ?? `Check ${idx + 1}`)}\n                          </div>\n                          {c?.detail ? (\n                            <div className=\"mt-1 text-[11px] text-slate-500 dark:text-slate-400\">\n                              {String(c.detail)}\n                            </div>\n                          ) : null}\n                        </div>\n\n                        <span\n                          className={cx(\n                            \"inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]\",\n                            badge\n                          )}\n                        >\n                          {st}\n                        </span>\n                      </div>\n                    </div>\n                  );\n                })}\n\n                {!(audit.checks ?? []).length ? (\n                  <div className=\"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-4 text-[11px] text-slate-500 dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-400\">\n                    No checks available yet. Run an audit to populate.\n                  </div>\n                ) : null}\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Dev panels (collapsed by default) */}\n        {showDevPanels ? (\n          <section className=\"grid grid-cols-1 gap-4 lg:grid-cols-12\">\n            <div className=\"lg:col-span-6 rounded-3xl border border-slate-200 bg-white/92 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/55\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Normalized payload</h3>\n                <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">Ingestion</span>\n              </div>\n              <pre className=\"mt-3 whitespace-pre-wrap break-words rounded-2xl border border-slate-800 bg-slate-900/95 p-3 text-[11px] text-slate-100 dark:bg-slate-950/70\">\n                {jobData\n                  ? JSON.stringify(jobData.normalized_payload ?? jobData, null, 2)\n                  : \"Run an audit to load ingestion data.\"}\n              </pre>\n            </div>\n\n            <div className=\"lg:col-span-6 rounded-3xl border border-slate-200 bg-white/92 p-4 shadow-sm dark:border-slate-800 dark:bg-slate-950/55\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Raw /api/v1/ingest</h3>\n                {pollingState ? (\n                  <span className=\"text-[11px] text-slate-500 dark:text-slate-400\">{pollingState}</span>\n                ) : null}\n              </div>\n              <pre className=\"mt-3 whitespace-pre-wrap break-words rounded-2xl border border-slate-800 bg-slate-900/95 p-3 text-[11px] text-slate-100 dark:bg-slate-950/70\">\n                {rawIngestResponse ? JSON.stringify(rawIngestResponse, null, 2) : \"Shown when you run from URL.\"}\n              </pre>\n            </div>\n          </section>\n        ) : null}\n      </div>\n\n      <style jsx>{`\n        .audit-title-gradient {\n          background-size: 220% 220%;\n          animation: auditGradientShift 7s ease-in-out infinite;\n          filter: drop-shadow(0 10px 26px rgba(249, 115, 22, 0.18));\n        }\n\n        @keyframes auditGradientShift {\n          0% {\n            background-position: 0% 50%;\n            transform: translateZ(0) scale(1);\n          }\n          50% {\n            background-position: 100% 50%;\n            transform: translateZ(0) scale(1.01);\n          }\n          100% {\n            background-position: 0% 50%;\n            transform: translateZ(0) scale(1);\n          }\n        }\n      `}</style>\n    </main>\n  );\n}\n"],"names":[],"mappings":"qEAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAiDA,IAAM,EAAiB,CAAC,UAAW,MAAO,QAAQ,CAC5C,EAAmB,CAAC,QAAQ,CAElC,SAAS,EAAM,CAAU,EACvB,OAAO,IAAI,QAAQ,AAAC,GAAM,WAAW,EAAG,GAC1C,CA4BA,SAAS,EAAsB,CAAW,EACxC,IAAM,EAAI,CAAC,GAAO,EAAA,CAAE,CAAE,WAAW,SACjC,AAAU,aAAN,GAA0B,YAAN,GAAyB,AAAN,YAAsB,SAAS,CAAf,EAClD,2GAEC,SAAN,GAAsB,YAAN,GAAyB,UAAU,CAAhB,EAC9B,iHAEF,4HACT,CAEA,SAAS,EAAgB,CAAc,EACrC,IAAM,EAAI,CAAC,GAAU,EAAA,CAAE,CAAE,WAAW,SACpC,AAAU,WACR,CADE,EACK,iHACL,AAAM,UACR,GAAO,2GACC,cAAN,GAA2B,aAC7B,CADuB,EAChB,6HAGF,6GACT,CA8FA,SAAS,EAAG,GAAG,CAA+C,EAC5D,OAAO,EAAM,MAAM,CAAC,SAAS,IAAI,CAAC,IACpC,CAEA,SAAS,EAAa,CAAE,OAAK,CAAqB,EAChD,IAAM,EAAI,KAAK,GAAG,CAAC,EAAG,KAAK,GAAG,CAAC,IAAK,IACpC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,oIACV,MAAO,CAEL,WAAY,CAAC,kDAAkD,EAAE,EAAE,yBAAyB,CAAC,AAC/F,EACA,aAAY,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,CAC5B,MAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,WAEvB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kEACf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kHACZ,EAAE,SAIX,CAEe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,eAAA,AAAe,IACxB,EAAS,CAAA,EAAA,EAAA,SAAS,AAAT,IAET,EAAmB,GAAQ,IAAI,gBAAkB,GACjD,EAAW,GAAQ,IAAI,QAAU,GACjC,EAAqB,GAAQ,IAAI,kBAAoB,GAErD,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAO,EAAW,MAAQ,aACpD,CAAC,EAAoB,EAAsB,CAC/C,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAqB,qBAEzB,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAAY,IAC/C,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,GAAoB,IAEvE,CAAC,EAAK,EAAO,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,MACrC,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,GAAsB,IAC3E,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA0B,MAE5E,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAwB,MAG5D,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,MACjE,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE1D,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnD,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgC,OACxE,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/B,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE7C,EAAqB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAC5C,GAAW,GACX,GAAI,CACF,IAAM,EAAM,MAAM,MAAM,CAAC,eAAe,EAAE,mBAAmB,GAAA,CAAK,EAC5D,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAI,EAAE,CACT,MAAM,AAAI,MACR,GAAM,OAAO,SAAW,GAAM,OAAS,CAAC,qBAAqB,EAAE,EAAI,MAAM,CAAA,CAAE,EAG/E,OADA,EAAO,GAAM,MAAQ,GACd,GAAM,MAAQ,CACvB,QAAU,CACR,GAAW,EACb,CACF,EAAG,EAAE,EAEC,EAAwB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAC/C,IAAM,EAAM,MAAM,MAAM,CAAC,qBAAqB,EAAE,mBAAmB,GAAA,CAAQ,EACrE,EAAO,MAAM,EAAI,IAAI,GAAG,KAAK,CAAC,IAAM,MAC1C,GAAI,CAAC,EAAI,EAAE,CACT,MAAM,AAAI,MACR,GAAM,OAAO,SAAW,GAAM,OAAS,CAAC,uBAAuB,EAAE,EAAI,MAAM,CAAA,CAAE,EAEjF,OAAO,CACT,EAAG,EAAE,EAEL,eAAe,EAAa,CAAa,CAAE,EAAY,GAAO,CAAE,EAAa,GAAI,EAC/E,IAAM,EAAQ,KAAK,GAAG,GAEtB,IADA,EAAiB,oBACV,KAAK,GAAG,GAAK,EAAQ,GAAW,CACrC,IAAM,EAAO,MAAM,EAAsB,GACzC,EAAoB,GACpB,IAAM,EAAI,GAAM,KAAK,OACrB,GAAU,cAAN,GAA2B,WAAN,EAAgB,OAAO,CAChD,OAAM,EAAM,EACd,CACA,MAAM,AAAI,MAAM,2CAClB,CAEA,eAAe,EAAiB,CAAa,CAAE,EAAY,IAAO,CAAE,EAAa,GAAI,EACnF,IAAM,EAAQ,KAAK,GAAG,GAGtB,IAFA,EAAgB,CAAC,YAAY,EAAE,EAAA,CAAO,EACtC,EAAiB,0BACV,KAAK,GAAG,GAAK,EAAQ,GAAW,CACrC,IAAM,EAAM,MAAM,MAAM,CAAC,mBAAmB,EAAE,mBAAmB,GAAA,CAAQ,EACzE,GAAmB,MAAf,EAAI,MAAM,CAAU,CACtB,IAAM,EAAI,MAAM,EAAI,IAAI,GAGxB,OAFA,EAAgB,CAAC,uBAAuB,EAAE,EAAE,WAAW,CAAA,CAAE,EACzD,EAAiB,uBACV,CACT,CACA,IAAM,EAAU,KAAK,KAAK,CAAC,CAAC,KAAK,GAAG,GAAK,CAAA,CAAK,CAAI,KAClD,EAAgB,CAAC,WAAW,EAAE,EAAQ,CAAC,CAAC,EACxC,MAAM,EAAM,EACd,CAGA,MAFA,EAAgB,WAChB,EAAiB,MACX,AAAI,MAAM,4CAClB,CAEA,eAAe,GAAgB,CAAW,EACxC,GAAI,CAAC,EAAK,MAAM,AAAI,MAAM,sBAE1B,EAAqB,MACrB,EAAgB,MAChB,EAAiB,wBAEjB,IAAM,EAAM,MAAM,MAAM,iBAAkB,CACxC,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,KACnB,EACA,QAAS,GACT,QAAS,CAAE,YAAY,CAAK,CAC9B,EACF,GAEM,EAAO,MAAM,EAAI,IAAI,GAAG,KAAK,CAAC,IAAM,MAE1C,GADA,EAAqB,CAAE,OAAQ,EAAI,MAAM,CAAE,KAAM,CAAK,GAClD,CAAC,EAAI,EAAE,CAAE,MAAM,AAAI,MAAM,GAAM,OAAO,SAAW,GAAM,OAAS,CAAC,eAAe,EAAE,EAAI,MAAM,CAAA,CAAE,EAElG,IAAM,EACJ,GAAM,aAAe,GAAM,IAAM,GAAM,MAAM,IAAM,GAAM,MAAM,aAAe,KAEhF,GAAI,EAAqB,CACvB,GAAI,GAAM,SAAW,YAA6B,MAAf,EAAI,MAAM,CAAU,CACrD,IAAM,EAAQ,GAAM,OAAS,GAAM,aAAe,EAC5C,EAAa,MAAM,EAAiB,EAAO,KAAS,KAC1D,OAAO,GAAY,aAAe,CACpC,CACA,OAAO,CACT,CAEA,IAAM,EAAQ,GAAM,OAAS,GAAM,KAAK,IAAM,KAC9C,GAAI,CAAC,EAAO,MAAM,AAAI,MAAM,6DAC5B,IAAM,EAAa,MAAM,EAAiB,EAAO,KAAS,KACpD,EAAQ,GAAY,aAAe,GAAY,IAAM,KAC3D,GAAI,CAAC,EAAO,MAAM,AAAI,MAAM,oCAC5B,OAAO,CACT,CAEA,eAAe,GAAc,CAAmB,CAAE,CAAe,EAC/D,EAAiB,qBACjB,IAAM,EAAM,MAAM,MAAM,uBAAwB,CAC9C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,aACnB,EACA,cAAe,cACf,EACA,QAAS,CAAC,CACZ,EACF,GACM,EAAO,MAAM,EAAI,IAAI,GAAG,KAAK,CAAC,IAAM,MAC1C,GAAI,CAAC,EAAI,EAAE,CACT,MAAM,AAAI,MAAM,GAAM,OAAO,SAAW,GAAM,OAAS,CAAC,uBAAuB,EAAE,EAAI,MAAM,CAAA,CAAE,EAC/F,IAAM,EAAQ,OAAO,GAAM,eAAiB,IAC5C,GAAI,CAAC,EAAO,MAAM,AAAI,MAAM,+CAE5B,OADA,EAAiB,GACV,CACT,CAEA,eAAe,KACb,IAAI,GACJ,EAAW,IADE,AAEb,EAAS,MACT,EAAiB,MACjB,EAAoB,MAEpB,GAAI,CACF,IAAM,EAAc,MAAM,GAAgB,GAC1C,EAAoB,GAEpB,EAAO,IAAI,CACT,CAAC,qBAAqB,EAAE,mBAAmB,GAAU,aAAa,EAAE,mBAAmB,GAAA,CAAc,EAGvG,MAAM,EAAmB,GACzB,IAAM,EAAQ,MAAM,GAAc,EAAa,IAAI,EAAe,EAClE,EAAO,IAAI,CACT,CAAC,qBAAqB,EAAE,mBAAmB,GAAU,aAAa,EAAE,mBAClE,GACA,eAAe,EAAE,mBAAmB,GAAA,CAAQ,EAGhD,MAAM,EAAa,EAAO,IAAS,KACnC,MAAM,EAAmB,GAEzB,EAAiB,kBACnB,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,IAC9B,EAAiB,KACnB,QAAU,CACR,GAAW,GACX,EAAgB,KAClB,EACF,CAEA,eAAe,KACb,IAAI,GACJ,GAAW,GADE,AAEb,EAAS,MACT,EAAiB,MACjB,EAAoB,MAEpB,GAAI,CACF,IAAM,EAAK,EAAiB,IAAI,GAChC,GAAI,CAAC,EAAI,MAAM,AAAI,MAAM,+BAEzB,EAAO,IAAI,CAAC,CAAC,6BAA6B,EAAE,mBAAmB,GAAA,CAAK,EAEpE,MAAM,EAAmB,GAEzB,IAAM,EACmB,eAAvB,EAAsC,IAAI,EAAiB,CAAG,IAAI,EAAe,CAE7E,EAAQ,MAAM,GAAc,EAAI,GACtC,EAAO,IAAI,CACT,CAAC,6BAA6B,EAAE,mBAAmB,GAAI,eAAe,EAAE,mBAAmB,GAAA,CAAQ,EAGrG,MAAM,EAAa,EAAO,IAAS,KACnC,MAAM,EAAmB,GAEzB,EAAiB,kBACnB,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,IAC9B,EAAiB,KACnB,QAAU,CACR,GAAW,GACX,EAAgB,KAClB,EACF,CAGA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACH,GACL,CAAC,UACC,GAAI,CAFiB,AAGnB,MAAM,EAAmB,EAC3B,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,GAChC,EACF,CAAC,EAEH,EAAG,CAAC,EAAiB,EAGrB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACH,GACL,CAAC,UACC,GAAI,CACF,EAHqB,EAGf,EAAO,MAAM,EAAsB,GACzC,EAAoB,EACtB,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,GAChC,EACF,CAAC,EAEH,EAAG,CAAC,EAAmB,EAEvB,IAAM,GAAU,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACtB,AAAK,EACA,EADD,CAAM,AACQ,MAAM,KAAc,CAAR,CAAoB,IAAI,CAAC,IAAI,CACtD,GAAa,KAAc,CAAR,CAAoB,IAAI,CACzC,EAHU,KAIhB,CAAC,EAAI,EAEF,GAAmB,IAAS,aAAa,OAAS,KAClD,GAAQ,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,CArX9B,SAAS,AAAe,CAAa,EACnC,IAAM,EAAQ,GAAY,KAC1B,GAAI,CAAC,GAA0B,UAAjB,AAA2B,OAApB,EACnB,MAAO,CACL,GAAI,KACJ,OAAQ,KACR,MAAO,KACP,QAAS,KACT,SAAU,EAAE,CACZ,SAAU,EAAE,CACZ,OAAQ,EAAE,CACV,WAAY,EAAE,CAMd,OAAQ,EAAE,CACV,IAAK,GAAY,KACjB,UAAW,IACb,EAGF,IAAM,EAAQ,AAAuB,iBAAhB,EAAM,KAAK,CAAgB,EAAM,KAAK,CAAG,KAExD,EACJ,AAAwB,iBAAjB,EAAM,MAAM,CACf,EAAM,MAAM,CACW,UAAvB,OAAO,EAAM,KAAK,CAClB,EAAM,KAAK,CACX,KAEA,EACgB,WAApB,OAAO,EAAM,EAAE,CACX,EAAM,EAAE,CACR,EACA,CAAC,SAAU,KAAM,UAAW,YAAY,CAAC,QAAQ,CAAC,EAAO,WAAW,IACpE,KAEA,EAAW,MAAM,OAAO,CAAC,EAAM,QAAQ,EAAI,EAAM,QAAQ,CAAG,EAAE,CAC9D,EAAW,MAAM,OAAO,CAAC,EAAM,QAAQ,EAAI,EAAM,QAAQ,CAAG,EAAE,CAE9D,EAAS,MAAM,OAAO,CAAC,EAAM,MAAM,EACrC,EAAM,MAAM,CACZ,MAAM,OAAO,CAAC,EAAM,QAAQ,EAC5B,EAAM,QAAQ,CACd,EAAE,CAEA,EAAS,MAAM,OAAO,CAAC,EAAM,MAAM,EAAI,EAAM,MAAM,CAAG,EAAE,CAExD,EAAgB,EAAM,UAAU,EAAI,EAAM,cAAc,EAAI,KAC5D,EACJ,MAAM,OAAO,CAAC,GACV,EAAc,GAAG,CAAC,CAAC,EAAQ,KAAiB,CAAD,AACzC,IAAK,OAAO,EAAE,GAAG,EAAI,EAAE,IAAI,EAAI,GAC/B,MAAO,OAAO,EAAE,KAAK,EAAI,EAAE,IAAI,EAAI,EAAE,GAAG,EAAI,CAAC,SAAS,EAAE,EAAM,EAAA,CAAG,EACjE,MAA0B,UAAnB,OAAO,EAAE,KAAK,CAAgB,EAAE,KAAK,CAAG,KAC/C,OAA4B,UAApB,OAAO,EAAE,MAAM,CAAgB,EAAE,MAAM,CAAG,KACpD,CAAC,EACD,EAAE,CAEF,EAAU,AAAyB,iBAAlB,EAAM,OAAO,CAAgB,EAAM,OAAO,CAAG,KAC9D,EACyB,UAA7B,OAAO,EAAM,WAAW,CACpB,EAAM,WAAW,CACU,UAA3B,OAAO,EAAM,SAAS,CACtB,EAAM,SAAS,CACa,UAA5B,OAAO,EAAM,UAAU,CACvB,EAAM,UAAU,CAChB,KAEN,MAAO,IACL,SACA,EACA,QACA,mBACA,WACA,SACA,aACA,SACA,EACA,IAAK,YACL,CACF,CACF,GAiS6C,IAAmB,CAAC,GAAiB,EAE1E,GAAY,GAAkB,KAAK,QAAU,KAE7C,GAAkB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAC9B,IAAM,EAAM,IAAI,IAChB,IAAK,IAAM,KAAK,GAAkB,SAAW,EAAE,CAAE,AAC/C,GAAI,EAAE,UAAU,EAAI,EAAE,WAAW,CAAE,CACjC,IAAM,EAAK,IAAI,KAAK,EAAE,WAAW,EAAE,OAAO,GAAK,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,EACzE,EAAC,OAAO,KAAK,CAAC,IAAO,GAAM,GAAG,EAAI,GAAG,CAAC,EAAE,WAAW,CAAE,EAC3D,CAEF,OAAO,CACT,EAAG,CAAC,EAAiB,EAEf,GAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACvB,IAAM,EAAO,GAAkB,SAAW,EAAE,CAC5C,GAAI,CAAC,EAAK,MAAM,CAAE,OAAO,EACzB,IAAI,EAAO,EACX,IAAK,IAAM,KAAK,EAAU,CAAC,EAAL,UAAkB,SAAU,UAAU,CAAC,QAAQ,CAAC,EAAE,MAAM,GAAG,IACjF,OAAO,KAAK,KAAK,CAAE,EAAO,EAAK,MAAM,CAAI,IAC3C,EAAG,CAAC,EAAiB,EAEf,GAAgB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAC5B,IAAM,EAAgB,EAAE,CACxB,IAAK,IAAM,KAAK,GAAM,QAAQ,EAAI,EAAE,CAClC,AADoC,EAC7B,IAAI,CAAC,CAAE,SAAU,UAAW,KAAM,UAAW,QAAS,EAAG,SAAU,OAAQ,GAEpF,IAAK,IAAM,KAAK,GAAM,QAAQ,EAAI,EAAE,CAAE,AACpC,EAAO,IAAI,CAAC,CAAE,SAAU,UAAW,KAAM,UAAW,QAAS,EAAG,SAAU,OAAQ,GAEpF,IAAK,IAAM,KAAM,GAAM,MAAM,EAAI,EAAE,CAAE,EAAO,IAAI,CAAC,GACjD,OAAO,CACT,EAAG,CAAC,GAAM,QAAQ,CAAE,GAAM,MAAM,CAAE,GAAM,QAAQ,CAAC,EAE3C,GAAiB,CAAA,EAAA,EAAA,OAAO,AAAP,EAAQ,KAC7B,IAAM,EAAO,EAAO,IAAI,GAAG,WAAW,GACtC,OAAO,GAAc,MAAM,CAAC,AAAC,IAC3B,IAAM,EAAM,OAAO,GAAG,UAAY,GAAG,OAAS,IAAI,WAAW,SAC7D,CAAI,AAAgB,eAEhB,CAAC,CACC,EAAI,QAAQ,CAAC,UACb,EAAI,QAAQ,CAAC,SACb,EAAI,QAAQ,CAAC,SACb,EAAI,QAAQ,CAAC,UACb,EAAI,QAAQ,CAAC,OAAA,CACf,AARgB,GAShB,AAT0B,CAaV,aAAhB,IACE,CAAC,CAAC,EAAI,QAAQ,CAAC,SAAW,EAAI,QAAQ,CAAC,SAAA,CADzB,AACkC,GADtB,AACyB,EAEpD,GACO,AACL,CADK,CAHoD,CAErD,AACI,GAAG,IADA,EACQ,GAAG,CAAC,EAAE,GAAG,SAAW,GAAG,CAAC,EAAE,GAAG,UAAY,GAAA,CAAI,CAAC,WAAW,GACxE,QAAQ,CAAC,GACtB,EACF,EAAG,CAAC,GAAe,EAAa,EAAO,EAEjC,GACW,MAAf,GAAM,KAAK,CAAW,QAAU,GAAM,KAAK,EAAI,GAAK,UAAY,GAAM,KAAK,EAAI,GAAK,QAAU,OAW1F,GAAwB,CAAA,EAAA,EAAA,OAAO,AAAP,EAAQ,IAC7B,EACL,YAAa,IAAS,IAAM,GAAoB,KAChD,cAAe,GAAiB,KAChC,MAAO,GAAM,GAAG,EAAI,KACpB,kBAAmB,IAAoB,KACvC,SAAU,GAAoB,KAChC,EACC,CAAC,GAAM,GAAG,CAAE,GAAkB,EAAkB,IAAS,GAAI,EAAe,EAAiB,EAY1F,GAAW,MAAO,IACtB,GAAI,CACF,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC,GACpC,EAAiB,uBACjB,WAAW,IAAM,EAAiB,MAAO,KAC3C,CAAE,KAAM,CAER,CACF,EAIM,GAAc,OAAO,IAAS,IAAM,GAAoB,IACxD,GAAgB,CAAC,GAAM,QAAQ,EAAI,EAAA,AAAE,EAAE,MAAM,CAC7C,GAAgB,CAAC,GAAM,QAAQ,EAAI,EAAA,AAAE,EAAE,MAAM,CAC7C,GAAc,MAAM,OAAO,CAAC,GAAM,MAAM,EAAI,GAAM,MAAM,CAAC,MAAM,CAAG,EAElE,GACJ,GAAW,GAAW,GAAgB,AAAc,eAChD,WACA,EACA,QACA,OAEN,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,wGAEd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,6CAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,mGAEf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,2GAEf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0GAGf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,yOAGf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,2EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0QAInB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,iEAEb,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,0CAAkB,qEACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0OACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,6IACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,2BACA,EAAU,6BAA+B,kBAAA,EAAA,MAGxC,kCAEN,GACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,wCAChB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAS,IAExB,MAAM,4DADI,sGAGT,GAAY,KAAK,CAAC,EAAG,GAAG,UAG3B,KACH,EACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,wCAChB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAS,GAExB,MAAM,8DADI,sGAEX,OACM,EAAc,KAAK,CAAC,EAAG,GAAG,UAGjC,QAGN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,+EACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,kDACf,SAIL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oCACZ,EACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,qMACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,8CACf,KAED,KAEJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,UACP,GAAI,CAEF,GADA,EAAS,MACL,CAAC,EAAe,OACpB,IAAM,EAAO,MAAM,EAAsB,GACzC,EAAoB,GACpB,EAAiB,sBACjB,WAAW,IAAM,EAAiB,MAAO,KAC3C,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,GAChC,CACF,EACA,SAAU,CAAC,GAAiB,EAE5B,MAAM,qEADI,qQAEX,YAID,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,EAAkB,AAAD,GAAO,CAAC,4CAC9B,iPAET,EAAgB,kBAAoB,0BAM3C,CAAA,EAAA,EAAA,GAAA,EAAC,UAAA,0CAAkB,oMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,6DAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,YACb,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,0CAAa,oFAAoF,iCACjE,IAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAEC,MAAO,CACL,gBACE,wGACJ,2CAJU,oDAKX,wCAEM,OAGT,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,sDAAuD,gMAOtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,0KACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,8CAA+C,aAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,oCAAqC,sCAEvD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,0KACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,8CAA+C,mBAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,oCAAqC,gCAEvD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,6KACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,gCAA0C,iCAM9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,wGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,wFAAyF,aAIxG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0HACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SAOL,QAAS,IAAM,EAAQ,0CANZ,EACT,oCACS,QAAT,EACI,sFACA,kFAAA,EAAA,WAGP,aAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SAOL,QAAS,IAAM,EAAQ,gDANZ,EACT,oCACA,AAAS,gBACL,sFACA,kFAAA,EAAA,WAGP,2BAMK,QAAT,EACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,0CAAgB,wFAAyF,6BAG1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,kCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,YAAY,uCAEZ,KAAK,+CADK,mQAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,GACT,SAAU,2CACA,+LAET,EAAU,WAAa,iBAI5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0CACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,gDAAiD,uFAG9D,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SAEL,QAAS,IAAM,EAnOrB,UAmOiC,mEADjB,gIAEX,uBAML,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,0CAAgB,wFAAyF,gBAI1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,kCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAoB,EAAE,MAAM,CAAC,KAAK,EACnD,YAAY,uCAEZ,KAAK,gDADK,mQAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,GACT,SAAU,2CACA,+LAET,EAAU,WAAa,iBAI5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,gFACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,oCAAqC,WACrD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAsB,EAAE,MAAM,CAAC,KAAK,2CAC3C,+GAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,8DAAoB,0BAClC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,uDAAa,qBAI/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SAEL,QAAS,UACP,GAAI,CAEF,GADA,EAAS,MACL,CAAC,EAAiB,IAAI,GAAI,MAAM,AAAI,MAAM,8BAC9C,OAAM,EAAmB,EAAiB,IAAI,IAC9C,EAAiB,mBACnB,CAAE,MAAO,EAAQ,CACf,EAAS,OAAO,GAAG,SAAW,GAChC,CACF,2CAVU,4HAWX,kBAGA,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SAEL,QAAS,IAAM,GAAS,4CADd,4HAEX,YAGC,iBAOb,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,uJACZ,IAED,QAIN,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,eACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,8GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,UACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,uFAAwF,qBAIrG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,qFAvWR,CAwWQ,WAxWtB,GACI,iFACc,UAAd,GACA,yEACc,SAAd,GACA,qEACA,2EAkWkB,EAAA,WAGc,MAAf,GAAM,KAAK,CAAW,IAAM,CAAA,EAAG,GAAM,KAAK,CAAC,MAAM,CAAC,GAGrD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,uEACA,EACE,GAAM,MAAM,IACV,AAAc,IAAb,GAAM,EAAE,CAAY,UAAwB,IAAb,GAAM,EAAE,CAAa,SAAW,SAAA,CAAS,IAAA,EAAA,WAI9E,GAAM,MAAM,IAAI,AAAc,IAAb,GAAM,EAAE,CAAY,UAAwB,IAAb,GAAM,EAAE,CAAa,SAAW,SAAA,CAAS,GAG3F,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,qLACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,+BACf,GAAc,eAGjB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,uMACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,kCAA4C,iBAK/D,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,2LACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,gCACf,GAAc,eAEf,QAGN,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,iDACV,GAAM,OAAO,EAAI,wEAItB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,gCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAO,GAAkB,SAAS,OAAS,GAAW,IACpE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,4DACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,2CAAI,eACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,WACZ,GAAM,SAAS,CAAG,IAAI,KAAK,GAAM,SAAS,EAAE,cAAc,GAAK,eAOxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,OACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,mFACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,2CAAK,sBACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,2CAAM,GAAkB,SAAS,OAAS,CAAA,EAAG,GAAS,CAAC,CAAC,CAAG,SAE9D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,6EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CAAE,MAAO,CAAA,EAAG,GAAS,CAAC,CAAC,AAAC,2CADrB,iEAOf,GAAM,UAAU,EAAE,OACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,wGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0FAA2F,oBAG1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,iDACZ,GAAM,UAAU,CAAC,MAAM,CAAC,oBAG7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,gBACZ,GAAM,UAAU,CAAC,KAAK,CAAC,EAAG,GAAG,GAAG,CAAC,AAAC,IACjC,IAAM,EAAe,MAAX,EAAE,KAAK,CAAW,EAAI,KAAK,GAAG,CAAC,EAAG,KAAK,GAAG,CAAC,IAAK,EAAE,KAAK,GACjE,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAA0B,YACzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,6CAA+C,EAAE,KAAK,GACtE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,8CACb,AAAW,QAAT,KAAK,CAAW,IAAM,CAAA,EAAG,EAAE,KAAK,CAAA,CAAE,MAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CAAE,MAAO,CAAA,EAAG,EAAE,CAAC,CAAE,AAAD,2CADb,gEATN,EAAE,GAAG,CAenB,QAGF,KAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,uJACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,eAAgB,gBAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0CAA0C,mBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,eAAgB,WAAa,IAAE,IAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,eAAgB,YAAc,SAAM,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,eAAgB,UAAY,oCAMpG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IACP,wBA5cE,EA4cW,CAAC,MAAM,CA5cA,CA4cE,IAAS,IAAM,GAAoB,UAAU,KAAK,CAAC,CA3crF,EAAO,IAAI,KAAK,CAAC,KAAK,SAAS,CAAC,AA2cuD,GA3cjD,KAAM,GAAG,CAAE,CAAE,KAAM,kBAAmB,GAC5E,EAAM,IAAI,eAAe,CAAC,QAEhC,CADM,EAAI,SAAS,aAAa,CAAC,MAC/B,IAAI,CAAG,EACT,EAAE,QAAQ,CAAG,EACb,EAAE,KAAK,GACP,IAAI,eAAe,CAAC,8CAucM,0KACX,gBAID,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,EAAoB,AAAC,GAAM,CAAC,4CACjC,6KAET,EAAmB,WAAa,aAGlC,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAS,KAAK,SAAS,CAAC,GAAuB,KAAM,IAEpE,MAAM,kEADI,yKAEX,iBAGC,QAGL,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,uIACZ,KAAK,SAAS,CAAC,GAAuB,KAAM,KAE7C,KAEJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,wFACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,4CAAK,WAAS,IAAe,OAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,2CAAM,EAAe,CAAC,QAAQ,EAAE,EAAA,CAAc,CAAG,GAAY,CAAC,KAAK,EAAE,GAAA,CAAW,CAAG,kBAQ9F,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,0CAAkB,yCAEjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yHACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,4CACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,yDAA0D,kBACxE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,qDAAsD,2EAIrE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,uEACA,EAAgB,IAAa,UAAA,EAAA,WAG9B,IAAa,YAIlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,iBACZ,CAAC,GAAkB,SAAW,EAAA,AAAE,EAC9B,KAAK,GACL,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,YAAY,CAAG,EAAE,YAAY,EAC9C,GAAG,CAAC,AAAC,GACJ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAEW,0MAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,UACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,uBACa,cAAb,EAAE,MAAM,CACJ,iBACa,WAAb,EAAE,MAAM,CACR,cACa,YAAb,EAAE,MAAM,CACR,6BACA,iBAAA,EAAA,IAGR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,2DACZ,EAAE,YAAY,CAAC,KA3hC1C,AA2hC6C,SA3hCpC,AAAY,CAAY,EAC/B,OAAQ,GACN,IAAK,UACH,MAAO,SACT,KAAK,MACH,MAAO,KACT,KAAK,QACH,MAAO,OACT,KAAK,SACH,MAAO,QACT,KAAK,UACH,MAAO,SACT,KAAK,QACH,MAAO,OACT,SACE,OAAO,CACX,CACF,EA0gCyD,EAAE,WAAW,KAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,+EACA,EAAgB,EAAE,MAAM,IAAA,EAAA,WAGzB,EAAE,MAAM,MAIb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0FACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,WAAa,AA/iCrD,SAAS,AAAM,CAAiB,EAC9B,GAAU,MAAN,GAAc,OAAO,KAAK,CAAC,GAAK,MAAO,IAC3C,GAAI,EAAK,IAAM,MAAO,CAAA,EAAG,EAAG,EAAE,CAAC,CAC/B,IAAM,EAAI,KAAK,KAAK,CAAC,EAAK,KAAO,GACjC,MAAO,CAAA,EAAG,EAAE,CAAC,CAAC,AAChB,EA0iC2D,GAAgB,GAAG,CAAC,EAAE,WAAW,GAAK,QACzE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,wCAChB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,0CAAe,WAAW,cACb,IACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,8CACb,EAAE,UAAU,EAAI,SAGpB,EAAE,UAAU,CACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAS,OAAO,EAAE,UAAU,GAE3C,MAAM,2DADI,iNAEX,SAGC,QAGL,EAAE,KAAK,CACN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oDAAoD,UACtC,UAAnB,OAAO,EAAE,KAAK,CAAgB,EAAE,KAAK,CAAG,KAAK,SAAS,CAAC,EAAE,KAAK,KAEtE,SAvDD,CAAA,EAAG,EAAE,YAAY,CAAC,CAAC,EAAE,EAAE,WAAW,CAAA,CAAE,GA4D9C,AAAC,CAAC,GAAkB,SAAW,EAAA,AAAE,EAAE,MAAM,CAItC,KAHF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,mKAAoK,8EAQzL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0BAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,2GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,4CACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,yDAA0D,WACxE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,qDAAsD,6EAKrE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAe,EAAE,MAAM,CAAC,KAAK,2CACpC,+GAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gDAAM,QACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,mDAAS,oBACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,qDAAW,gBAG3B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAU,EAAE,MAAM,CAAC,KAAK,EACzC,YAAY,0DACF,kHAKhB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,8EACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,0CAAgB,qBACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,0CAAgB,kFACf,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,4CACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,mCAAoC,aAClD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,mCAAoC,SAClD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,mCAAoC,YAClD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,mCAAoC,kBAGtD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,0CAAgB,+BACd,GAAe,MAAM,CACpB,GAAe,GAAG,CAAC,CAAC,EAAG,KACrB,IAAM,EAAM,OAAO,GAAG,UAAY,GAAG,OAAS,QAC9C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,0CAEW,kGAEV,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,WACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,uEACA,EAAsB,KAAA,EAAA,WAGvB,MAGL,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,oEACX,OAAO,GAAG,MAAQ,GAAG,KAAO,OAE/B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,8CACX,OAAO,GAAG,SAAW,GAAG,QAAU,GAAG,MAAQ,OAEhD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,8CACX,OAAO,GAAG,UAAY,GAAG,MAAQ,SApB/B,EAwBX,GAEA,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,2CACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAA4D,QAAS,2CAAxD,8CAA2D,oEASnF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,qDAAsD,2GAMvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,2GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,0CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,4CACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,yDAA0D,WACxE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,0CAAY,qDAAsD,wDAIrE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,gDACb,MAAM,OAAO,CAAC,GAAM,MAAM,EAAI,CAAA,EAAG,GAAM,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAG,SAIrE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,6CACZ,CAAC,GAAM,MAAM,EAAI,EAAA,AAAE,EAAE,GAAG,CAAC,CAAC,EAAQ,KACjC,IAAM,EAAK,OAAO,GAAG,QAAU,QACzB,EACJ,AAAO,WACH,EAAsB,SACf,SAAP,EACA,EAAsB,WACtB,EAAsB,MAE5B,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAEW,wGAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,UACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0DACZ,OAAO,GAAG,OAAS,GAAG,KAAO,CAAC,MAAM,EAAE,EAAM,EAAA,CAAG,IAEjD,GAAG,OACF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,qDACZ,OAAO,EAAE,MAAM,IAEhB,QAGN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,oCACY,EACT,uEACA,IAAA,EAAA,WAGD,QArBA,CAAA,EAAG,GAAG,KAAO,EAAA,CAAK,CA0B7B,GAEC,AAAC,CAAC,GAAM,MAAM,EAAI,EAAA,AAAE,EAAE,MAAM,CAIzB,KAHF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,mKAAoK,mEAU5L,EACC,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,0CAAkB,yCACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yHACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,yDAA0D,uBACxE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,gDAAiD,iBAEnE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,8IACZ,GACG,KAAK,SAAS,CAAC,GAAQ,kBAAkB,EAAI,GAAS,KAAM,GAC5D,4CAIR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,yHACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,0CAAa,yDAA0D,uBACvE,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,0CAAe,gDAAkD,IAChE,QAEN,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,8IACZ,EAAoB,KAAK,SAAS,CAAC,EAAmB,KAAM,GAAK,uCAItE,0bA2BZ"}