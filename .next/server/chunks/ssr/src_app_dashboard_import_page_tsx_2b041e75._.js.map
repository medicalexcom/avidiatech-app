{"version":3,"sources":["../../../../src/app/dashboard/import/page.tsx","../../../../src/components/integrations/ConnectorManager.tsx","../../../../src/components/pipeline/ModuleLogsModal.tsx","../../../../src/components/pipeline/RecentRuns.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport ImportUploader from \"@/components/imports/ImportUploader\";\nimport ConnectorManager from \"@/components/integrations/ConnectorManager\";\nimport ModuleLogsModal from \"@/components/pipeline/ModuleLogsModal\";\nimport RecentRuns from \"@/components/pipeline/RecentRuns\";\n\n/**\n * Improved Import dashboard page — full replacement\n *\n * What I changed / improved:\n * - Connector manager is open by default and connector cards are selectable (click a connector to select it).\n * - Selected connector shows a clear connection banner with health (Connected / Failed) and last error details.\n * - \"Allow overwrite existing SKU\" and \"Auto-run pipeline after upload\" appear in a single controls area.\n * - Run Import button sits on the same line and avoids wrapping at typical widths (whitespace-nowrap).\n * - Added \"Download failed rows\" action that calls GET /api/v1/imports/:id/errors?format=csv.\n * - Mapping modal, module logs modal, recent runs, import artifact export are integrated (requires companion components and routes you've added).\n * - Org is derived from GET /api/v1/me (DEV_ORG_ID can be used in dev). Connectors listing uses that org id.\n *\n * Requirements:\n * - Companion components and server routes must be present:\n *   - /api/v1/me, /api/v1/integrations*, /api/imports, /api/v1/imports/:id/errors, /api/v1/pipeline/run, /api/v1/ingest/:id, /api/v1/pipeline/run/:id, /api/v1/pipeline/run/:id/output/:moduleIndex, etc.\n * - If you want real auth, wire Clerk in /api/v1/me and other server routes.\n */\n\ntype AnyObj = Record<string, any>;\ntype PipelineRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\";\ntype ModuleRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\" | \"skipped\";\n\ntype PipelineModule = {\n  id?: string;\n  module_index: number;\n  module_name: string;\n  status: ModuleRunStatus;\n  started_at?: string | null;\n  finished_at?: string | null;\n  output_ref?: string | null;\n  error?: any;\n};\n\ntype PipelineSnapshot = {\n  run?: { id: string; status: PipelineRunStatus; created_at?: string; started_at?: string; finished_at?: string } & AnyObj;\n  modules?: PipelineModule[];\n};\n\ntype ImportMode = \"full\" | \"import_only\";\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\nfunction fmtMs(ms: number | null) {\n  if (ms == null || Number.isNaN(ms)) return \"—\";\n  if (ms < 1000) return `${ms}ms`;\n  const s = Math.round(ms / 100) / 10;\n  return `${s}s`;\n}\nfunction statusChipClass(status?: string | null) {\n  const s = (status || \"\").toLowerCase();\n  if (s === \"running\") return \"bg-amber-100 text-amber-800 border-amber-200\";\n  if (s === \"failed\") return \"bg-rose-100 text-rose-800 border-rose-200\";\n  if (s === \"succeeded\" || s === \"completed\") return \"bg-emerald-100 text-emerald-800 border-emerald-200\";\n  if (s === \"skipped\") return \"bg-slate-100 text-slate-700 border-slate-200\";\n  return \"bg-slate-100 text-slate-700 border-slate-200\";\n}\nfunction downloadJson(filename: string, data: any) {\n  const blob = new Blob([JSON.stringify(data, null, 2)], { type: \"application/json\" });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  a.download = filename;\n  a.click();\n  URL.revokeObjectURL(url);\n}\nasync function downloadFailedRowsCsv(jobId: string) {\n  if (!jobId) {\n    alert(\"No job id\");\n    return;\n  }\n  try {\n    const res = await fetch(`/api/v1/imports/${encodeURIComponent(jobId)}/errors?format=csv`);\n    if (!res.ok) {\n      const j = await res.json().catch(() => null);\n      alert(j?.error ?? \"Failed to download failed rows\");\n      return;\n    }\n    const blob = await res.blob();\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `failed-rows-${jobId}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n  } catch (err: any) {\n    alert(String(err?.message ?? err));\n  }\n}\n\nexport default function ImportPage() {\n  const params = useSearchParams();\n  const router = useRouter();\n\n  const ingestionIdParam = params?.get(\"ingestionId\") || \"\";\n  const pipelineRunIdParam = params?.get(\"pipelineRunId\") || \"\";\n\n  // org + connectors\n  const [orgId, setOrgId] = useState<string>(\"\");\n  const [connectors, setConnectors] = useState<any[]>([]);\n  const [selectedConnector, setSelectedConnector] = useState<string>(\"\");\n\n  // modals\n  const [moduleLogsOpen, setModuleLogsOpen] = useState(false);\n  const [moduleLogsParams, setModuleLogsParams] = useState<{ runId: string; index: number } | null>(null);\n\n  // pipeline / import\n  const [ingestionIdInput, setIngestionIdInput] = useState(ingestionIdParam || \"\");\n  const [importMode, setImportMode] = useState<ImportMode>(\"full\");\n  const [allowOverwriteExisting, setAllowOverwriteExisting] = useState(false);\n  const [autoRunAfterUpload, setAutoRunAfterUpload] = useState(false);\n\n  const [job, setJob] = useState<any | null>(null);\n  const [pipelineRunId, setPipelineRunId] = useState<string>(pipelineRunIdParam || \"\");\n  const [pipelineSnapshot, setPipelineSnapshot] = useState<PipelineSnapshot | null>(null);\n  const [importArtifact, setImportArtifact] = useState<any | null>(null);\n\n  const [running, setRunning] = useState(false);\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // derived\n  const selectedConnectorObj = useMemo(() => connectors.find((c) => c.id === selectedConnector) ?? null, [connectors, selectedConnector]);\n\n  // fetch org id (calls /api/v1/me). In dev set DEV_ORG_ID env var or implement Clerk on server.\n  async function fetchOrg() {\n    try {\n      const res = await fetch(\"/api/v1/me\");\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok && json.org_id) {\n        setOrgId(json.org_id);\n        return json.org_id;\n      }\n      setOrgId(\"\");\n      return \"\";\n    } catch {\n      setOrgId(\"\");\n      return \"\";\n    }\n  }\n\n  async function loadConnectors() {\n    if (!orgId) {\n      setConnectors([]);\n      return;\n    }\n    try {\n      const res = await fetch(`/api/v1/integrations?orgId=${encodeURIComponent(orgId)}`);\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok) setConnectors(json.integrations ?? []);\n      else setConnectors([]);\n    } catch {\n      setConnectors([]);\n    }\n  }\n\n  // select connector by clicking its card\n  function selectConnectorId(id: string) {\n    setSelectedConnector(id);\n  }\n\n  // connector actions\n  async function testConnector(connectorId: string) {\n    try {\n      const res = await fetch(`/api/v1/integrations/${encodeURIComponent(connectorId)}/test`, { method: \"POST\" });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        alert(`Test failed: ${json?.error ?? \"unknown\"}`);\n        return;\n      }\n      alert(\"Connection test succeeded\");\n      await loadConnectors();\n    } catch (err: any) {\n      alert(String(err?.message ?? err));\n    }\n  }\n\n  async function syncConnector(connectorId: string) {\n    if (!orgId) return alert(\"Org ID missing — set DEV_ORG_ID or wire session.\");\n    try {\n      const res = await fetch(`/api/v1/integrations/${encodeURIComponent(connectorId)}/sync`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ org_id: orgId }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        alert(json?.error ?? \"Sync failed\");\n        return;\n      }\n      const jobId = json.jobId ?? json.id ?? \"\";\n      setIngestionIdInput(jobId);\n      setStatusMessage(`Connector sync started: ${jobId}`);\n      if (jobId) await fetchIngestion(jobId);\n      await loadConnectors();\n    } catch (err: any) {\n      alert(String(err?.message ?? err));\n    }\n  }\n\n  // ingestion & pipeline helpers\n  async function fetchIngestion(id: string) {\n    try {\n      setJob(null);\n      const res = await fetch(`/api/v1/ingest/${encodeURIComponent(id)}`);\n      const json = await res.json().catch(() => null);\n      if (!res.ok) throw new Error(json?.error?.message || json?.error || `Ingest fetch failed: ${res.status}`);\n      const row = json?.data ?? json;\n      setJob(row);\n      return row;\n    } catch (err) {\n      setJob(null);\n      throw err;\n    }\n  }\n\n  async function fetchPipelineSnapshot(runId: string) {\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline fetch failed: ${res.status}`);\n    return json as PipelineSnapshot;\n  }\n\n  async function pollPipeline(runId: string, timeoutMs = 300_000, intervalMs = 2000) {\n    const start = Date.now();\n    while (Date.now() - start < timeoutMs) {\n      const snap = await fetchPipelineSnapshot(runId);\n      setPipelineSnapshot(snap);\n      const s = snap?.run?.status;\n      if (s === \"succeeded\" || s === \"failed\") return snap;\n      await sleep(intervalMs);\n    }\n    throw new Error(\"Pipeline did not complete within timeout\");\n  }\n\n  async function fetchImportArtifact(runId: string, modules?: PipelineModule[]) {\n    const importMod = (modules ?? []).find((m) => m.module_name === \"import\");\n    if (!importMod) return null;\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}/output/${importMod.module_index}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Import artifact fetch failed: ${res.status}`);\n    setImportArtifact(json);\n    return json;\n  }\n\n  // run pipeline\n  async function runImport(forIngestionId?: string) {\n    if (running) return;\n    setError(null);\n    setStatusMessage(null);\n    setPipelineSnapshot(null);\n    setImportArtifact(null);\n\n    const id = (forIngestionId ?? ingestionIdInput).trim();\n    if (!id) {\n      setError(\"Enter an ingestionId first.\");\n      return;\n    }\n\n    setRunning(true);\n    try {\n      setStatusMessage(\"Loading ingestion\");\n      await fetchIngestion(id);\n\n      const steps = importMode === \"import_only\" ? [\"import\"] : [\"extract\", \"seo\", \"audit\", \"import\"];\n\n      setStatusMessage(\"Starting pipeline run\");\n      const res = await fetch(\"/api/v1/pipeline/run\", {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({\n          ingestionId: id,\n          triggerModule: \"import\",\n          steps,\n          options: {\n            import: {\n              allowOverwriteExisting,\n            },\n          },\n        }),\n      });\n\n      const json = await res.json().catch(() => null);\n      if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline start failed: ${res.status}`);\n\n      const runId = String(json?.pipelineRunId ?? \"\");\n      if (!runId) throw new Error(\"Pipeline start did not return pipelineRunId\");\n\n      setPipelineRunId(runId);\n      router.push(`/dashboard/import?ingestionId=${encodeURIComponent(id)}&pipelineRunId=${encodeURIComponent(runId)}`);\n\n      setStatusMessage(\"Pipeline running\");\n      const snap = await pollPipeline(runId, 300_000, 2000);\n\n      setStatusMessage(\"Refreshing ingestion\");\n      await fetchIngestion(id);\n\n      setStatusMessage(\"Loading import artifact\");\n      await fetchImportArtifact(runId, snap?.modules ?? []);\n\n      setStatusMessage(\"Import run completed\");\n    } catch (e: any) {\n      setError(String(e?.message || e));\n      setStatusMessage(null);\n    } finally {\n      setRunning(false);\n    }\n  }\n\n  // module logs modal\n  function openModuleLogs(index: number) {\n    if (!pipelineRunId) return alert(\"No pipeline run selected\");\n    setModuleLogsParams({ runId: pipelineRunId, index });\n    setModuleLogsOpen(true);\n  }\n\n  // initial load\n  useEffect(() => {\n    (async () => {\n      const o = await fetchOrg();\n      if (o) await loadConnectors();\n      if (ingestionIdParam) {\n        fetchIngestion(ingestionIdParam).catch((e) => setError(String((e as any)?.message || e)));\n      }\n      if (pipelineRunIdParam) {\n        try {\n          const snap = await fetchPipelineSnapshot(pipelineRunIdParam);\n          setPipelineSnapshot(snap);\n          setPipelineRunId(pipelineRunIdParam);\n          await fetchImportArtifact(pipelineRunIdParam, snap?.modules ?? []);\n        } catch (e: any) {\n          setError(String(e?.message || e));\n        }\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // job data / diagnostics\n  const jobData = useMemo(() => {\n    if (!job) return null;\n    if ((job as any)?.data?.data) return (job as any).data.data;\n    if ((job as any)?.data) return (job as any).data;\n    return job;\n  }, [job]);\n\n  const auditDiag = jobData?.diagnostics?.audit ?? null;\n  const auditStatus = typeof auditDiag?.status === \"string\" ? auditDiag.status : null;\n  const auditScore = typeof auditDiag?.score === \"number\" ? auditDiag.score : null;\n\n  const importDiag = jobData?.diagnostics?.import ?? null;\n  const importResult = importDiag?.result ?? null;\n\n  const runStatus = pipelineSnapshot?.run?.status ?? null;\n\n  const moduleRuntime = useMemo(() => {\n    const map = new Map<string, number>();\n    for (const m of pipelineSnapshot?.modules ?? []) {\n      if (m.started_at && m.finished_at) {\n        const ms = new Date(m.finished_at).getTime() - new Date(m.started_at).getTime();\n        if (!Number.isNaN(ms) && ms >= 0) map.set(m.module_name, ms);\n      }\n    }\n    return map;\n  }, [pipelineSnapshot]);\n\n  const progress = useMemo(() => {\n    const mods = pipelineSnapshot?.modules ?? [];\n    if (!mods.length) return 0;\n    const done = mods.filter((m) => [\"succeeded\", \"failed\", \"skipped\"].includes(m.status)).length;\n    return Math.round((done / mods.length) * 100);\n  }, [pipelineSnapshot]);\n\n  const importAction = importResult?.action ?? importArtifact?.output?.import?.result?.action ?? null;\n  const importNeedsReview = Boolean(importResult?.needs_review ?? importArtifact?.output?.import?.result?.needs_review);\n\n  return (\n    <main className=\"min-h-screen bg-slate-50 text-slate-900\">\n      <div className=\"mx-auto max-w-7xl px-4 py-6 space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"inline-flex items-center gap-2 rounded-full border bg-white px-3 py-1 text-xs font-medium\">AvidiaImport</div>\n            <div className=\"text-lg font-semibold\">Import & Connector Workspace</div>\n          </div>\n\n          <div className=\"text-xs text-slate-600\">\n            Status: <span className={`ml-2 px-2 py-0.5 rounded ${statusChipClass(runStatus ?? \"idle\")}`}>{runStatus ?? \"idle\"}</span>\n          </div>\n        </div>\n\n        {/* Layout */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n          {/* LEFT: connectors */}\n          <aside className=\"lg:col-span-4 space-y-4\">\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold\">Connectors</h3>\n                <div className=\"text-xs text-slate-500\">Manage store connections</div>\n              </div>\n\n              <div className=\"mt-3 space-y-3\">\n                {/* Instead of a \"No connectors\" message, show ConnectorManager (create/list) */}\n                <ConnectorManager orgId={orgId} />\n              </div>\n            </div>\n\n            {/* Selected connector summary */}\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <h4 className=\"text-sm font-semibold\">Selected store</h4>\n              {selectedConnectorObj ? (\n                <div className=\"mt-3\">\n                  <div className=\"flex items-start justify-between\">\n                    <div>\n                      <div className=\"font-medium\">{selectedConnectorObj.name ?? selectedConnectorObj.provider}</div>\n                      <div className=\"text-xs text-slate-500\">Provider: {selectedConnectorObj.provider}</div>\n                      <div className=\"text-xs text-slate-400 mt-1\">Last synced: {selectedConnectorObj.last_synced_at ? new Date(selectedConnectorObj.last_synced_at).toLocaleString() : \"—\"}</div>\n                    </div>\n                    <div className=\"flex flex-col items-end gap-2\">\n                      <div className={`px-2 py-0.5 rounded text-xs ${selectedConnectorObj.status === \"ready\" ? \"bg-emerald-100 text-emerald-800\" : selectedConnectorObj.status === \"failed\" ? \"bg-rose-100 text-rose-800\" : \"bg-slate-100 text-slate-700\"}`}>\n                        {selectedConnectorObj.status ?? \"unknown\"}\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <button onClick={() => testConnector(selectedConnectorObj.id)} className=\"text-xs px-2 py-1 border rounded\">Test</button>\n                        <button onClick={() => syncConnector(selectedConnectorObj.id)} className=\"text-xs px-2 py-1 bg-sky-600 text-white rounded\">Sync</button>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"mt-3 text-xs text-slate-600\">\n                    Connection:{\" \"}\n                    {selectedConnectorObj.status === \"ready\" ? (\n                      <span className=\"text-emerald-700\">Connected</span>\n                    ) : selectedConnectorObj.status === \"failed\" ? (\n                      <span className=\"text-rose-700\">Failed — {selectedConnectorObj.last_error ?? \"see details\"}</span>\n                    ) : (\n                      <span>Unknown</span>\n                    )}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-3 text-xs text-slate-500\">No store selected. Click a connector from the manager to select it.</div>\n              )}\n            </div>\n\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <h4 className=\"text-sm font-semibold\">Import guidance</h4>\n              <ul className=\"mt-2 text-xs text-slate-600 space-y-2\">\n                <li><strong>Limits:</strong> server enforces max 5,000 rows and 50 columns.</li>\n                <li><strong>Deduplication:</strong> SKU is recommended for matching existing products.</li>\n                <li><strong>Preview:</strong> you can preview up to 50 rows before upload.</li>\n                <li><strong>Security:</strong> tokens are stored encrypted server-side. Client never sees secret keys.</li>\n              </ul>\n            </div>\n          </aside>\n\n          {/* RIGHT: uploader, run, telemetry */}\n          <section className=\"lg:col-span-8 space-y-4\">\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h3 className=\"text-lg font-semibold\">Upload or Sync</h3>\n                  <p className=\"text-xs text-slate-500\">Upload CSV/XLSX or sync from a connected store to create an import job.</p>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <button onClick={() => {\n                    // open sample CSV download\n                    const headers = [\"sku\", \"title\", \"description\", \"price\", \"inventory\", \"weight\", \"brand\"];\n                    const rows = [[\"SKU-001\",\"Sample product\",\"Desc\",\"19.99\",\"10\",\"0.5\",\"Brand\"]];\n                    const csv = [headers.join(\",\"), ...rows.map(r => r.map(c => `\"${String(c).replace(/\"/g,'\"\"')}\"`).join(\",\"))].join(\"\\n\");\n                    const blob = new Blob([csv], { type: \"text/csv\" }); const url = URL.createObjectURL(blob); const a = document.createElement(\"a\"); a.href = url; a.download = \"import-sample.csv\"; a.click(); URL.revokeObjectURL(url);\n                  }} className=\"text-xs px-2 py-1 border rounded\">Download sample CSV</button>\n                  <a href=\"/imports\" className=\"text-xs px-2 py-1 border rounded\">View import history</a>\n                </div>\n              </div>\n\n              <div className=\"mt-4\">\n                <ImportUploader\n                  bucket=\"imports\"\n                  onCreated={async (jobId) => {\n                    if (jobId) {\n                      setIngestionIdInput(jobId);\n                      setStatusMessage(`Import job created: ${jobId}.`);\n                      if (autoRunAfterUpload) {\n                        await runImport(jobId);\n                      } else {\n                        fetchIngestion(jobId).catch(() => null);\n                      }\n                      await fetchOrg();\n                      await loadConnectors();\n                    } else {\n                      setStatusMessage(\"Import created.\");\n                    }\n                  }}\n                />\n              </div>\n\n              <div className=\"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3\">\n                <div className=\"md:col-span-2\">\n                  <label className=\"text-xs font-medium uppercase text-slate-500\">Ingestion ID / Job</label>\n                  <input value={ingestionIdInput} onChange={(e) => setIngestionIdInput(e.target.value)} className=\"w-full mt-1 rounded border px-3 py-2\" />\n                </div>\n\n                <div className=\"flex items-end gap-2\">\n                  <select value={selectedConnector} onChange={(e) => setSelectedConnector(e.target.value)} className=\"rounded border px-2 py-2 text-sm w-full\">\n                    <option value=\"\">Select connector (optional)</option>\n                    {connectors.map((c) => <option key={c.id} value={c.id}>{c.name ?? c.provider}</option>)}\n                  </select>\n                  <button onClick={() => { if (selectedConnector) syncConnector(selectedConnector); else alert(\"Select a connector\"); }} className=\"px-3 py-2 rounded bg-sky-600 text-white\">Sync</button>\n                </div>\n              </div>\n\n              <div className=\"mt-4 flex items-center gap-4 flex-wrap\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:gap-6\">\n                  <label className=\"inline-flex items-center gap-2 text-sm\">\n                    <input type=\"checkbox\" checked={allowOverwriteExisting} onChange={(e) => setAllowOverwriteExisting(e.target.checked)} />\n                    <span className=\"text-xs\">Allow overwrite existing SKU</span>\n                  </label>\n\n                  <label className=\"inline-flex items-center gap-2 text-sm mt-2 sm:mt-0\">\n                    <input type=\"checkbox\" checked={autoRunAfterUpload} onChange={(e) => setAutoRunAfterUpload(e.target.checked)} />\n                    <span className=\"text-xs\">Auto-run pipeline after upload</span>\n                  </label>\n                </div>\n\n                <div className=\"ml-auto whitespace-nowrap\">\n                  <button onClick={() => runImport()} disabled={running} className=\"px-4 py-2 rounded bg-emerald-500 text-white\">\n                    {running ? \"Running…\" : \"Run Import\"}\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Telemetry & artifact */}\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <div className=\"flex items-center justify-between\">\n                <h4 className=\"text-sm font-semibold\">Live pipeline & artifact</h4>\n                <div className=\"text-xs text-slate-500\">Progress: {progress}%</div>\n              </div>\n\n              <div className=\"mt-3 grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                <div>\n                  <div className=\"text-xs text-slate-500 mb-2\">Pipeline modules</div>\n                  <div className=\"space-y-2\">\n                    {(pipelineSnapshot?.modules ?? []).slice().sort((a, b) => a.module_index - b.module_index).map((m) => (\n                      <div key={`${m.module_index}-${m.module_name}`} className=\"flex items-center justify-between rounded border p-2\">\n                        <div>\n                          <div className=\"font-medium\">{m.module_index}. {String(m.module_name)}</div>\n                          <div className=\"text-xs text-slate-500\">output_ref: <span className=\"font-mono\">{m.output_ref ?? \"—\"}</span></div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className={`inline-flex items-center rounded-full px-2 py-0.5 text-xs ${statusChipClass(m.status)}`}>{m.status}</div>\n                          <div className=\"text-xs mt-1\">{fmtMs(moduleRuntime.get(m.module_name) ?? null)}</div>\n                          <div className=\"mt-2\">\n                            <button onClick={() => openModuleLogs(m.module_index)} className=\"text-xs px-2 py-1 border rounded\">View logs</button>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                    {!(pipelineSnapshot?.modules ?? []).length && <div className=\"text-xs text-slate-500\">No active run selected.</div>}\n                  </div>\n\n                  <div className=\"mt-4\">\n                    <RecentRuns ingestionId={ingestionIdInput} />\n                  </div>\n                </div>\n\n                <div>\n                  <div className=\"text-xs text-slate-500 mb-2\">Import artifact</div>\n                  <pre className=\"max-h-[300px] overflow-auto rounded border bg-slate-900 p-3 text-[11px] text-white\">{importArtifact ? JSON.stringify(importArtifact, null, 2) : \"Run an import to see artifact JSON.\"}</pre>\n\n                  <div className=\"mt-2 flex justify-between items-center\">\n                    <div className=\"text-xs text-slate-500\">Download results</div>\n                    <div className=\"flex gap-2\">\n                      <button onClick={() => downloadJson(`import-result-${jobData?.id ?? ingestionIdInput ?? \"unknown\"}.json`, { ingestionId: jobData?.id ?? ingestionIdInput ?? null, pipelineRunId: pipelineRunId || null, diagnostics_import: importDiag ?? null, import_artifact: importArtifact ?? null })} className=\"text-xs px-2 py-1 bg-slate-900 text-white rounded\">Export JSON</button>\n                      <button onClick={() => downloadFailedRowsCsv(ingestionIdInput)} className=\"text-xs px-2 py-1 border rounded\">Download failed rows</button>\n                      <a href=\"/imports\" className=\"text-xs px-2 py-1 border rounded\">Import history</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Ingestion viewer */}\n            <div className=\"rounded-2xl bg-white p-4 shadow-sm\">\n              <h4 className=\"text-sm font-semibold\">Ingestion (context)</h4>\n              <pre className=\"mt-3 max-h-[340px] overflow-auto rounded border bg-slate-900 p-3 text-[11px] text-white\">\n                {jobData ? JSON.stringify(jobData, null, 2) : \"Load an ingestion to view persisted diagnostics.\"}\n              </pre>\n            </div>\n          </section>\n        </div>\n      </div>\n\n      {/* Module logs modal */}\n      {moduleLogsParams && (\n        <ModuleLogsModal\n          open={moduleLogsOpen}\n          runId={moduleLogsParams.runId}\n          moduleIndex={moduleLogsParams.index}\n          onClose={() => setModuleLogsOpen(false)}\n        />\n      )}\n    </main>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\n/**\n * ConnectorManager (multi-provider)\n * - Supports: bigcommerce (API token + store_hash), wooCommerce (consumer key/secret),\n *   shopify (OAuth flow trigger), magento (API token), generic-api-key.\n *\n * - Expects server endpoints:\n *   GET  /api/v1/integrations?orgId=<org>\n *   POST /api/v1/integrations\n *   POST /api/v1/integrations/:id/sync\n *   GET  /api/v1/integrations/oauth/shopify/start  (server will redirect to Shopify)\n *\n * Replace orgId usage with a session-derived orgId once you add server auth integration.\n */\n\ntype Integration = {\n  id: string;\n  provider: string;\n  name?: string;\n  config?: any;\n  status?: string;\n};\n\nexport default function ConnectorManager({ orgId }: { orgId: string }) {\n  const [list, setList] = useState<Integration[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [provider, setProvider] = useState<string>(\"bigcommerce\");\n  const [name, setName] = useState(\"\");\n  // BigCommerce\n  const [storeHash, setStoreHash] = useState(\"\");\n  const [accessToken, setAccessToken] = useState(\"\");\n  // WooCommerce\n  const [wcKey, setWcKey] = useState(\"\");\n  const [wcSecret, setWcSecret] = useState(\"\");\n  // Magento / generic\n  const [apiToken, setApiToken] = useState(\"\");\n  const [error, setError] = useState<string | null>(null);\n\n  async function fetchList() {\n    if (!orgId) return;\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/v1/integrations?orgId=${encodeURIComponent(orgId)}`);\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok) {\n        setList(json.integrations ?? []);\n      } else {\n        setError(json?.error ?? \"Failed to load\");\n      }\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (orgId) fetchList();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [orgId]);\n\n  async function createConnector() {\n    setCreating(true);\n    setError(null);\n    try {\n      let payload: any = { org_id: orgId, provider, name: name || provider, config: {}, secrets: {} };\n\n      if (provider === \"bigcommerce\") {\n        payload.config = { store_hash: storeHash };\n        payload.secrets = { access_token: accessToken };\n      } else if (provider === \"woocommerce\") {\n        payload.config = {};\n        payload.secrets = { consumer_key: wcKey, consumer_secret: wcSecret };\n      } else if (provider === \"magento\") {\n        payload.config = {};\n        payload.secrets = { api_token: apiToken };\n      } else if (provider === \"generic-api-key\") {\n        payload.config = {};\n        payload.secrets = { api_key: apiToken };\n      } else if (provider === \"shopify\") {\n        // start OAuth flow\n        const startUrl = `/api/v1/integrations/oauth/shopify/start?orgId=${encodeURIComponent(orgId)}`;\n        // Server may redirect; try fetching redirect url or navigate directly\n        try {\n          const res = await fetch(startUrl);\n          const json = await res.json().catch(() => null);\n          if (json?.redirectUrl) {\n            window.location.href = json.redirectUrl;\n          } else {\n            // fallback: navigate to route\n            window.location.href = startUrl;\n          }\n        } finally {\n          setCreating(false);\n        }\n        return;\n      }\n\n      const res = await fetch(\"/api/v1/integrations\", {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error ?? \"Create failed\");\n        return;\n      }\n      await fetchList();\n      setName(\"\");\n      setStoreHash(\"\");\n      setAccessToken(\"\");\n      setWcKey(\"\");\n      setWcSecret(\"\");\n      setApiToken(\"\");\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n    } finally {\n      setCreating(false);\n    }\n  }\n\n  async function triggerSync(id: string) {\n    setError(null);\n    try {\n      const res = await fetch(`/api/v1/integrations/${id}/sync`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ org_id: orgId }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error ?? \"Sync failed\");\n        return;\n      }\n      alert(`Sync started: ${json.jobId}`);\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n    }\n  }\n\n  return (\n    <div>\n      <h3 className=\"text-sm font-semibold\">Connectors</h3>\n\n      <div className=\"mt-3 space-y-2\">\n        {loading ? (\n          <div>Loading…</div>\n        ) : (\n          list.map((i) => (\n            <div key={i.id} className=\"rounded border p-2 flex items-center justify-between\">\n              <div>\n                <div className=\"font-medium\">{i.name ?? i.provider}</div>\n                <div className=\"text-xs text-slate-500\">{i.provider} • {i.status ?? \"ready\"}</div>\n              </div>\n              <div className=\"flex gap-2\">\n                <button onClick={() => triggerSync(i.id)} className=\"px-2 py-1 rounded bg-sky-500 text-white text-xs\">Sync now</button>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      <div className=\"mt-4 rounded border p-3\">\n        <div className=\"text-xs text-slate-500 mb-2\">Create connector</div>\n        {error && <div className=\"text-xs text-rose-600 mb-2\">{error}</div>}\n\n        <div className=\"mb-2\">\n          <label className=\"text-xs\">Provider</label>\n          <select value={provider} onChange={(e) => setProvider(e.target.value)} className=\"w-full rounded border px-2 py-1\">\n            <option value=\"bigcommerce\">BigCommerce (API token)</option>\n            <option value=\"shopify\">Shopify (OAuth)</option>\n            <option value=\"woocommerce\">WooCommerce (consumer key/secret)</option>\n            <option value=\"magento\">Magento (API token)</option>\n            <option value=\"generic-api-key\">Generic API Key</option>\n          </select>\n        </div>\n\n        <input placeholder=\"Connection name\" value={name} onChange={(e) => setName(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n\n        {provider === \"bigcommerce\" && (\n          <>\n            <input placeholder=\"Store hash\" value={storeHash} onChange={(e) => setStoreHash(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n            <input placeholder=\"Access token\" value={accessToken} onChange={(e) => setAccessToken(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n          </>\n        )}\n\n        {provider === \"woocommerce\" && (\n          <>\n            <input placeholder=\"Consumer Key\" value={wcKey} onChange={(e) => setWcKey(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n            <input placeholder=\"Consumer Secret\" value={wcSecret} onChange={(e) => setWcSecret(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n          </>\n        )}\n\n        {(provider === \"magento\" || provider === \"generic-api-key\") && (\n          <input placeholder=\"API token / key\" value={apiToken} onChange={(e) => setApiToken(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n        )}\n\n        <div className=\"flex gap-2\">\n          <button onClick={createConnector} disabled={creating} className=\"px-3 py-1 bg-emerald-500 text-white rounded text-sm\">\n            {creating ? \"Creating…\" : provider === \"shopify\" ? \"Start Shopify auth\" : \"Create connector\"}\n          </button>\n          <button onClick={fetchList} className=\"px-3 py-1 bg-slate-50 border rounded text-sm\">Refresh</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\ntype Props = {\n  open: boolean;\n  runId: string;\n  moduleIndex: number;\n  onClose: () => void;\n};\n\nexport default function ModuleLogsModal({ open, runId, moduleIndex, onClose }: Props) {\n  const [logs, setLogs] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!open) return;\n    setLoading(true);\n    setError(null);\n    fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}/module/${moduleIndex}/logs`)\n      .then((r) => r.json())\n      .then((json) => {\n        if (!json?.ok) throw new Error(json?.error ?? \"Failed to load logs\");\n        setLogs(json.logs ?? []);\n      })\n      .catch((e) => setError(String(e?.message ?? e)))\n      .finally(() => setLoading(false));\n  }, [open, runId, moduleIndex]);\n\n  if (!open) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4\">\n      <div className=\"w-full max-w-2xl rounded bg-white p-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-semibold\">Module logs — run {runId.slice(0, 8)}… module {moduleIndex}</h3>\n          <button onClick={onClose} className=\"px-2 py-1\">Close</button>\n        </div>\n\n        <div className=\"mt-3\">\n          {loading && <div>Loading logs…</div>}\n          {error && <div className=\"text-rose-600\">{error}</div>}\n          {!loading && !error && (\n            <pre className=\"max-h-[60vh] overflow-auto rounded border bg-black p-3 text-[12px] text-white\">\n              {logs.length ? logs.map((l, i) => typeof l === \"string\" ? `${i + 1}: ${l}\\n` : JSON.stringify(l, null, 2) + \"\\n\").join(\"\") : \"No logs available.\"}\n            </pre>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\n/**\n * RecentRuns shows last N pipeline runs for a given ingestionId.\n * Calls GET /api/v1/pipeline/runs?ingestionId=<id>\n * The route should return { ok: true, runs: [...] }\n */\n\nexport default function RecentRuns({ ingestionId }: { ingestionId: string }) {\n  const [runs, setRuns] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!ingestionId) return;\n    setLoading(true);\n    fetch(`/api/v1/pipeline/runs?ingestionId=${encodeURIComponent(ingestionId)}`)\n      .then((r) => r.json())\n      .then((json) => {\n        if (!json?.ok) throw new Error(json?.error ?? \"Failed to load\");\n        setRuns(json.runs ?? []);\n      })\n      .catch((e) => setError(String(e?.message ?? e)))\n      .finally(() => setLoading(false));\n  }, [ingestionId]);\n\n  return (\n    <div>\n      <h4 className=\"text-sm font-semibold\">Recent runs</h4>\n      {loading && <div className=\"text-xs\">Loading…</div>}\n      {error && <div className=\"text-xs text-rose-600\">{error}</div>}\n      {!loading && !error && runs.length === 0 && <div className=\"text-xs text-slate-500\">No recent runs</div>}\n      <ul className=\"mt-2 space-y-2 text-xs\">\n        {runs.map((r) => (\n          <li key={r.id} className=\"flex items-center justify-between rounded border p-2\">\n            <div>\n              <div className=\"font-medium\">{r.status} — {new Date(r.created_at).toLocaleString()}</div>\n              <div className=\"text-xs text-slate-500\">Run id: {String(r.id).slice(0, 8)}… duration: {r.duration_ms ? `${Math.round(r.duration_ms / 1000)}s` : \"—\"}</div>\n            </div>\n            <div className=\"flex gap-2\">\n              <a href={`/dashboard/import?ingestionId=${encodeURIComponent(r.ingestion_id)}&pipelineRunId=${encodeURIComponent(r.id)}`} className=\"text-xs px-2 py-1 border rounded\">View</a>\n              <button onClick={() => fetch(`/api/v1/pipeline/run/${encodeURIComponent(r.id)}/retry`, { method: \"POST\" }).then(()=>alert(\"Retry requested\"))} className=\"text-xs px-2 py-1 bg-slate-50 border rounded\">Retry</button>\n            </div>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}