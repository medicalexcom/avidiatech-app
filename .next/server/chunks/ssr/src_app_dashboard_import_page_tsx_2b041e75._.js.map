{"version":3,"sources":["../../../../src/app/dashboard/import/page.tsx","../../../../src/components/imports/ImportUploaderWithPreset.tsx","../../../../src/components/integrations/ConnectorManager.tsx","../../../../src/components/pipeline/ModuleLogsModal.tsx","../../../../src/components/pipeline/RecentRuns.tsx","../../../../src/components/imports/MappingPresetSelector.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport ImportUploaderWithPreset from \"@/components/imports/ImportUploaderWithPreset\";\nimport ConnectorManager from \"@/components/integrations/ConnectorManager\";\nimport ModuleLogsModal from \"@/components/pipeline/ModuleLogsModal\";\nimport RecentRuns from \"@/components/pipeline/RecentRuns\";\nimport { MappingPresetSelector } from \"@/components/imports/MappingPresetSelector\";\nimport ConnectorDetailsDrawer from \"@/components/connectors/ConnectorDetailsDrawer\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\n\n/* Helper types & functions */\ntype AnyObj = Record<string, any>;\ntype PipelineRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\";\ntype ModuleRunStatus = \"queued\" | \"running\" | \"succeeded\" | \"failed\" | \"skipped\";\n\ntype PipelineModule = {\n  id?: string;\n  module_index: number;\n  module_name: string;\n  status: ModuleRunStatus;\n  started_at?: string | null;\n  finished_at?: string | null;\n  output_ref?: string | null;\n  error?: any;\n};\n\ntype PipelineSnapshot = {\n  run?: { id: string; status: PipelineRunStatus; created_at?: string; started_at?: string; finished_at?: string } & AnyObj;\n  modules?: PipelineModule[];\n};\n\ntype ImportMode = \"full\" | \"import_only\";\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\nfunction fmtMs(ms: number | null) {\n  if (ms == null || Number.isNaN(ms)) return \"—\";\n  if (ms < 1000) return `${ms}ms`;\n  const s = Math.round(ms / 100) / 10;\n  return `${s}s`;\n}\nfunction statusChipClass(status?: string | null) {\n  const s = (status || \"\").toLowerCase();\n  if (s === \"running\") return \"bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-950/45 dark:text-amber-100 dark:border-amber-500/40\";\n  if (s === \"failed\") return \"bg-rose-100 text-rose-800 border-rose-200 dark:bg-rose-950/45 dark:text-rose-100 dark:border-rose-500/40\";\n  if (s === \"succeeded\" || s === \"completed\") return \"bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-950/45 dark:text-emerald-100 dark:border-emerald-500/40\";\n  if (s === \"skipped\") return \"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-900/60 dark:text-slate-200 dark:border-slate-700\";\n  return \"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-900/60 dark:text-slate-200 dark:border-slate-700\";\n}\n\nfunction downloadJson(filename: string, data: any) {\n  const blob = new Blob([JSON.stringify(data, null, 2)], { type: \"application/json\" });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  a.download = filename;\n  a.click();\n  URL.revokeObjectURL(url);\n}\n\nasync function downloadFailedRowsCsv(jobId: string, toast: any) {\n  if (!jobId) {\n    toast?.error?.(\"No job id\");\n    return;\n  }\n  try {\n    const res = await fetch(`/api/v1/imports/${encodeURIComponent(jobId)}/errors?format=csv`);\n    if (!res.ok) {\n      const j = await res.json().catch(() => null);\n      toast?.error?.(j?.error ?? \"Failed to download failed rows\");\n      return;\n    }\n    const blob = await res.blob();\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `failed-rows-${jobId}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n    toast?.success?.(\"Downloaded failed rows\");\n  } catch (err: any) {\n    toast?.error?.(String(err?.message ?? err));\n  }\n}\n\n/* Small UI helpers */\nconst Spinner = () => (\n  <svg className=\"animate-spin h-4 w-4 inline-block mr-2 align-middle\" viewBox=\"0 0 24 24\" aria-hidden>\n    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\" />\n  </svg>\n);\n\nfunction SkeletonRow() {\n  return (\n    <div className=\"h-12 rounded-2xl border border-slate-200 bg-slate-50/70 animate-pulse dark:border-slate-800 dark:bg-slate-950/45\" />\n  );\n}\n\n/* Page component */\nexport default function ImportPage() {\n  const params = useSearchParams();\n  const router = useRouter();\n  const toast = useToast();\n\n  const ingestionIdParam = params?.get(\"ingestionId\") || \"\";\n  const pipelineRunIdParam = params?.get(\"pipelineRunId\") || \"\";\n\n  // org + connectors\n  const [orgId, setOrgId] = useState<string>(\"\");\n  const [connectors, setConnectors] = useState<any[]>([]);\n  const [selectedConnector, setSelectedConnector] = useState<string>(\"\");\n\n  // mapping preset — accept object or string\n  const [mappingPreset, setMappingPreset] = useState<any | null>(null);\n\n  // modals\n  const [moduleLogsOpen, setModuleLogsOpen] = useState(false);\n  const [moduleLogsParams, setModuleLogsParams] = useState<{ runId: string; index: number } | null>(null);\n\n  // pipeline / import\n  const [ingestionIdInput, setIngestionIdInput] = useState(ingestionIdParam || \"\");\n  const [importMode, setImportMode] = useState<ImportMode>(\"full\");\n  const [allowOverwriteExisting, setAllowOverwriteExisting] = useState(false);\n  const [autoRunAfterUpload, setAutoRunAfterUpload] = useState(false);\n\n  const [job, setJob] = useState<any | null>(null);\n  const [pipelineRunId, setPipelineRunId] = useState<string>(pipelineRunIdParam || \"\");\n  const [pipelineSnapshot, setPipelineSnapshot] = useState<PipelineSnapshot | null>(null);\n  const [importArtifact, setImportArtifact] = useState<any | null>(null);\n\n  const [running, setRunning] = useState(false);\n  const [statusMessage, setStatusMessage] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // confirm delete import job\n  const [confirmDeleteOpen, setConfirmDeleteOpen] = useState(false);\n  const [toDeleteIngestionId, setToDeleteIngestionId] = useState<string | null>(null);\n\n  // details drawer (separate from selection so \"Details\" doesn't hijack selection state)\n  const [detailsConnectorId, setDetailsConnectorId] = useState<string>(\"\");\n\n  // flatten/normalize ConnectorManager UI without editing that component\n  const connectorShellRef = React.useRef<HTMLDivElement | null>(null);\n\n  function normalizeConnectorManagerUI() {\n    const root = connectorShellRef.current;\n    if (!root) return;\n\n    // Hide duplicated headings by exact text\n    const hide = new Set([\"connectors\", \"create connector\"]);\n    root.querySelectorAll(\"h1,h2,h3,h4,h5,h6,div,span,p,label\").forEach((el) => {\n      const t = (el.textContent || \"\").trim().toLowerCase();\n      if (hide.has(t)) (el as HTMLElement).style.display = \"none\";\n    });\n\n    // Remove nested-card vibe: kill shadows, white panels, borders (but keep inputs/buttons)\n    root.querySelectorAll(\".shadow,.shadow-sm,.shadow-md,.shadow-lg\").forEach((el) => {\n      (el as HTMLElement).style.boxShadow = \"none\";\n    });\n\n    root.querySelectorAll(\".bg-white\").forEach((el) => {\n      const h = el as HTMLElement;\n      const tag = h.tagName;\n      if (tag === \"BUTTON\" || tag === \"INPUT\" || tag === \"SELECT\" || tag === \"TEXTAREA\") return;\n      h.style.background = \"transparent\";\n    });\n\n    root.querySelectorAll(\".border\").forEach((el) => {\n      const h = el as HTMLElement;\n      const tag = h.tagName;\n      if (tag === \"BUTTON\" || tag === \"INPUT\" || tag === \"SELECT\" || tag === \"TEXTAREA\") return;\n      h.style.borderColor = \"transparent\";\n    });\n\n    // Flatten frames around selects (often Provider dropdown wrapper)\n    root.querySelectorAll(\"select\").forEach((sel) => {\n      let p: HTMLElement | null = sel.parentElement as HTMLElement | null;\n      let steps = 0;\n      while (p && p !== root && steps < 8) {\n        const cls = String(p.className || \"\");\n        if (cls.includes(\"border\") && (cls.includes(\"rounded\") || cls.includes(\"shadow\") || cls.includes(\"bg-white\"))) {\n          p.style.border = \"0\";\n          p.style.background = \"transparent\";\n          p.style.boxShadow = \"none\";\n          p.style.padding = \"0\";\n        }\n        p = p.parentElement as HTMLElement | null;\n        steps++;\n      }\n    });\n  }\n\n  useEffect(() => {\n    const t = setTimeout(() => normalizeConnectorManagerUI(), 0);\n    return () => clearTimeout(t);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [orgId, connectors.length, selectedConnector]);\n\n  // derived\n  const selectedConnectorObj = useMemo(\n    () => connectors.find((c) => c.id === selectedConnector) ?? null,\n    [connectors, selectedConnector]\n  );\n\n  // fetch org id (calls /api/v1/me)\n  async function fetchOrg() {\n    try {\n      const res = await fetch(\"/api/v1/me\");\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok && json.org_id) {\n        setOrgId(json.org_id);\n        return json.org_id;\n      }\n      setOrgId(\"\");\n      return \"\";\n    } catch {\n      setOrgId(\"\");\n      return \"\";\n    }\n  }\n\n  async function loadConnectors() {\n    if (!orgId) {\n      setConnectors([]);\n      return;\n    }\n    try {\n      const res = await fetch(`/api/v1/integrations?orgId=${encodeURIComponent(orgId)}`);\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok) setConnectors(json.integrations ?? []);\n      else setConnectors([]);\n    } catch {\n      setConnectors([]);\n    }\n  }\n\n  function selectConnectorId(id: string) {\n    setSelectedConnector(id);\n    toast?.info?.(\"Connector selected\");\n  }\n\n  async function testConnector(connectorId: string) {\n    try {\n      const res = await fetch(`/api/v1/integrations/${encodeURIComponent(connectorId)}/test`, { method: \"POST\" });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        toast.error(`Test failed: ${json?.error ?? \"unknown\"}`);\n        return;\n      }\n      toast.success(\"Connection test succeeded\");\n      await loadConnectors();\n    } catch (err: any) {\n      toast.error(String(err?.message ?? err));\n    }\n  }\n\n  async function syncConnector(connectorId: string) {\n    if (!orgId) {\n      toast.error(\"Org ID missing — set DEV_ORG_ID or wire session.\");\n      return;\n    }\n    try {\n      const res = await fetch(`/api/v1/integrations/${encodeURIComponent(connectorId)}/sync`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ org_id: orgId }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        toast.error(json?.error ?? \"Sync failed\");\n        return;\n      }\n      const jobId = json.jobId ?? json.id ?? \"\";\n      setIngestionIdInput(jobId);\n      toast.success(`Sync started: ${jobId}`);\n      if (jobId) await fetchIngestion(jobId);\n      await loadConnectors();\n    } catch (err: any) {\n      toast.error(String(err?.message ?? err));\n    }\n  }\n\n  async function fetchIngestion(id: string) {\n    try {\n      setJob(null);\n      const res = await fetch(`/api/v1/ingest/${encodeURIComponent(id)}`);\n      const json = await res.json().catch(() => null);\n      if (!res.ok) throw new Error(json?.error?.message || json?.error || `Ingest fetch failed: ${res.status}`);\n      const row = json?.data ?? json;\n      setJob(row);\n      return row;\n    } catch (err) {\n      setJob(null);\n      throw err;\n    }\n  }\n\n  async function fetchPipelineSnapshot(runId: string) {\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline fetch failed: ${res.status}`);\n    return json as PipelineSnapshot;\n  }\n\n  async function pollPipeline(runId: string, timeoutMs = 300_000, intervalMs = 2000) {\n    const start = Date.now();\n    while (Date.now() - start < timeoutMs) {\n      const snap = await fetchPipelineSnapshot(runId);\n      setPipelineSnapshot(snap);\n      const s = snap?.run?.status;\n      if (s === \"succeeded\" || s === \"failed\") return snap;\n      await sleep(intervalMs);\n    }\n    throw new Error(\"Pipeline did not complete within timeout\");\n  }\n\n  async function fetchImportArtifact(runId: string, modules?: PipelineModule[]) {\n    const importMod = (modules ?? []).find((m) => m.module_name === \"import\");\n    if (!importMod) return null;\n    const res = await fetch(`/api/v1/pipeline/run/${encodeURIComponent(runId)}/output/${importMod.module_index}`);\n    const json = await res.json().catch(() => null);\n    if (!res.ok) throw new Error(json?.error?.message || json?.error || `Import artifact fetch failed: ${res.status}`);\n    setImportArtifact(json);\n    return json;\n  }\n\n  async function runImport(forIngestionId?: string) {\n    if (running) return;\n    setError(null);\n    setStatusMessage(null);\n    setPipelineSnapshot(null);\n    setImportArtifact(null);\n\n    const id = (forIngestionId ?? ingestionIdInput).trim();\n    if (!id) {\n      toast.error(\"Enter an ingestionId first.\");\n      return;\n    }\n\n    setRunning(true);\n    try {\n      toast.info(\"Loading ingestion\");\n      await fetchIngestion(id);\n\n      const steps = importMode === \"import_only\" ? [\"import\"] : [\"extract\", \"seo\", \"audit\", \"import\"];\n\n      toast.info(\"Starting pipeline run\");\n      const res = await fetch(\"/api/v1/pipeline/run\", {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({\n          ingestionId: id,\n          triggerModule: \"import\",\n          steps,\n          options: {\n            import: {\n              allowOverwriteExisting,\n              mappingPreset: mappingPreset?.id ?? mappingPreset ?? undefined,\n            },\n          },\n        }),\n      });\n\n      const json = await res.json().catch(() => null);\n      if (!res.ok) throw new Error(json?.error?.message || json?.error || `Pipeline start failed: ${res.status}`);\n\n      const runId = String(json?.pipelineRunId ?? \"\");\n      if (!runId) throw new Error(\"Pipeline start did not return pipelineRunId\");\n\n      setPipelineRunId(runId);\n      router.push(`/dashboard/import?ingestionId=${encodeURIComponent(id)}&pipelineRunId=${encodeURIComponent(runId)}`);\n\n      toast.info(\"Pipeline running\");\n      const snap = await pollPipeline(runId, 300_000, 2000);\n\n      toast.info(\"Refreshing ingestion\");\n      await fetchIngestion(id);\n\n      toast.info(\"Loading import artifact\");\n      await fetchImportArtifact(runId, snap?.modules ?? []);\n\n      toast.success(\"Import run completed\");\n    } catch (e: any) {\n      setError(String(e?.message || e));\n      toast.error(String(e?.message || e));\n    } finally {\n      setRunning(false);\n    }\n  }\n\n  function openModuleLogs(index: number) {\n    if (!pipelineRunId) {\n      toast.error(\"No pipeline run selected\");\n      return;\n    }\n    setModuleLogsParams({ runId: pipelineRunId, index });\n    setModuleLogsOpen(true);\n  }\n\n  useEffect(() => {\n    (async () => {\n      const o = await fetchOrg();\n      if (o) await loadConnectors();\n      if (ingestionIdParam) {\n        fetchIngestion(ingestionIdParam).catch((e) => setError(String((e as any)?.message || e)));\n      }\n      if (pipelineRunIdParam) {\n        try {\n          const snap = await fetchPipelineSnapshot(pipelineRunIdParam);\n          setPipelineSnapshot(snap);\n          setPipelineRunId(pipelineRunIdParam);\n          await fetchImportArtifact(pipelineRunIdParam, snap?.modules ?? []);\n        } catch (e: any) {\n          setError(String(e?.message || e));\n        }\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const jobData = useMemo(() => {\n    if (!job) return null;\n    if ((job as any)?.data?.data) return (job as any).data.data;\n    if ((job as any)?.data) return (job as any).data;\n    return job;\n  }, [job]);\n\n  const importDiag = jobData?.diagnostics?.import ?? null;\n  const runStatus = pipelineSnapshot?.run?.status ?? null;\n\n  const moduleRuntime = useMemo(() => {\n    const map = new Map<string, number>();\n    for (const m of pipelineSnapshot?.modules ?? []) {\n      if (m.started_at && m.finished_at) {\n        const ms = new Date(m.finished_at).getTime() - new Date(m.started_at).getTime();\n        if (!Number.isNaN(ms) && ms >= 0) map.set(m.module_name, ms);\n      }\n    }\n    return map;\n  }, [pipelineSnapshot]);\n\n  const progress = useMemo(() => {\n    const mods = pipelineSnapshot?.modules ?? [];\n    if (!mods.length) return 0;\n    const done = mods.filter((m) => [\"succeeded\", \"failed\", \"skipped\"].includes(m.status)).length;\n    return Math.round((done / mods.length) * 100);\n  }, [pipelineSnapshot]);\n\n  // premium classes\n  const input =\n    \"h-10 w-full rounded-xl border border-slate-300 bg-white/80 px-3 text-sm text-slate-900 placeholder:text-slate-400 \" +\n    \"focus:border-cyan-400 focus:ring-2 focus:ring-cyan-500/25 \" +\n    \"dark:border-slate-700 dark:bg-slate-950/55 dark:text-slate-50 dark:placeholder:text-slate-500\";\n\n  const select =\n    \"h-10 rounded-xl border border-slate-300 bg-white/80 px-3 text-sm text-slate-900 \" +\n    \"focus:border-cyan-400 focus:ring-2 focus:ring-cyan-500/25 \" +\n    \"dark:border-slate-700 dark:bg-slate-950/55 dark:text-slate-50\";\n\n  const btnGhost =\n    \"h-10 inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white/70 px-3 text-sm text-slate-800 shadow-sm hover:bg-white \" +\n    \"dark:border-slate-800 dark:bg-slate-950/50 dark:text-slate-200 dark:hover:bg-slate-950\";\n\n  const btnPrimary =\n    \"h-10 inline-flex items-center justify-center rounded-xl px-4 text-sm font-semibold text-slate-950 shadow-sm transition \" +\n    \"bg-gradient-to-r from-cyan-400 via-sky-400 to-emerald-400 hover:opacity-95 hover:-translate-y-[1px] \" +\n    \"focus:outline-none focus:ring-2 focus:ring-cyan-500/30 disabled:opacity-60 disabled:shadow-none\";\n\n  const btnDark =\n    \"h-10 inline-flex items-center justify-center rounded-xl px-3 text-sm font-semibold text-white shadow-sm transition \" +\n    \"bg-slate-900 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500/30 disabled:opacity-60 \" +\n    \"dark:bg-white dark:text-slate-900 dark:hover:bg-slate-100\";\n\n  return (\n    <main className=\"relative min-h-screen overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50\">\n      {/* plain <style> (no styled-jsx) */}\n      <style>{`\n        .headline-grad {\n          background-size: 220% 220%;\n          animation: gshift 8s ease-in-out infinite;\n        }\n        @keyframes gshift {\n          0% { background-position: 0% 50%; }\n          50% { background-position: 100% 50%; }\n          100% { background-position: 0% 50%; }\n        }\n      `}</style>\n\n      {/* Background */}\n      <div className=\"pointer-events-none absolute inset-0 -z-10\">\n        <div className=\"absolute -top-36 -left-28 h-[28rem] w-[28rem] rounded-full bg-cyan-300/22 blur-3xl dark:bg-cyan-500/14\" />\n        <div className=\"absolute -top-40 right-[-10rem] h-[26rem] w-[26rem] rounded-full bg-fuchsia-300/14 blur-3xl dark:bg-fuchsia-500/10\" />\n        <div className=\"absolute -bottom-52 right-[-12rem] h-[34rem] w-[34rem] rounded-full bg-emerald-300/16 blur-3xl dark:bg-emerald-500/10\" />\n        <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0)_0,_rgba(248,250,252,0.92)_55%,_rgba(248,250,252,1)_100%)] dark:bg-[radial-gradient(circle_at_top,_rgba(15,23,42,0)_0,_rgba(15,23,42,0.92)_55%,_rgba(15,23,42,1)_100%)]\" />\n        <div className=\"absolute inset-0 opacity-[0.035] dark:opacity-[0.07]\">\n          <div className=\"h-full w-full bg-[linear-gradient(to_right,#e5e7eb_1px,transparent_1px),linear-gradient(to_bottom,#e5e7eb_1px,transparent_1px)] bg-[size:46px_46px] dark:bg-[linear-gradient(to_right,#1e293b_1px,transparent_1px),linear-gradient(to_bottom,#1e293b_1px,transparent_1px)]\" />\n        </div>\n      </div>\n\n      <div className=\"mx-auto max-w-7xl space-y-5 px-4 py-6 sm:px-6 lg:px-10 lg:py-8\">\n        {/* Top bar */}\n        <section className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/90 px-3 py-1.5 text-[10px] font-medium uppercase tracking-[0.18em] text-slate-600 shadow-sm dark:border-slate-800 dark:bg-slate-950/70 dark:text-slate-300\">\n              <span className=\"inline-flex h-3 w-3 items-center justify-center rounded-full bg-slate-50 border border-cyan-200 dark:bg-slate-900 dark:border-cyan-400/30\">\n                <span className={cx(\"h-1.5 w-1.5 rounded-full\", running ? \"bg-cyan-400 animate-pulse\" : \"bg-slate-400\")} />\n              </span>\n              Data Intelligence · AvidiaImport\n              {ingestionIdInput ? (\n                <>\n                  <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                  <span className=\"font-mono text-[10px]\">{String(ingestionIdInput).slice(0, 8)}…</span>\n                </>\n              ) : null}\n              {pipelineRunId ? (\n                <>\n                  <span className=\"h-3 w-px bg-slate-300/70 dark:bg-slate-700/70\" />\n                  <span className=\"font-mono text-[10px]\">run:{String(pipelineRunId).slice(0, 8)}…</span>\n                </>\n              ) : null}\n            </div>\n\n            <div className=\"hidden sm:flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400\">\n              <span className=\"h-1.5 w-1.5 rounded-full bg-slate-300 dark:bg-slate-700\" />\n              {runStatus ? `pipeline: ${runStatus}` : \"ready\"}\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <div className=\"text-xs text-slate-600 dark:text-slate-300\">\n              Status:{\" \"}\n              <span className={cx(\"ml-2 inline-flex items-center rounded-full border px-2 py-0.5\", statusChipClass(runStatus ?? \"idle\"))}>\n                {runStatus ?? \"idle\"}\n              </span>\n            </div>\n          </div>\n        </section>\n\n        {/* Primary workspace */}\n        <section className=\"rounded-3xl border border-slate-200 bg-white/92 shadow-[0_18px_45px_rgba(148,163,184,0.22)] backdrop-blur dark:border-slate-800 dark:bg-slate-950/55 dark:shadow-[0_18px_45px_rgba(15,23,42,0.75)]\">\n          <div className=\"grid grid-cols-1 gap-4 p-4 lg:grid-cols-12 lg:gap-5 lg:p-5\">\n            {/* LEFT: Stores & Connectors */}\n            <aside className=\"lg:col-span-4\">\n              <div\n                ref={connectorShellRef}\n                data-connector-shell\n                className=\"rounded-3xl border border-slate-200 bg-gradient-to-b from-white/95 to-slate-50/70 p-4 shadow-[0_18px_45px_rgba(148,163,184,0.18)] dark:border-slate-800 dark:from-slate-950/70 dark:to-slate-950/40\"\n              >\n                <div className=\"flex flex-wrap items-start justify-between gap-3\">\n                  <div className=\"space-y-1\">\n                    <h3 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Stores & Connectors</h3>\n                    <p className=\"text-xs text-slate-600 dark:text-slate-300\">Select a store, test, sync, or open details.</p>\n                  </div>\n\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/70 px-3 py-1 text-[11px] text-slate-600 shadow-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-300\">\n                      <span className={cx(\"h-1.5 w-1.5 rounded-full\", orgId ? \"bg-emerald-400\" : \"bg-slate-300 dark:bg-slate-700\")} />\n                      {orgId ? \"org loaded\" : \"org unknown\"}\n                    </span>\n\n                    <span className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/70 px-3 py-1 text-[11px] text-slate-600 shadow-sm dark:border-slate-800 dark:bg-slate-950/40 dark:text-slate-300\">\n                      <span className=\"font-mono\">{connectors.length}</span> stores\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"mt-4\">\n                  <div className=\"rounded-2xl border border-slate-200/60 bg-white/50 p-3 backdrop-blur dark:border-slate-800/70 dark:bg-slate-950/30\">\n                    <ConnectorManager orgId={orgId} selectedId={selectedConnector} onSelect={selectConnectorId} />\n                  </div>\n\n                  <div className=\"mt-3 flex flex-wrap gap-2 text-[11px] text-slate-600 dark:text-slate-300\">\n                    <span className=\"inline-flex items-center rounded-full border border-slate-200 bg-white/60 px-3 py-1 dark:border-slate-800 dark:bg-slate-950/35\">\n                      SKU recommended for matching\n                    </span>\n                    <span className=\"inline-flex items-center rounded-full border border-slate-200 bg-white/60 px-3 py-1 dark:border-slate-800 dark:bg-slate-950/35\">\n                      Preview up to 50 rows\n                    </span>\n                    <span className=\"inline-flex items-center rounded-full border border-slate-200 bg-white/60 px-3 py-1 dark:border-slate-800 dark:bg-slate-950/35\">\n                      Max 5,000 rows / 50 columns\n                    </span>\n                  </div>\n\n                  <div className=\"mt-4 rounded-2xl border border-slate-200/60 bg-gradient-to-b from-white/70 to-white/40 p-3 dark:border-slate-800/70 dark:from-slate-950/35 dark:to-slate-950/20\">\n                    <div className=\"flex items-center justify-between gap-2\">\n                      <div className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                        Selected store\n                      </div>\n\n                      {selectedConnectorObj ? (\n                        <span className={cx(\"inline-flex items-center rounded-full border px-2 py-0.5 text-[11px]\", statusChipClass(selectedConnectorObj.status))}>\n                          {selectedConnectorObj.status ?? \"unknown\"}\n                        </span>\n                      ) : null}\n                    </div>\n\n                    {selectedConnectorObj ? (\n                      <div className=\"mt-2\">\n                        <div className=\"min-w-0\">\n                          <div className=\"truncate font-semibold text-slate-900 dark:text-slate-50\">\n                            {selectedConnectorObj.name ?? selectedConnectorObj.provider}\n                          </div>\n                          <div className=\"text-xs text-slate-600 dark:text-slate-300\">\n                            Provider: <span className=\"font-medium\">{selectedConnectorObj.provider}</span>\n                          </div>\n                          <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">\n                            Last synced: {selectedConnectorObj.last_synced_at ? new Date(selectedConnectorObj.last_synced_at).toLocaleString() : \"—\"}\n                          </div>\n                        </div>\n\n                        <div className=\"mt-3 grid grid-cols-3 gap-2\">\n                          <button onClick={() => testConnector(selectedConnectorObj.id)} className={cx(btnGhost, \"h-9 px-2 text-xs\")}>\n                            Test\n                          </button>\n                          <button onClick={() => syncConnector(selectedConnectorObj.id)} className={cx(btnPrimary, \"h-9 px-3 text-xs\")}>\n                            Sync\n                          </button>\n                          <button onClick={() => setDetailsConnectorId(selectedConnectorObj.id)} className={cx(btnGhost, \"h-9 px-2 text-xs\")}>\n                            Details\n                          </button>\n                        </div>\n\n                        <div className=\"mt-3 text-xs\">\n                          {selectedConnectorObj.status === \"ready\" ? (\n                            <span className=\"text-emerald-700 dark:text-emerald-200\">Connected</span>\n                          ) : selectedConnectorObj.status === \"failed\" ? (\n                            <span className=\"text-rose-700 dark:text-rose-200\">\n                              Failed — {selectedConnectorObj.last_error ?? \"see details\"}\n                            </span>\n                          ) : (\n                            <span className=\"text-slate-600 dark:text-slate-300\">Not ready</span>\n                          )}\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"mt-2 text-xs text-slate-600 dark:text-slate-300\">Select a store to enable actions.</div>\n                    )}\n                  </div>\n                </div>\n\n                {/* plain <style> scoped via attribute (no styled-jsx) */}\n                <style>{`\n                  [data-connector-shell] .shadow,\n                  [data-connector-shell] .shadow-sm,\n                  [data-connector-shell] .shadow-md,\n                  [data-connector-shell] .shadow-lg { box-shadow: none !important; }\n\n                  [data-connector-shell] .bg-white:not(button):not(input):not(select):not(textarea) {\n                    background: transparent !important;\n                  }\n                  [data-connector-shell] .border:not(button):not(input):not(select):not(textarea) {\n                    border-color: transparent !important;\n                  }\n                `}</style>\n              </div>\n            </aside>\n\n            {/* RIGHT: Upload + Command Bar */}\n            <div className=\"lg:col-span-8 space-y-4\">\n              <div className=\"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between\">\n                <div className=\"space-y-1\">\n                  <h1 className=\"text-xl font-semibold leading-tight text-slate-900 dark:text-slate-50\">\n                    Upload &{\" \"}\n                    <span\n                      className={cx(\n                        \"bg-clip-text text-transparent headline-grad\",\n                        \"bg-[linear-gradient(90deg,rgba(34,211,238,1),rgba(56,189,248,1),rgba(52,211,153,1),rgba(244,114,182,1),rgba(250,204,21,1))]\"\n                      )}\n                    >\n                      Run Import\n                    </span>\n                  </h1>\n                  <p className=\"text-sm text-slate-600 dark:text-slate-300\">\n                    Create an import job (upload or sync), then run your pipeline.\n                  </p>\n                </div>\n\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <button\n                    onClick={() => {\n                      const headers = [\"sku\", \"title\", \"description\", \"price\", \"inventory\", \"weight\", \"brand\"];\n                      const rows = [[\"SKU-001\", \"Sample product\", \"Desc\", \"19.99\", \"10\", \"0.5\", \"Brand\"]];\n                      const csv = [headers.join(\",\"), ...rows.map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\"))].join(\"\\n\");\n                      const blob = new Blob([csv], { type: \"text/csv\" });\n                      const url = URL.createObjectURL(blob);\n                      const a = document.createElement(\"a\");\n                      a.href = url;\n                      a.download = \"import-sample.csv\";\n                      a.click();\n                      URL.revokeObjectURL(url);\n                      toast?.info?.(\"Sample CSV downloaded\");\n                    }}\n                    className={cx(btnGhost, \"h-9 px-3 text-xs\")}\n                  >\n                    Download sample CSV\n                  </button>\n                  <a href=\"/imports\" className={cx(btnGhost, \"h-9 px-3 text-xs\")}>\n                    Import history\n                  </a>\n                </div>\n              </div>\n\n              <div className=\"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 dark:border-slate-800 dark:bg-slate-950/35\">\n                <ImportUploaderWithPreset\n                  bucket=\"imports\"\n                  mappingPreset={mappingPreset}\n                  onCreated={async (jobId: string) => {\n                    if (jobId) {\n                      setIngestionIdInput(jobId);\n                      toast.success(`Import job created: ${jobId}.`);\n                      if (autoRunAfterUpload) {\n                        await runImport(jobId);\n                      } else {\n                        fetchIngestion(jobId).catch(() => null);\n                      }\n                      await fetchOrg();\n                      await loadConnectors();\n                    } else {\n                      toast.info(\"Import created.\");\n                    }\n                  }}\n                />\n              </div>\n\n              <div className=\"rounded-2xl border border-slate-200 bg-white/70 p-3 dark:border-slate-800 dark:bg-slate-950/35\">\n                <div className=\"grid grid-cols-1 gap-3 lg:grid-cols-12 lg:items-end\">\n                  <div className=\"lg:col-span-7\">\n                    <label className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                      Ingestion ID / Job\n                    </label>\n                    <div className=\"mt-1 grid grid-cols-12 gap-2\">\n                      <div className=\"col-span-9\">\n                        <input value={ingestionIdInput} onChange={(e) => setIngestionIdInput(e.target.value)} className={input} />\n                      </div>\n                      <div className=\"col-span-3\">\n                        <button\n                          onClick={() => {\n                            if (!ingestionIdInput) return toast.error(\"No ingestion id to delete\");\n                            setToDeleteIngestionId(ingestionIdInput);\n                            setConfirmDeleteOpen(true);\n                          }}\n                          className={cx(btnGhost, \"w-full\")}\n                          aria-label=\"Delete ingestion job\"\n                        >\n                          Delete\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"lg:col-span-5\">\n                    <label className=\"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500 dark:text-slate-400\">\n                      Optional: Sync from store\n                    </label>\n                    <div className=\"mt-1 grid grid-cols-12 gap-2\">\n                      <div className=\"col-span-8\">\n                        <select value={selectedConnector} onChange={(e) => setSelectedConnector(e.target.value)} className={cx(select, \"w-full\")}>\n                          <option value=\"\">Select connector…</option>\n                          {connectors.map((c) => (\n                            <option key={c.id} value={c.id}>\n                              {c.name ?? c.provider}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      <div className=\"col-span-4\">\n                        <button\n                          onClick={() => {\n                            if (selectedConnector) syncConnector(selectedConnector);\n                            else toast.error(\"Select a connector\");\n                          }}\n                          className={cx(btnPrimary, \"w-full\")}\n                        >\n                          Sync\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"lg:col-span-8\">\n                    <div className=\"flex flex-wrap items-center gap-5 pt-1\">\n                      <label className=\"inline-flex items-center gap-2\">\n                        <input type=\"checkbox\" checked={allowOverwriteExisting} onChange={(e) => setAllowOverwriteExisting(e.target.checked)} />\n                        <span className=\"text-xs text-slate-700 dark:text-slate-200\">Allow overwrite existing SKU</span>\n                      </label>\n\n                      <label className=\"inline-flex items-center gap-2\">\n                        <input type=\"checkbox\" checked={autoRunAfterUpload} onChange={(e) => setAutoRunAfterUpload(e.target.checked)} />\n                        <span className=\"text-xs text-slate-700 dark:text-slate-200\">Auto-run after upload</span>\n                      </label>\n\n                      <div className=\"flex items-center gap-2 flex-wrap\">\n                        <MappingPresetSelector\n                          provider={selectedConnectorObj?.provider}\n                          onSelect={(preset: any) => {\n                            setMappingPreset(preset ?? null);\n                            toast?.info?.(\"Mapping preset selected\");\n                          }}\n                        />\n                        {mappingPreset ? (\n                          <div className=\"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-xs dark:border-slate-800 dark:bg-slate-950/50\">\n                            <span className=\"max-w-[260px] truncate\">\n                              {mappingPreset?.name ?? mappingPreset?.id ?? String(mappingPreset)}\n                            </span>\n                            <button\n                              onClick={() => {\n                                setMappingPreset(null);\n                                toast?.info?.(\"Mapping preset cleared\");\n                              }}\n                              className=\"rounded-full border border-slate-200 bg-white px-2 py-0.5 text-[11px] hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-950/60 dark:hover:bg-slate-950\"\n                            >\n                              Clear\n                            </button>\n                          </div>\n                        ) : null}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"lg:col-span-4\">\n                    <button onClick={() => runImport()} disabled={running} className={cx(btnPrimary, \"w-full\")} aria-label=\"Run import\">\n                      {running ? (\n                        <>\n                          <Spinner />\n                          Running…\n                        </>\n                      ) : (\n                        \"Run Import\"\n                      )}\n                    </button>\n                  </div>\n                </div>\n\n                {error ? (\n                  <div className=\"mt-3 rounded-2xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800 dark:border-rose-500/40 dark:bg-rose-950/30 dark:text-rose-100\">\n                    {error}\n                  </div>\n                ) : null}\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Pipeline + artifact */}\n        <section className=\"rounded-3xl border border-slate-200 bg-white/92 shadow-[0_18px_45px_rgba(148,163,184,0.18)] backdrop-blur dark:border-slate-800 dark:bg-slate-950/55\">\n          <div className=\"p-4 lg:p-5\">\n            <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n              <div>\n                <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Live pipeline</h4>\n                <p className=\"text-xs text-slate-500 dark:text-slate-400\">Progress, module status, logs, and output refs.</p>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <div className=\"text-xs text-slate-500 dark:text-slate-400\">Progress: {progress}%</div>\n                <div className=\"h-2 w-44 overflow-hidden rounded-full bg-slate-200 dark:bg-slate-800\">\n                  <div className=\"h-full rounded-full bg-gradient-to-r from-cyan-400 via-sky-400 to-emerald-400\" style={{ width: `${progress}%` }} />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2\">\n              <div className=\"space-y-2\">\n                <div className=\"text-xs text-slate-500 dark:text-slate-400\">Pipeline modules</div>\n                <div className=\"space-y-2\">\n                  {(pipelineSnapshot?.modules ?? [])\n                    .slice()\n                    .sort((a, b) => a.module_index - b.module_index)\n                    .map((m) => (\n                      <div\n                        key={`${m.module_index}-${m.module_name}`}\n                        className=\"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 dark:border-slate-800 dark:bg-slate-950/35\"\n                      >\n                        <div className=\"min-w-0\">\n                          <div className=\"font-medium truncate\">\n                            {m.module_index}. {String(m.module_name)}\n                          </div>\n                          <div className=\"text-xs text-slate-500 dark:text-slate-400 truncate\">\n                            output_ref: <span className=\"font-mono\">{m.output_ref ?? \"—\"}</span>\n                          </div>\n                        </div>\n                        <div className=\"shrink-0 text-right\">\n                          <div className={cx(\"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\", statusChipClass(m.status))}>\n                            {m.status}\n                          </div>\n                          <div className=\"text-xs mt-1 text-slate-600 dark:text-slate-300\">\n                            {fmtMs(moduleRuntime.get(m.module_name) ?? null)}\n                          </div>\n                          <button onClick={() => openModuleLogs(m.module_index)} className={cx(btnGhost, \"h-9 mt-2 px-2 text-xs\")}>\n                            View logs\n                          </button>\n                        </div>\n                      </div>\n                    ))}\n                  {!(pipelineSnapshot?.modules ?? []).length && (\n                    <>\n                      <div className=\"text-xs text-slate-500 dark:text-slate-400\">No active run selected.</div>\n                      <SkeletonRow />\n                      <SkeletonRow />\n                    </>\n                  )}\n                </div>\n\n                <div className=\"pt-2\">\n                  <RecentRuns ingestionId={ingestionIdInput} pipelineId={pipelineRunId} />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"text-xs text-slate-500 dark:text-slate-400\">Import artifact</div>\n                <pre className=\"max-h-[340px] overflow-auto rounded-2xl border border-slate-800 bg-slate-900/95 p-3 text-[11px] text-slate-100 dark:bg-slate-950/70\">\n                  {importArtifact ? JSON.stringify(importArtifact, null, 2) : \"Run an import to see artifact JSON.\"}\n                </pre>\n\n                <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                  <div className=\"text-xs text-slate-500 dark:text-slate-400\">Download results</div>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    <button\n                      onClick={() =>\n                        downloadJson(`import-result-${jobData?.id ?? ingestionIdInput ?? \"unknown\"}.json`, {\n                          ingestionId: jobData?.id ?? ingestionIdInput ?? null,\n                          pipelineRunId: pipelineRunId || null,\n                          diagnostics_import: importDiag ?? null,\n                          import_artifact: importArtifact ?? null,\n                        })\n                      }\n                      className={cx(btnDark, \"h-9 px-3 text-xs\")}\n                    >\n                      Export JSON\n                    </button>\n                    <button onClick={() => downloadFailedRowsCsv(ingestionIdInput, toast)} className={cx(btnGhost, \"h-9 px-3 text-xs\")}>\n                      Download failed rows\n                    </button>\n                    <a href=\"/imports\" className={cx(btnGhost, \"h-9 px-3 text-xs\")}>\n                      Import history\n                    </a>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Ingestion viewer */}\n        <section className=\"rounded-3xl border border-slate-200 bg-white/92 backdrop-blur dark:border-slate-800 dark:bg-slate-950/55\">\n          <div className=\"p-4 lg:p-5\">\n            <div className=\"flex items-center justify-between\">\n              <h4 className=\"text-sm font-semibold text-slate-900 dark:text-slate-50\">Ingestion (context)</h4>\n              <div className=\"text-xs text-slate-500 dark:text-slate-400\">Persisted diagnostics & raw payload</div>\n            </div>\n            <pre className=\"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-800 bg-slate-900/95 p-3 text-[11px] text-slate-100 dark:bg-slate-950/70\">\n              {jobData ? JSON.stringify(jobData, null, 2) : \"Load an ingestion to view persisted diagnostics.\"}\n            </pre>\n          </div>\n        </section>\n      </div>\n\n      {/* Module logs modal */}\n      {moduleLogsParams && (\n        <ModuleLogsModal\n          open={moduleLogsOpen}\n          runId={moduleLogsParams.runId}\n          moduleIndex={moduleLogsParams.index}\n          onClose={() => setModuleLogsOpen(false)}\n        />\n      )}\n\n      {/* Connector details drawer */}\n      <ConnectorDetailsDrawer\n        integrationId={detailsConnectorId}\n        isOpen={Boolean(detailsConnectorId)}\n        onClose={() => setDetailsConnectorId(\"\")}\n      />\n\n      {/* Confirm delete ingestion */}\n      <ConfirmDialog\n        open={confirmDeleteOpen}\n        onCancel={() => setConfirmDeleteOpen(false)}\n        title=\"Delete import job\"\n        description={`Delete import job ${toDeleteIngestionId}? This cannot be undone.`}\n        onConfirm={async () => {\n          setConfirmDeleteOpen(false);\n          if (!toDeleteIngestionId) return;\n          try {\n            const res = await fetch(`/api/v1/imports/${encodeURIComponent(toDeleteIngestionId)}`, { method: \"DELETE\" });\n            const json = await res.json().catch(() => null);\n            if (!res.ok || !json?.ok) {\n              toast.error(json?.error ?? \"Delete failed\");\n              return;\n            }\n            toast.success(\"Import deleted\");\n            setIngestionIdInput(\"\");\n            setJob(null);\n            setToDeleteIngestionId(null);\n          } catch (err: any) {\n            toast.error(String(err?.message ?? err));\n          }\n        }}\n      />\n    </main>\n  );\n}\n","\"use client\";\n\nimport React from \"react\";\nimport ImportUploader from \"@/components/imports/ImportUploader\";\n\ntype Props = {\n  bucket?: string;\n  mappingPreset?: any | null;\n  onCreated?: (jobId: string) => void;\n};\n\n/**\n * Wraps existing ImportUploader to attach mappingPreset metadata to created import job.\n * After ImportUploader calls onCreated(jobId), this wrapper PATCHes /api/v1/imports/:id\n * with { meta: { mappingPreset } } so the server stores the chosen preset with the job.\n *\n * If your server exposes a different endpoint to attach metadata, change the PATCH URL/body.\n */\nexport default function ImportUploaderWithPreset({ bucket = \"imports\", mappingPreset = null, onCreated }: Props) {\n  return (\n    <ImportUploader\n      bucket={bucket}\n      onCreated={async (jobId: string) => {\n        // let consumer handle first\n        onCreated?.(jobId);\n\n        // attach mapping preset metadata if provided\n        if (!jobId || !mappingPreset) return;\n        try {\n          await fetch(`/api/v1/imports/${encodeURIComponent(jobId)}`, {\n            method: \"PATCH\",\n            headers: { \"content-type\": \"application/json\" },\n            body: JSON.stringify({ meta: { mappingPreset } }),\n          });\n          // optional: you could fetch/import job here and show toast\n        } catch (e) {\n          // non-fatal; user still created import\n          // console.warn(\"Failed to attach mapping preset\", e);\n        }\n      }}\n    />\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { useToast } from \"@/components/ui/toast\";\n\n/**\n * ConnectorManager (multi-provider)\n * - Supports: bigcommerce (API token + store_hash), wooCommerce (consumer key/secret),\n *   shopify (OAuth flow trigger), magento (API token), generic-api-key.\n *\n * - Expects server endpoints:\n *   GET  /api/v1/integrations?orgId=<org>\n *   POST /api/v1/integrations\n *   POST /api/v1/integrations/:id/sync\n *   GET  /api/v1/integrations/oauth/shopify/start  (server will redirect to Shopify)\n *\n * Replace orgId usage with a session-derived orgId once you add server auth integration.\n */\n\ntype Integration = {\n  id: string;\n  provider: string;\n  name?: string;\n  config?: any;\n  status?: string;\n  last_synced_at?: string | null;\n  last_error?: string | null;\n};\n\ntype Props = {\n  orgId: string;\n  selectedId?: string;\n  onSelect?: (id: string) => void;\n};\n\nexport default function ConnectorManager({ orgId, selectedId, onSelect }: Props) {\n  const [list, setList] = useState<Integration[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [provider, setProvider] = useState<string>(\"bigcommerce\");\n  const [name, setName] = useState(\"\");\n  // BigCommerce\n  const [storeHash, setStoreHash] = useState(\"\");\n  const [accessToken, setAccessToken] = useState(\"\");\n  // WooCommerce\n  const [wcKey, setWcKey] = useState(\"\");\n  const [wcSecret, setWcSecret] = useState(\"\");\n  // Magento / generic\n  const [apiToken, setApiToken] = useState(\"\");\n  const [error, setError] = useState<string | null>(null);\n\n  const toast = useToast();\n\n  async function fetchList() {\n    if (!orgId) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await fetch(`/api/v1/integrations?orgId=${encodeURIComponent(orgId)}`);\n      const json = await res.json().catch(() => null);\n      if (res.ok && json?.ok) {\n        setList(json.integrations ?? []);\n      } else {\n        setError(json?.error ?? \"Failed to load\");\n        toast.error(json?.error ?? \"Failed to load connectors\");\n      }\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n      toast.error(String(err?.message ?? err));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (orgId) fetchList();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [orgId]);\n\n  async function createConnector() {\n    setCreating(true);\n    setError(null);\n    try {\n      let payload: any = { org_id: orgId, provider, name: name || provider, config: {}, secrets: {} };\n\n      if (provider === \"bigcommerce\") {\n        payload.config = { store_hash: storeHash };\n        payload.secrets = { access_token: accessToken };\n      } else if (provider === \"woocommerce\") {\n        payload.config = {};\n        payload.secrets = { consumer_key: wcKey, consumer_secret: wcSecret };\n      } else if (provider === \"magento\") {\n        payload.config = {};\n        payload.secrets = { api_token: apiToken };\n      } else if (provider === \"generic-api-key\") {\n        payload.config = {};\n        payload.secrets = { api_key: apiToken };\n      } else if (provider === \"shopify\") {\n        // start OAuth flow\n        const startUrl = `/api/v1/integrations/oauth/shopify/start?orgId=${encodeURIComponent(orgId)}`;\n        try {\n          const res = await fetch(startUrl);\n          const json = await res.json().catch(() => null);\n          if (json?.redirectUrl) {\n            window.location.href = json.redirectUrl;\n          } else {\n            window.location.href = startUrl;\n          }\n        } finally {\n          setCreating(false);\n        }\n        return;\n      }\n\n      const res = await fetch(\"/api/v1/integrations\", {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error ?? \"Create failed\");\n        toast.error(json?.error ?? \"Create failed\");\n        return;\n      }\n      toast.success(\"Connector created\");\n      await fetchList();\n      setName(\"\");\n      setStoreHash(\"\");\n      setAccessToken(\"\");\n      setWcKey(\"\");\n      setWcSecret(\"\");\n      setApiToken(\"\");\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n      toast.error(String(err?.message ?? err));\n    } finally {\n      setCreating(false);\n    }\n  }\n\n  async function triggerSync(id: string) {\n    setError(null);\n    try {\n      const res = await fetch(`/api/v1/integrations/${id}/sync`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ org_id: orgId }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error ?? \"Sync failed\");\n        toast.error(json?.error ?? \"Sync failed\");\n        return;\n      }\n      toast.success(`Sync started: ${json.jobId ?? json.id ?? \"queued\"}`);\n      // Optionally refresh list to reflect new sync timestamps\n      await fetchList();\n    } catch (err: any) {\n      setError(String(err?.message ?? err));\n      toast.error(String(err?.message ?? err));\n    }\n  }\n\n  return (\n    <div>\n      <h3 className=\"text-sm font-semibold\">Connectors</h3>\n\n      <div className=\"mt-3 space-y-2\">\n        {loading ? (\n          <div>Loading…</div>\n        ) : (\n          list.map((i) => {\n            const isSelected = selectedId && selectedId === i.id;\n            return (\n              <div\n                key={i.id}\n                role=\"button\"\n                tabIndex={0}\n                onClick={() => onSelect?.(i.id)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault();\n                    onSelect?.(i.id);\n                  }\n                }}\n                className={`rounded border p-2 flex items-center justify-between cursor-pointer ${\n                  isSelected ? \"ring-2 ring-sky-300 bg-sky-50\" : \"hover:bg-slate-50\"\n                }`}\n              >\n                <div>\n                  <div className=\"font-medium\">{i.name ?? i.provider}</div>\n                  <div className=\"text-xs text-slate-500\">\n                    {i.provider} • {i.status ?? \"ready\"}\n                    {i.last_synced_at ? ` • last: ${new Date(i.last_synced_at).toLocaleString()}` : \"\"}\n                  </div>\n                  {i.last_error && <div className=\"text-xs text-rose-600 mt-1\">Last error: {String(i.last_error)}</div>}\n                </div>\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={(ev) => {\n                      ev.stopPropagation();\n                      triggerSync(i.id);\n                    }}\n                    className=\"px-2 py-1 rounded bg-sky-500 text-white text-xs\"\n                  >\n                    Sync now\n                  </button>\n                </div>\n              </div>\n            );\n          })\n        )}\n      </div>\n\n      <div className=\"mt-4 rounded border p-3\">\n        <div className=\"text-xs text-slate-500 mb-2\">Create connector</div>\n        {error && <div className=\"text-xs text-rose-600 mb-2\">{error}</div>}\n\n        <div className=\"mb-2\">\n          <label className=\"text-xs\">Provider</label>\n          <select value={provider} onChange={(e) => setProvider(e.target.value)} className=\"w-full rounded border px-2 py-1\">\n            <option value=\"bigcommerce\">BigCommerce (API token)</option>\n            <option value=\"shopify\">Shopify (OAuth)</option>\n            <option value=\"woocommerce\">WooCommerce (consumer key/secret)</option>\n            <option value=\"magento\">Magento (API token)</option>\n            <option value=\"generic-api-key\">Generic API Key</option>\n          </select>\n        </div>\n\n        <input placeholder=\"Connection name\" value={name} onChange={(e) => setName(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n\n        {provider === \"bigcommerce\" && (\n          <>\n            <input placeholder=\"Store hash\" value={storeHash} onChange={(e) => setStoreHash(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n            <input placeholder=\"Access token\" value={accessToken} onChange={(e) => setAccessToken(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n          </>\n        )}\n\n        {provider === \"woocommerce\" && (\n          <>\n            <input placeholder=\"Consumer Key\" value={wcKey} onChange={(e) => setWcKey(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n            <input placeholder=\"Consumer Secret\" value={wcSecret} onChange={(e) => setWcSecret(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n          </>\n        )}\n\n        {(provider === \"magento\" || provider === \"generic-api-key\") && (\n          <input placeholder=\"API token / key\" value={apiToken} onChange={(e) => setApiToken(e.target.value)} className=\"w-full mb-2 px-2 py-1 border rounded\" />\n        )}\n\n        <div className=\"flex gap-2\">\n          <button onClick={createConnector} disabled={creating} className=\"px-3 py-1 bg-emerald-500 text-white rounded text-sm\">\n            {creating ? \"Creating…\" : provider === \"shopify\" ? \"Start Shopify auth\" : \"Create connector\"}\n          </button>\n          <button onClick={fetchList} className=\"px-3 py-1 bg-slate-50 border rounded text-sm\">Refresh</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\ntype Props = {\n  open: boolean;\n  runId: string;\n  moduleIndex: number;\n  onClose: () => void;\n};\n\nexport default function ModuleLogsModal({ open, runId, moduleIndex, onClose }: Props) {\n  const [logs, setLogs] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!open) return;\n    if (!runId) {\n      setError(\"pipelineRunId required\");\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    // FIX: ensure runId is included in URL\n    const url = `/api/v1/pipeline/run/${encodeURIComponent(runId)}/module/${encodeURIComponent(\n      String(moduleIndex)\n    )}/logs`;\n\n    fetch(url)\n      .then((r) => r.json())\n      .then((json) => {\n        if (!json?.ok) throw new Error(json?.error ?? \"Failed to load logs\");\n        setLogs(json.logs ?? []);\n      })\n      .catch((e) => setError(String(e?.message ?? e)))\n      .finally(() => setLoading(false));\n  }, [open, runId, moduleIndex]);\n\n  if (!open) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4\">\n      <div className=\"w-full max-w-2xl rounded bg-white p-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-semibold\">\n            Module logs — run {runId ? runId.slice(0, 8) : \"?\"}… module {moduleIndex}\n          </h3>\n          <button onClick={onClose} className=\"px-2 py-1\">\n            Close\n          </button>\n        </div>\n\n        <div className=\"mt-3\">\n          {loading && <div>Loading logs…</div>}\n          {error && <div className=\"text-rose-600\">{error}</div>}\n          {!loading && !error && (\n            <pre className=\"max-h-[60vh] overflow-auto rounded border bg-black p-3 text-[12px] text-white\">\n              {logs.length\n                ? logs\n                    .map((l, i) => (typeof l === \"string\" ? `${i + 1}: ${l}\\n` : JSON.stringify(l, null, 2) + \"\\n\"))\n                    .join(\"\")\n                : \"No logs available.\"}\n            </pre>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\ntype Props = {\n  ingestionId?: string | null;\n  pipelineId?: string | null;\n  limit?: number;\n};\n\n/**\n * RecentRuns\n *\n * Robust UI for showing recent pipeline runs. Defensive against server-side DB schema differences\n * (e.g. missing pipeline_runs.ingestion_id column) which may surface as `db_lookup_failed` or SQL\n * errors from the API. If a filtered fetch by ingestionId fails due to DB lookup errors, this\n * component will retry a safe unfiltered fetch so the page still renders.\n *\n * This component is intentionally lightweight and only depends on the public API:\n * - GET /api/v1/pipeline/runs?ingestionId=...\n * - GET /api/v1/pipeline/runs?pipelineId=...\n * - GET /api/v1/pipeline/runs\n *\n * It handles multiple response shapes: { ok, runs } or directly an array.\n */\nexport default function RecentRuns({ ingestionId, pipelineId, limit = 6 }: Props) {\n  const [runs, setRuns] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [usedFallback, setUsedFallback] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    setError(null);\n    setUsedFallback(false);\n\n    async function fetchRuns() {\n      setLoading(true);\n      setRuns([]);\n      setError(null);\n\n      // Build the initial URL: prefer ingestionId filter, then pipelineId, otherwise no filter\n      const q = ingestionId ? `?ingestionId=${encodeURIComponent(ingestionId)}` : pipelineId ? `?pipelineId=${encodeURIComponent(pipelineId)}` : \"\";\n      const url = `/api/v1/pipeline/runs${q}`;\n\n      try {\n        const res = await fetch(url);\n        const json = await res.json().catch(() => null);\n\n        if (!res.ok) {\n          // Defensive: if server returns an error about missing column (db_lookup_failed or ingestion_id)\n          const msg = String(json?.error ?? json?.message ?? json ?? res.statusText ?? \"\");\n          if (/ingestion_id|db_lookup_failed|column .* does not exist/i.test(msg)) {\n            // Retry without filtering to allow UI to still show runs\n            const fallbackUrl = `/api/v1/pipeline/runs`;\n            const fallbackRes = await fetch(fallbackUrl);\n            const fallbackJson = await fallbackRes.json().catch(() => null);\n            if (!fallbackRes.ok) {\n              const fallbackMsg = String(fallbackJson?.error ?? fallbackJson?.message ?? fallbackRes.statusText ?? \"\");\n              if (mounted) setError(`Failed to load recent runs: ${fallbackMsg}`);\n            } else {\n              const list = Array.isArray(fallbackJson) ? fallbackJson : fallbackJson?.runs ?? fallbackJson?.data ?? [];\n              if (mounted) {\n                setRuns(list.slice(0, limit));\n                setUsedFallback(true);\n              }\n            }\n          } else {\n            if (mounted) setError(`Failed to load recent runs: ${msg}`);\n          }\n        } else {\n          // Success case - normalize array shapes\n          const list = Array.isArray(json) ? json : json?.runs ?? json?.data ?? [];\n          if (mounted) setRuns((list ?? []).slice(0, limit));\n        }\n      } catch (err: any) {\n        if (mounted) setError(String(err?.message ?? err));\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    }\n\n    fetchRuns();\n    return () => {\n      mounted = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ingestionId, pipelineId, limit]);\n\n  if (loading) {\n    return (\n      <div className=\"space-y-2\">\n        {[...Array(Math.min(limit, 3))].map((_, i) => (\n          <div key={i} className=\"h-10 rounded-lg bg-slate-100 animate-pulse\" />\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"rounded-md border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800\">\n        <div className=\"font-medium\">Recent runs unavailable</div>\n        <div className=\"text-xs mt-1\">{error}</div>\n      </div>\n    );\n  }\n\n  if (!runs || runs.length === 0) {\n    return (\n      <div className=\"rounded-md border border-slate-200 bg-slate-50 p-3 text-sm text-slate-700\">\n        <div className=\"font-medium\">No recent runs</div>\n        <div className=\"text-xs mt-1\">No pipeline runs were found yet.</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      {usedFallback ? (\n        <div className=\"text-xs text-slate-500 italic\">Filtered query failed — showing recent runs (unfiltered).</div>\n      ) : null}\n      {runs.map((r: any) => {\n        // Defensive accessors for common run fields\n        const id = r?.id ?? r?.run_id ?? r?.pipeline_run_id ?? \"\";\n        const status = (r?.status ?? r?.state ?? \"unknown\").toString();\n        // ingestion id might be in different places or not present\n        const ingestion = r?.ingestion_id ?? r?.ingestionId ?? (r?.data?.ingestion_id ?? r?.data?.id) ?? null;\n        const created = r?.created_at ?? r?.created ?? r?.ts ?? null;\n\n        return (\n          <div\n            key={id ?? Math.random()}\n            className=\"flex items-center justify-between gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm\"\n          >\n            <div className=\"min-w-0\">\n              <div className=\"truncate font-medium\">\n                {id ? String(id).slice(0, 10) : \"run\"}\n                <span className=\"ml-2 text-xs text-slate-500\">· {status}</span>\n              </div>\n              <div className=\"text-xs text-slate-500\">\n                Ingestion: <span className=\"font-mono\">{ingestion ? String(ingestion) : \"—\"}</span>\n                {created ? <span className=\"ml-3\">Created: {new Date(created).toLocaleString()}</span> : null}\n              </div>\n            </div>\n\n            <div className=\"shrink-0 text-xs text-slate-500\">\n              <a\n                href={`/dashboard/import?ingestionId=${encodeURIComponent(String(ingestion ?? \"\"))}&pipelineRunId=${encodeURIComponent(\n                  String(id ?? \"\")\n                )}`}\n                className=\"text-xs text-slate-600 hover:underline\"\n                onClick={(e) => {\n                  // if ingestion is empty, prevent navigation to avoid blank queries\n                  if (!ingestion) {\n                    e.preventDefault();\n                    return;\n                  }\n                }}\n              >\n                View\n              </a>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\n\ntype Preset = { id: string; name: string; provider: string; mapping: any };\n\nexport function MappingPresetSelector({ provider, onSelect }: { provider?: string; onSelect: (preset: null | Preset) => void }) {\n  const [presets, setPresets] = useState<Preset[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    async function load() {\n      setLoading(true);\n      try {\n        const res = await fetch(\"/api/v1/mapping-presets\");\n        const json = await res.json();\n        if (json.ok) {\n          setPresets((json.presets || []).filter((p: any) => (provider ? p.provider === provider : true)));\n        }\n      } catch (e) {\n        /* ignore */\n      } finally {\n        setLoading(false);\n      }\n    }\n    load();\n  }, [provider]);\n\n  return (\n    <div>\n      <label htmlFor=\"mapping-preset\" className=\"block text-sm font-medium text-gray-700\">Mapping preset</label>\n      <div className=\"mt-1 flex gap-2 items-center\">\n        <select id=\"mapping-preset\" onChange={(e) => {\n          const id = e.target.value;\n          const preset = presets.find(p => p.id === id) ?? null;\n          onSelect(preset);\n        }} className=\"border rounded px-2 py-1\">\n          <option value=\"\">-- Select preset --</option>\n          {presets.map(p => <option key={p.id} value={p.id}>{p.name}</option>)}\n        </select>\n        {loading && <span className=\"text-sm text-gray-500\">Loading...</span>}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}