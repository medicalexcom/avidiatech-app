(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8521,93582,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(73635);function r({open:e,title:a="Confirm",description:r,confirmLabel:n="Confirm",cancelLabel:i="Cancel",onConfirm:l,onCancel:c,onClose:d}){let o=(0,s.useRef)(null),m=(0,s.useRef)(null),x=(0,s.useRef)(null);return((0,s.useEffect)(()=>{if(e)return o.current?.focus(),document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t);function t(e){if("Escape"===e.key)e.preventDefault(),(d??c)?.();else if("Tab"===e.key){let t=o.current?.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!t||0===t.length)return;let s=t[0],a=t[t.length-1];e.shiftKey&&document.activeElement===s?(e.preventDefault(),a.focus()):e.shiftKey||document.activeElement!==a||(e.preventDefault(),s.focus())}}},[e,c,d]),e)?(0,t.jsxs)("div",{role:"dialog","aria-modal":"true","aria-labelledby":"confirm-title",tabIndex:-1,ref:o,className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:()=>(d??c)?.()}),(0,t.jsxs)("div",{className:"bg-white rounded shadow-lg max-w-lg w-full p-6 relative z-10",children:[(0,t.jsx)("h2",{id:"confirm-title",className:"text-lg font-medium",children:a}),r&&(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:r}),(0,t.jsxs)("div",{className:"mt-4 flex justify-end gap-3",children:[(0,t.jsx)("button",{ref:m,onClick:()=>(d??c)?.(),className:"px-3 py-1 rounded bg-gray-100",children:i}),(0,t.jsx)("button",{ref:x,onClick:l,className:"px-3 py-1 rounded bg-red-600 text-white",children:n})]})]})]}):null}e.s(["default",0,({integrationId:e,isOpen:r,onClose:n})=>{let[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[o,m]=(0,s.useState)(null),x=(0,s.useRef)(null),u=(0,a.useToast)();return((0,s.useEffect)(()=>{if(!r||!e)return;let t=!0;return l(!0),m(null),fetch(`/api/v1/integrations/${e}`).then(e=>e.json()).then(e=>{t&&(e.ok?d(e.integration??e):(m(e.error??"Failed to load integration"),d(null)))}).catch(e=>{t&&m(String(e))}).finally(()=>{t&&l(!1)}),()=>{t=!1}},[r,e]),(0,s.useEffect)(()=>{r&&setTimeout(()=>x.current?.focus(),0)},[r]),r)?(0,t.jsxs)("div",{className:"fixed inset-0 z-[60] flex",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:n}),(0,t.jsxs)("aside",{ref:x,tabIndex:-1,className:"ml-auto w-full max-w-lg bg-white dark:bg-slate-900 shadow-xl p-6 overflow-auto","aria-label":"Connector details",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Connector details"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Inspect and run actions for this connector."})]}),(0,t.jsx)("button",{onClick:n,"aria-label":"Close",className:"ml-4 rounded p-1 text-gray-600 hover:text-gray-900",children:"✕"})]}),i?(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Loading…"}):o?(0,t.jsxs)("div",{className:"text-sm text-rose-600",children:["Error: ",o]}):c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Provider: ",(0,t.jsx)("strong",{className:"text-gray-800",children:c.provider??"—"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Name: ",(0,t.jsx)("strong",{className:"text-gray-800",children:c.name??c.id})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Created: ",(0,t.jsx)("strong",{className:"text-gray-800",children:c.created_at??"—"})]})]}),(0,t.jsxs)("section",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Configuration"}),(0,t.jsx)("pre",{className:"text-xs bg-gray-100 dark:bg-slate-800 p-3 rounded max-h-44 overflow-auto",children:JSON.stringify(c.config??{},null,2)})]}),(0,t.jsxs)("section",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Schedule"}),c.schedule?(0,t.jsx)("pre",{className:"text-sm bg-gray-50 dark:bg-slate-800 p-2 rounded",children:JSON.stringify(c.schedule,null,2)}):(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"No schedule configured"})]}),c.last_error&&(0,t.jsxs)("div",{className:"mt-4 text-sm text-rose-600",children:["Last error: ",c.last_error]}),(0,t.jsxs)("div",{className:"mt-6 flex gap-2",children:[(0,t.jsx)("button",{onClick:async()=>{try{if(!c?.id)return;let e=await fetch(`/api/v1/integrations/${c.id}/sync`,{method:"POST"}),t=await e.json().catch(()=>null);if(!e.ok||!t?.ok)return void u.error(t?.error??"Failed to start sync");u.success("Sync queued")}catch(e){u.error(String(e?.message??e))}},className:"px-4 py-2 rounded bg-blue-600 text-white",children:"Sync now"}),(0,t.jsx)("a",{href:`/integrations/${c.id}/edit`,className:"px-4 py-2 rounded border text-sm text-gray-700 hover:bg-gray-50",children:"Edit"})]})]}):(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"No integration selected"})]})]}):null}],8521),e.s(["ConfirmDialog",()=>r],93582)},68387,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(8521),r=e.i(93582),n=e.i(73635);let i=({integration:e,onDeleted:i,onSynced:l})=>{let[c,d]=(0,s.useState)(!1),[o,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(!1),h=(0,n.useToast)();return(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name??e.id}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.provider})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>d(!0),"aria-label":`Open details for ${e.name??e.id}`,className:"px-3 py-1 rounded border text-sm hover:bg-gray-50",children:"Details"}),(0,t.jsx)("button",{onClick:async()=>{u(!0);try{let t=await fetch(`/api/v1/integrations/${e.id}/sync`,{method:"POST"}),s=await t.json();if(!s.ok)throw Error(s.error||"Sync failed");h.success("Sync queued"),l?.(e.id)}catch(e){h.error(String(e?.message??e))}finally{u(!1)}},disabled:x,"aria-label":`Sync now ${e.name??e.id}`,className:"px-3 py-1 rounded bg-blue-600 text-white disabled:opacity-60",children:x?"Syncing…":"Sync"}),(0,t.jsx)("button",{onClick:()=>m(!0),"aria-label":`Delete ${e.name??e.id}`,className:"px-3 py-1 rounded border text-red-600 hover:bg-red-50",children:"Delete"})]}),(0,t.jsx)(a.default,{integrationId:e.id,isOpen:c,onClose:()=>d(!1)}),(0,t.jsx)(r.ConfirmDialog,{open:o,onCancel:()=>m(!1),title:"Delete integration",description:`Delete integration ${e.name??e.id}? This cannot be undone.`,onConfirm:async()=>{m(!1);try{let t=await fetch(`/api/v1/integrations/${e.id}`,{method:"DELETE"}),s=await t.json();if(!s.ok)throw Error(s.error||"Delete failed");h.success("Integration deleted"),i?.(e.id)}catch(e){h.error(String(e?.message??e))}}})]})};function l(){let[e,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=!0;return n(!0),fetch("/api/v1/integrations").then(e=>e.json()).then(t=>{e&&(t.ok?a(t.integrations??t):Array.isArray(t)&&a(t))}).catch(e=>{console.error("Failed to fetch integrations",e)}).finally(()=>{e&&n(!1)}),()=>{e=!1}},[]),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h1",{className:"text-xl font-semibold mb-4",children:"Integrations"}),r?(0,t.jsx)("p",{children:"Loading…"}):0===e.length?(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No integrations found."}):(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsx)(i,{integration:e,onDeleted:e=>a(t=>t.filter(t=>t.id!==e)),onSynced:()=>{}},e.id))})]})}e.s(["default",()=>l],68387)}]);